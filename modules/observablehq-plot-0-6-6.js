/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.17.1.
 * Original file: /npm/@observablehq/plot@0.6.6/src/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import {ascending as t,descending as n,timeSecond as e,timeMinute as r,timeHour as o,timeDay as i,timeWeek as a,timeMonth as l,timeYear as s,timeMonday as c,timeTuesday as u,timeWednesday as f,timeThursday as h,timeFriday as d,timeSaturday as p,timeSunday as m,utcSecond as y,utcMinute as g,utcHour as v,utcDay as x,utcWeek as w,utcMonth as b,utcYear as k,utcMonday as $,utcTuesday as M,utcWednesday as L,utcThursday as A,utcFriday as E,utcSaturday as z,utcSunday as O,range as N,color as S,quantile as R,symbolAsterisk as C,symbolCircle as T,symbolCross as I,symbolDiamond as j,symbolDiamond2 as B,symbolPlus as W,symbolSquare as D,symbolSquare2 as F,symbolStar as q,symbolTimes as _,symbolTriangle as P,symbolTriangle2 as U,symbolWye as V,randomLcg as H,sort as Y,group as Z,rollup as G,sum as J,InternSet as K,mode as Q,variance as X,median as tt,mean as nt,maxIndex as et,max as rt,minIndex as ot,min as at,deviation as lt,geoTransform as st,geoPath as ct,geoClipRectangle as ut,geoTransverseMercator as ft,geoStereographic as ht,geoOrthographic as dt,geoMercator as pt,geoGnomonic as mt,geoEquirectangular as yt,geoEqualEarth as gt,geoAzimuthalEquidistant as vt,geoAzimuthalEqualArea as xt,geoAlbersUsa as wt,geoConicEquidistant as bt,geoConicEqualArea as kt,geoConicConformal as $t,geoAlbers as Mt,select as Lt,creator as At,schemeAccent as Et,schemeCategory10 as zt,schemeDark2 as Ot,schemePaired as Nt,schemePastel1 as St,schemePastel2 as Rt,schemeSet1 as Ct,schemeSet2 as Tt,schemeSet3 as It,schemeTableau10 as jt,quantize as Bt,interpolateBrBG as Wt,interpolatePRGn as Dt,interpolatePiYG as Ft,interpolatePuOr as qt,interpolateRdBu as _t,interpolateRdGy as Pt,interpolateRdYlBu as Ut,interpolateRdYlGn as Vt,interpolateSpectral as Ht,interpolateBlues as Yt,interpolateGreens as Zt,interpolateGreys as Gt,interpolatePurples as Jt,interpolateReds as Kt,interpolateOranges as Qt,interpolateTurbo as Xt,interpolateViridis as tn,interpolateMagma as nn,interpolateInferno as en,interpolatePlasma as rn,interpolateCividis as on,interpolateCubehelixDefault as an,interpolateWarm as ln,interpolateCool as sn,interpolateBuGn as cn,interpolateBuPu as un,interpolateGnBu as fn,interpolateOrRd as hn,interpolatePuBuGn as dn,interpolatePuBu as pn,interpolatePuRd as mn,interpolateRdPu as yn,interpolateYlGnBu as gn,interpolateYlGn as vn,interpolateYlOrBr as xn,interpolateYlOrRd as wn,interpolateRainbow as bn,interpolateSinebow as kn,schemeBrBG as $n,schemePRGn as Mn,schemePiYG as Ln,schemePuOr as An,schemeRdBu as En,schemeRdGy as zn,schemeRdYlBu as On,schemeRdYlGn as Nn,schemeSpectral as Sn,schemeBlues as Rn,schemeGreens as Cn,schemeGreys as Tn,schemeOranges as In,schemePurples as jn,schemeReds as Bn,schemeBuGn as Wn,schemeBuPu as Dn,schemeGnBu as Fn,schemeOrRd as qn,schemePuBu as _n,schemePuBuGn as Pn,schemePuRd as Un,schemeRdPu as Vn,schemeYlGn as Hn,schemeYlGnBu as Yn,schemeYlOrBr as Zn,schemeYlOrRd as Gn,scaleLinear as Jn,scalePow as Kn,scaleLog as Qn,scaleSymlog as Xn,scaleQuantile as te,extent as ne,ticks as ee,interpolateNumber as re,reverse as oe,scaleThreshold as ie,scaleIdentity as ae,interpolateRgb as le,interpolateRound as se,interpolateHsl as ce,interpolateHcl as ue,interpolateLab as fe,scaleDiverging as he,scaleDivergingPow as de,scaleDivergingLog as pe,scaleDivergingSymlog as me,piecewise as ye,scaleTime as ge,scaleUtc as ve,scaleImplicit as xe,scaleOrdinal as we,scalePoint as be,scaleBand as ke,symbolsStroke as $e,symbolsFill as Me,namespaces as Le,cross as Ae,InternMap as Ee,utcFormat as ze,format as Oe,axisBottom as Ne,pathRound as Se,rgb as Re,curveLinear as Ce,curveBasis as Te,curveBasisClosed as Ie,curveBasisOpen as je,curveBundle as Be,curveBumpX as We,curveBumpY as De,curveCardinal as Fe,curveCardinalClosed as qe,curveCardinalOpen as _e,curveCatmullRom as Pe,curveCatmullRomClosed as Ue,curveCatmullRomOpen as Ve,curveLinearClosed as He,curveMonotoneX as Ye,curveMonotoneY as Ze,curveNatural as Ge,curveStep as Je,curveStepAfter as Ke,curveStepBefore as Qe,thresholdSturges as Xe,thresholdScott as tr,thresholdFreedmanDiaconis as nr,utcTickInterval as er,tickIncrement as rr,bisect as or,cumsum as ir,groupSort as ar,greatest as lr,area as sr,line as cr,rank as ur,count as fr,blurImage as hr,Delaunay as dr,blur2 as pr,contours as mr,nice as yr,contourDensity as gr,geoGraticule10 as vr,stratify as xr,tree as wr,cluster as br,geoCentroid as kr,least as $r} from "./d3-7-8-4.js";;import {parse as Mr,format as Lr} from "./isoformat-0-2-1.js";;import Ar from "./interval-tree-1d-1-0-4.js";;function Er(t){return null!=t&&!Number.isNaN(t)}function zr(n,e){return+Er(e)-+Er(n)||t(n,e)}function Or(t,e){return+Er(e)-+Er(t)||n(t,e)}function Nr(t){return null!=t&&""!=`${t}`}function Sr(t){return isFinite(t)?t:NaN}function Rr(t){return t>0&&isFinite(t)?t:NaN}function Cr(t){return t<0&&isFinite(t)?t:NaN}const Tr=new Map([["second",e],["minute",r],["hour",o],["day",i],["week",a],["month",l],["quarter",l.every(3)],["half",l.every(6)],["year",s],["monday",c],["tuesday",u],["wednesday",f],["thursday",h],["friday",d],["saturday",p],["sunday",m]]),Ir=new Map([["second",y],["minute",g],["hour",v],["day",x],["week",w],["month",b],["quarter",b.every(3)],["half",b.every(6)],["year",k],["monday",$],["tuesday",M],["wednesday",L],["thursday",A],["friday",E],["saturday",z],["sunday",O]]);function jr(t){const n=Tr.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown interval: ${t}`);return n}function Br(t){const n=Ir.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown interval: ${t}`);return n}const Wr=Object.getPrototypeOf(Uint8Array),Dr=Object.prototype.toString;function Fr(t,n,e){const r=typeof n;return"string"===r?qr(t,Pr(n),e):"function"===r?qr(t,n,e):"number"===r||n instanceof Date||"boolean"===r?uo(t,Xr(n),e):_r("function"==typeof n?.transform?n.transform(t):n,e)}function qr(t,n,e){return uo(t,e?.prototype instanceof Wr?function(t){return(n,e)=>eo(t(n,e))}(n):n,e)}function _r(t,n){return void 0===n?co(t):t instanceof n?t:n.prototype instanceof Wr&&!(t instanceof Wr)?n.from(t,eo):n.from(t)}const Pr=t=>n=>n[t],Ur={transform:wo},Vr={transform:t=>t},Hr=()=>1,Yr=()=>!0,Zr=t=>null==t?t:`${t}`,Gr=t=>null==t?t:+t,Jr=t=>t?t[0]:void 0,Kr=t=>t?t[1]:void 0,Qr=t=>t?t[2]:void 0,Xr=t=>()=>t;function to(t){const n=+`${t}`.slice(1)/100;return(t,e)=>R(t,n,e)}function no(t){return t instanceof Wr?t:uo(t,eo,Float64Array)}function eo(t){return null==t?NaN:Number(t)}function ro(t){return uo(t,oo)}function oo(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?Mr(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function io(t,n){return void 0===t&&(t=n),null===t?[void 0,"none"]:Do(t)?[void 0,t]:[t,void 0]}function ao(t,n){return void 0===t&&(t=n),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function lo(t,n,e){if(null!=t)return so(t,n,e)}function so(t,n,e){const r=`${t}`.toLowerCase();if(!e.includes(r))throw new Error(`invalid ${n}: ${t}`);return r}function co(t){return null==t||t instanceof Array||t instanceof Wr?t:Array.from(t)}function uo(t,n,e=Array){return null==t?t:t instanceof e?t.map(n):e.from(t,n)}function fo(t,n=Array){return t instanceof n?t.slice():n.from(t)}function ho(t){return t?.toString===Dr}function po(t){return ho(t)&&(void 0!==t.type||void 0!==t.domain)}function mo(t){return ho(t)&&"function"!=typeof t.transform}function yo(t){return mo(t)&&void 0===t.value&&void 0===t.channel}function go(t,n,e,r=Vr){return void 0===n&&void 0===e?(n=0,e=void 0===t?r:t):void 0===n?n=void 0===t?0:t:void 0===e&&(e=void 0===t?0:t),[n,e]}function vo(t,n){return void 0===t&&void 0===n?[Jr,Kr]:[t,n]}function xo({z:t,fill:n,stroke:e}={}){return void 0===t&&([t]=io(n)),void 0===t&&([t]=io(e)),t}function wo(t){const n=t.length,e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return e}function bo(t,n){return uo(n,(n=>t[n]))}function ko(t){return null!==t&&"object"==typeof t?t.valueOf():t}function $o(t,n){if(void 0!==n[t])return n[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return n[t]}function Mo(t){let n;return[{transform:()=>n,label:Ao(t)},t=>n=t]}function Lo(t){return null==t?[t]:Mo(t)}function Ao(t,n){return"string"==typeof t?t:t&&void 0!==t.label?t.label:n}function Eo(t,n){return{transform(e){const r=t.transform(e),o=n.transform(e);return To(r)||To(o)?uo(r,((t,n)=>new Date((+r[n]+ +o[n])/2))):uo(r,((t,n)=>(+r[n]+ +o[n])/2),Float64Array)},label:t.label}}function zo(t,n){if(null!=t){if("number"==typeof t){0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const n=Math.abs(t);return t<0?{floor:t=>Math.floor(t*n)/n,offset:t=>(t*n+1)/n,range:(t,e)=>N(Math.ceil(t*n),e*n).map((t=>t/n))}:{floor:t=>Math.floor(t/n)*n,offset:t=>t+n,range:(t,e)=>N(Math.ceil(t/n),e/n).map((t=>t*n))}}if("string"==typeof t)return("time"===n?jr:Br)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function Oo(t,n){if((t=zo(t,n))&&"function"!=typeof t.range)throw new Error("invalid interval: missing range method");return t}function No(t){return void 0===t||mo(t)?t:{value:t}}function So(t){return t&&"function"==typeof t[Symbol.iterator]}function Ro(t){for(const n of t)if(null!=n)return"object"!=typeof n||n instanceof Date}function Co(t){for(const n of t){if(null==n)continue;const t=typeof n;return"string"===t||"boolean"===t}}function To(t){for(const n of t)if(null!=n)return n instanceof Date}function Io(t){for(const n of t)if(null!=n)return"string"==typeof n&&isNaN(n)&&Mr(n)}function jo(t){for(const n of t)if(null!=n){if("string"!=typeof n)return!1;if(n.trim())return!isNaN(n)}}function Bo(t){for(const n of t)if(null!=n)return"number"==typeof n}function Wo(t,n){let e;for(const r of t)if(null!=r){if(!n(r))return!1;e=!0}return e}function Do(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==S(t))}function Fo(t){return"number"==typeof t&&(0<=t&&t<=1||isNaN(t))}function qo(t){return null==t||_o(t)}function _o(t){return/^\s*none\s*$/i.test(t)}function Po(t="middle"){return so(t,"frameAnchor",["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function Uo(t){if(null==t)return;const e=t[0],r=t[t.length-1];return n(e,r)}function Vo(t){return So(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const n=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:e}=t;if(null==e)throw new Error("missing name");const r=`${e}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(n.has(r))throw new Error(`duplicate name: ${r}`);return n.add(r),[e,t]})))}(t):t}const Ho=Symbol("position"),Yo=Symbol("color"),Zo=Symbol("radius"),Go=Symbol("length"),Jo=Symbol("opacity"),Ko=Symbol("symbol"),Qo=new Map([["x",Ho],["y",Ho],["fx",Ho],["fy",Ho],["r",Zo],["color",Yo],["opacity",Jo],["symbol",Ko],["length",Go]]),Xo=Math.sqrt(3),ti=2/Xo,ni=new Map([["asterisk",C],["circle",T],["cross",I],["diamond",j],["diamond2",B],["hexagon",{draw(t,n){const e=Math.sqrt(n/Math.PI),r=e*ti,o=r/2;t.moveTo(0,r),t.lineTo(e,o),t.lineTo(e,-o),t.lineTo(0,-r),t.lineTo(-e,-o),t.lineTo(-e,o),t.closePath()}}],["plus",W],["square",D],["square2",F],["star",q],["times",_],["triangle",P],["triangle2",U],["wye",V]]);function ei(t){return t&&"function"==typeof t.draw}function ri(t){return!!ei(t)||"string"==typeof t&&ni.has(t.toLowerCase())}function oi(t){if(null==t||ei(t))return t;const n=ni.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid symbol: ${t}`)}function ii({filter:t,sort:n,reverse:e,transform:r,initializer:o,...i}={},a){if(void 0===r&&(null!=t&&(r=fi(t)),null==n||yo(n)||(r=li(r,yi(n))),e&&(r=li(r,di))),null!=a&&null!=o)throw new Error("transforms cannot be applied after initializers");return{...i,...(null===n||yo(n))&&{sort:n},transform:li(r,a)}}function ai({filter:t,sort:n,reverse:e,initializer:r,...o}={},i){return void 0===r&&(null!=t&&(r=fi(t)),null==n||yo(n)||(r=si(r,yi(n))),e&&(r=si(r,di))),{...o,...(null===n||yo(n))&&{sort:n},initializer:si(r,i)}}function li(t,n){return null==t?null===n?void 0:n:null==n?null===t?void 0:t:function(e,r){return({data:e,facets:r}=t.call(this,e,r)),n.call(this,co(e),r)}}function si(t,n){return null==t?null===n?void 0:n:null==n?null===t?void 0:t:function(e,r,o,...i){let a,l,s,c,u,f;return({data:l=e,facets:s=r,channels:a}=t.call(this,e,r,o,...i)),({data:u=l,facets:f=s,channels:c}=n.call(this,l,s,{...o,...a},...i)),{data:u,facets:f,channels:{...a,...c}}}}function ci(t,n){return(null!=t.initializer?ai:ii)(t,n)}function ui(t,n){return ci(n,fi(t))}function fi(t){return(n,e)=>{const r=Fr(n,t);return{data:n,facets:e.map((t=>t.filter((t=>r[t]))))}}}function hi({sort:t,...n}={}){return{...ci(n,di),sort:yo(t)?t:null}}function di(t,n){return{data:t,facets:n.map((t=>t.slice().reverse()))}}function pi({seed:t,sort:n,...e}={}){return{...ci(e,vi(null==t?Math.random:H(t))),sort:yo(n)?n:null}}function mi(t,{sort:n,...e}={}){return{...(mo(t)&&void 0!==t.channel?ai:ci)(e,yi(t)),sort:yo(n)?n:null}}function yi(t){return("function"==typeof t&&1!==t.length?gi:vi)(t)}function gi(t){return(n,e)=>{const r=(e,r)=>t(n[e],n[r]);return{data:n,facets:e.map((t=>t.slice().sort(r)))}}}function vi(t){let n,e;if(({channel:n,value:t,order:e=zr}={...No(t)}),"function"!=typeof e)switch(`${e}`.toLowerCase()){case"ascending":e=zr;break;case"descending":e=Or;break;default:throw new Error(`invalid order: ${e}`)}return(r,o,i)=>{let a;if(void 0===n)a=Fr(r,t);else{if(void 0===i)throw new Error("channel sort requires an initializer");if(a=i[n],!a)return{};a=a.value}const l=(t,n)=>e(a[t],a[n]);return{data:r,facets:o.map((t=>t.slice().sort(l)))}}}function xi(t,n){return $i(null,null,t,n)}function wi(t={y:"count"},n={}){const{x:e=Vr}=n;if(null==e)throw new Error("missing channel: x");return $i(e,null,t,n)}function bi(t={x:"count"},n={}){const{y:e=Vr}=n;if(null==e)throw new Error("missing channel: y");return $i(null,e,t,n)}function ki(t={fill:"count"},n={}){let{x:e,y:r}=n;if([e,r]=vo(e,r),null==e)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return $i(e,r,t,n)}function $i(t,n,{data:e=Ii,filter:r,sort:o,reverse:i,...a}={},l={}){a=Li(a,l),e=Oi(e,Vr),o=null==o?void 0:Ai("sort",o,l),r=null==r?void 0:Ei("filter",r,l);const[s,c]=Lo(t),[u,f]=Lo(n),{z:h,fill:d,stroke:p,x1:m,x2:y,y1:g,y2:v,...x}=l,[w,b]=Lo(h),[k]=io(d),[$]=io(p),[M,L]=Lo(k),[A,E]=Lo($);return{..."z"in l&&{z:w||h},..."fill"in l&&{fill:M||d},..."stroke"in l&&{stroke:A||p},...ii(x,((l,s)=>{const u=Fr(l,t),d=Fr(l,n),p=Fr(l,h),m=Fr(l,k),y=Fr(l,$),g=Si(a,{z:p,fill:m,stroke:y}),v=[],x=[],w=u&&c([]),M=d&&f([]),A=p&&b([]),z=m&&L([]),O=y&&E([]);let N=0;for(const t of a)t.initialize(l);o&&o.initialize(l),r&&r.initialize(l);for(const t of s){const n=[];for(const n of a)n.scope("facet",t);o&&o.scope("facet",t),r&&r.scope("facet",t);for(const[i,s]of zi(t,g))for(const[t,c]of zi(s,d))for(const[s,f]of zi(c,u))if(!r||r.reduce(f)){n.push(N++),x.push(e.reduceIndex(f,l)),u&&w.push(s),d&&M.push(t),p&&A.push(g===p?i:p[f[0]]),m&&z.push(g===m?i:m[f[0]]),y&&O.push(g===y?i:y[f[0]]);for(const t of a)t.reduce(f);o&&o.reduce(f)}v.push(n)}return Ri(v,o,i),{data:x,facets:v}})),...!Mi(a,"x")&&(s?{x:s}:{x1:m,x2:y}),...!Mi(a,"y")&&(u?{y:u}:{y1:g,y2:v}),...Object.fromEntries(a.map((({name:t,output:n})=>[t,n])))}}function Mi(t,...n){for(const{name:e}of t)if(n.includes(e))return!0;return!1}function Li(t,n,e=Ai){const r=Object.entries(t);return null!=n.title&&void 0===t.title&&r.push(["title",Bi]),null!=n.href&&void 0===t.href&&r.push(["href",ji]),r.filter((([,t])=>void 0!==t)).map((([t,r])=>null===r?function(t){return{name:t,initialize(){},scope(){},reduce(){}}}(t):e(t,r,n)))}function Ai(t,n,e,r=Ei){let o;ho(n)&&"reduce"in n&&(o=n.scale,n=n.reduce);const i=r(t,n,e),[a,l]=Mo(i.label);let s;return{name:t,output:void 0===o?a:{value:a,scale:o},initialize(t){i.initialize(t),s=l([])},scope(t,n){i.scope(t,n)},reduce(t,n){s.push(i.reduce(t,n))}}}function Ei(t,n,e,r=Oi){const o=$o(t,e),i=r(n,o);let a,l;return{label:Ao(i===Di?null:o,i.label),initialize(t){a=void 0===o?t:Fr(t,o),"data"===i.scope&&(l=i.reduceIndex(wo(t),a))},scope(t,n){i.scope===t&&(l=i.reduceIndex(n,a))},reduce:(t,n)=>null==i.scope?i.reduceIndex(t,a,n):i.reduceIndex(t,a,l,n)}}function zi(t,n){return n?Y(Z(t,(t=>n[t])),Jr):[[,t]]}function Oi(t,n,e=Ni){if(null==t)return e(t);if("function"==typeof t.reduceIndex)return t;if("function"==typeof t.reduce&&ho(t))return function(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}(t);if("function"==typeof t)return r=t,{reduceIndex:(t,n,e)=>r(bo(n,t),e)};var r;if(/^p\d{2}$/i.test(t))return Ci(to(t));switch(`${t}`.toLowerCase()){case"first":return ji;case"last":return Wi;case"identity":return Ii;case"count":return Di;case"distinct":return Fi;case"sum":return null==n?Di:qi;case"proportion":return _i(n,"data");case"proportion-facet":return _i(n,"facet");case"deviation":return Ci(lt);case"min":return Ci(at);case"min-index":return Ci(ot);case"max":return Ci(rt);case"max-index":return Ci(et);case"mean":return Ti(nt);case"median":return Ti(tt);case"variance":return Ci(X);case"mode":return Ci(Q)}return e(t)}function Ni(t){throw new Error(`invalid reduce: ${t}`)}function Si(t,n){for(const e in n){const r=n[e];if(void 0!==r&&!t.some((t=>t.name===e)))return r}}function Ri(t,n,e){if(n){const e=n.output.transform(),r=(t,n)=>zr(e[t],e[n]);t.forEach((t=>t.sort(r)))}e&&t.forEach((t=>t.reverse()))}function Ci(t){return{reduceIndex:(n,e)=>t(n,(t=>e[t]))}}function Ti(t){return{reduceIndex(n,e){const r=t(n,(t=>e[t]));return To(e)?new Date(r):r}}}const Ii={reduceIndex:(t,n)=>bo(n,t)},ji={reduceIndex:(t,n)=>n[t[0]]},Bi={reduceIndex(t,n){const e=Y(G(t,(t=>t.length),(t=>n[t])),Kr),r=e.slice(-5).reverse();if(r.length<e.length){const t=e.slice(0,-4);r[4]=[`… ${t.length.toLocaleString("en-US")} more`,J(t,Kr)]}return r.map((([t,n])=>`${t} (${n.toLocaleString("en-US")})`)).join("\n")}},Wi={reduceIndex:(t,n)=>n[t[t.length-1]]},Di={label:"Frequency",reduceIndex:t=>t.length},Fi={label:"Distinct",reduceIndex(t,n){const e=new K;for(const r of t)e.add(n[r]);return e.size}},qi=Ci(J);function _i(t,n){return null==t?{scope:n,label:"Frequency",reduceIndex:(t,n,e=1)=>t.length/e}:{scope:n,reduceIndex:(t,n,e=1)=>J(t,(t=>n[t]))/e}}function Pi(t,{scale:n,type:e,value:r,filter:o,hint:i},a){return Hi(a,{scale:n,type:e,value:Fr(t,r),label:Ao(r),filter:o,hint:i})}function Ui(t,n){return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,Pi(n,e,t)])))}function Vi(t,n){const e=Object.fromEntries(Object.entries(t).map((([t,{scale:e,value:r}])=>{const o=null==e?null:n[e];return[t,null==o?r:uo(r,o)]})));return e.channels=t,e}function Hi(t,n){const{scale:e,value:r}=n;if(!0===e||"auto"===e)switch(t){case"fill":case"stroke":case"color":n.scale=!0!==e&&Wo(r,Do)?null:"color";break;case"fillOpacity":case"strokeOpacity":n.scale=!0!==e&&Wo(r,Fo)?null:"opacity";break;case"symbol":!0!==e&&Wo(r,ri)?(n.scale=null,n.value=uo(r,oi)):n.scale="symbol";break;default:n.scale=Qo.has(t)?t:null}else if(!1===e)n.scale=null;else if(null!=e&&!Qo.has(e))throw new Error(`unknown scale: ${e}`);return n}function Yi(t,n){for(const e in t){const r=t[e];if(r.scale===n)return r}}function Zi(t,n){const e=t.original;if(e===t)return n;const r=n.value,o=n.value=[];for(let n=0;n<e.length;++n){const i=r[e[n][0]];for(const e of t[n])o[e]=i}return n}function Gi(t,n,e){const r=Ji(t,n);return uo(Ji(t,e),((t,n)=>Math.abs(t-r[n])),Float64Array)}function Ji(t,n,e){let r=t[n];if(r||void 0===e||(r=t[e]),r)return r.value;throw new Error(`missing channel: ${n}`)}function Ki([t,n],[e,r]){return zr(n,r)||zr(t,e)}function Qi([t,n],[e,r]){return Or(n,r)||zr(t,e)}let Xi=0;function ta(t){console.warn(t),++Xi}const na=Math.PI,ea=2*na,ra=.618;function oa({projection:t,inset:n=0,insetTop:e=n,insetRight:r=n,insetBottom:o=n,insetLeft:i=n}={},a){if(null==t)return;if("function"==typeof t.stream)return t;let l,s,c="frame";if(ho(t)){let n;if(({type:t,domain:s,inset:n,insetTop:e=(void 0!==n?n:e),insetRight:r=(void 0!==n?n:r),insetBottom:o=(void 0!==n?n:o),insetLeft:i=(void 0!==n?n:i),clip:c=c,...l}=t),null==t)return}"function"!=typeof t&&({type:t}=ia(t));const{width:u,height:f,marginLeft:h,marginRight:d,marginTop:p,marginBottom:m}=a,y=u-h-d-i-r,g=f-p-m-e-o;if(t=t?.({width:y,height:g,clip:c,...l}),null==t)return;c=function(t,n,e,r,o){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return ut(n,e,r,o);throw new Error(`unknown projection clip type: ${t}`)}(c,h,p,u-d,f-m);let v,x=h+i,w=p+e;if(null!=s){const[[n,e],[r,o]]=ct(t).bounds(s),i=Math.min(y/(r-n),g/(o-e));i>0?(x-=(i*(n+r)-y)/2,w-=(i*(e+o)-g)/2,v=st({point(t,n){this.stream.point(t*i+x,n*i+w)}})):ta("Warning: the projection could not be fit to the specified domain; using the default scale.")}return v??=0===x&&0===w?sa():st({point(t,n){this.stream.point(t+x,n+w)}}),{stream:n=>t.stream(v.stream(c(n)))}}function ia(t){switch(`${t}`.toLowerCase()){case"albers-usa":return aa(wt,.7463,.4673);case"albers":return la(Mt,.7463,.4673);case"azimuthal-equal-area":return aa(xt,4,4);case"azimuthal-equidistant":return aa(vt,ea,ea);case"conic-conformal":return la($t,ea,ea);case"conic-equal-area":return la(kt,6.1702,2.9781);case"conic-equidistant":return la(bt,7.312,3.6282);case"equal-earth":return aa(gt,5.4133,2.6347);case"equirectangular":return aa(yt,ea,na);case"gnomonic":return aa(mt,3.4641,3.4641);case"identity":return{type:sa};case"reflect-y":return{type:ca};case"mercator":return aa(pt,ea,ea);case"orthographic":return aa(dt,2,2);case"stereographic":return aa(ht,2,2);case"transverse-mercator":return aa(ft,ea,ea);default:throw new Error(`unknown projection type: ${t}`)}}function aa(t,n,e){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:l})=>{const s=t();return null!=a&&s.precision?.(a),null!=i&&s.rotate?.(i),"number"==typeof l&&s.clipAngle?.(l),s.scale(Math.min(r/n,o/e)),s.translate([r/2,o/2]),s},aspectRatio:e/n}}function la(t,n,e){const{type:r,aspectRatio:o}=aa(t,n,e);return{type:t=>{const{parallels:n,domain:e,width:o,height:i}=t,a=r(t);return null!=n&&(a.parallels(n),void 0===e&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const sa=Xr({stream:t=>t}),ca=Xr(st({point(t,n){this.stream.point(t,-n)}}));function ua(t,n,e,r,o){const i=e[t]&&"x"===e[t].scale,a=e[n]&&"y"===e[n].scale;if(i&&a)!function(t,n,e,r){const o=e[t],i=e[n],a=o.length,l=e[t]=new Float64Array(a).fill(NaN),s=e[n]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,n){l[c]=t,s[c]=n}});for(c=0;c<a;++c)u.point(o[c],i[c])}(t,n,r,o.projection);else{if(i)throw new Error(`projection requires paired x and y channels; ${t} is missing ${n}`);if(a)throw new Error(`projection requires paired x and y channels; ${n} is missing ${t}`)}}function fa(t,n,e){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=Vi(i,n),e.projection&&ua("x","y",t,i,e),r&&(i.x=no(i.x)),o&&(i.y=no(i.y)),i}function ha(t={},n,e){const{document:r=("undefined"!=typeof window?window.document:void 0)}=t;return{document:r,className:e,projection:oa(t,n)}}function da(t,{document:n}){return Lt(At(t).call(n.documentElement))}const pa=new Map([["accent",Et],["category10",zt],["dark2",Ot],["paired",Nt],["pastel1",St],["pastel2",Rt],["set1",Ct],["set2",Tt],["set3",It],["tableau10",jt],["brbg",ya($n,Wt)],["prgn",ya(Mn,Dt)],["piyg",ya(Ln,Ft)],["puor",ya(An,qt)],["rdbu",ya(En,_t)],["rdgy",ya(zn,Pt)],["rdylbu",ya(On,Ut)],["rdylgn",ya(Nn,Vt)],["spectral",ya(Sn,Ht)],["burd",ga(En,_t)],["buylrd",ga(On,Ut)],["blues",ma(Rn,Yt)],["greens",ma(Cn,Zt)],["greys",ma(Tn,Gt)],["oranges",ma(In,Qt)],["purples",ma(jn,Jt)],["reds",ma(Bn,Kt)],["turbo",va(Xt)],["viridis",va(tn)],["magma",va(nn)],["inferno",va(en)],["plasma",va(rn)],["cividis",va(on)],["cubehelix",va(an)],["warm",va(ln)],["cool",va(sn)],["bugn",ma(Wn,cn)],["bupu",ma(Dn,un)],["gnbu",ma(Fn,fn)],["orrd",ma(qn,hn)],["pubu",ma(_n,pn)],["pubugn",ma(Pn,dn)],["purd",ma(Un,mn)],["rdpu",ma(Vn,yn)],["ylgn",ma(Hn,vn)],["ylgnbu",ma(Yn,gn)],["ylorbr",ma(Zn,xn)],["ylorrd",ma(Gn,wn)],["rainbow",xa(bn)],["sinebow",xa(kn)]]);function ma(t,n){return({length:e})=>1===e?[t[3][1]]:2===e?[t[3][1],t[3][2]]:(e=Math.max(3,Math.floor(e)))>9?Bt(n,e):t[e]}function ya(t,n){return({length:e})=>2===e?[t[3][0],t[3][2]]:(e=Math.max(3,Math.floor(e)))>11?Bt(n,e):t[e]}function ga(t,n){return({length:e})=>2===e?[t[3][2],t[3][0]]:(e=Math.max(3,Math.floor(e)))>11?Bt((t=>n(1-t)),e):t[e].slice().reverse()}function va(t){return({length:n})=>Bt(t,Math.max(2,Math.floor(n)))}function xa(t){return({length:n})=>Bt(t,Math.floor(n)+1).slice(0,-1)}function wa(t){const n=`${t}`.toLowerCase();if(!pa.has(n))throw new Error(`unknown ordinal scheme: ${n}`);return pa.get(n)}function ba(t,n){const e=wa(t),r="function"==typeof e?e({length:n}):e;return r.length!==n?r.slice(0,n):r}const ka=new Map([["brbg",Wt],["prgn",Dt],["piyg",Ft],["puor",qt],["rdbu",_t],["rdgy",Pt],["rdylbu",Ut],["rdylgn",Vt],["spectral",Ht],["burd",t=>_t(1-t)],["buylrd",t=>Ut(1-t)],["blues",Yt],["greens",Zt],["greys",Gt],["purples",Jt],["reds",Kt],["oranges",Qt],["turbo",Xt],["viridis",tn],["magma",nn],["inferno",en],["plasma",rn],["cividis",on],["cubehelix",an],["warm",ln],["cool",sn],["bugn",cn],["bupu",un],["gnbu",fn],["orrd",hn],["pubugn",dn],["pubu",pn],["purd",mn],["rdpu",yn],["ylgnbu",gn],["ylgn",vn],["ylorbr",xn],["ylorrd",wn],["rainbow",bn],["sinebow",kn]]);function $a(t){const n=`${t}`.toLowerCase();if(!ka.has(n))throw new Error(`unknown quantitative scheme: ${n}`);return ka.get(n)}const Ma=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function La(t){return null!=t&&Ma.has(`${t}`.toLowerCase())}const Aa=t=>n=>t(1-n),Ea=[0,1],za=new Map([["number",re],["rgb",le],["hsl",ce],["hcl",ue],["lab",fe]]);function Oa(t){const n=`${t}`.toLowerCase();if(!za.has(n))throw new Error(`unknown interpolator: ${n}`);return za.get(n)}function Na(t,n,e,{type:r,nice:o,clamp:i,zero:a,domain:l=Ta(t,e),unknown:s,round:c,scheme:u,interval:f,range:h=(Qo.get(t)===Zo?ja(e,l):Qo.get(t)===Go?Ba(e,l):Qo.get(t)===Jo?Ea:void 0),interpolate:d=(Qo.get(t)===Yo?null==u&&void 0!==h?le:$a(void 0!==u?u:"cyclical"===r?"rainbow":"turbo"):c?se:re),reverse:p}){if(f=Oo(f,r),"cyclical"!==r&&"sequential"!==r||(r="linear"),p=!!p,"function"!=typeof d&&(d=Oa(d)),1===d.length?(p&&(d=Aa(d),p=!1),void 0===h&&2===(h=Float64Array.from(l,((t,n)=>n/(l.length-1)))).length&&(h=Ea),n.interpolate((h===Ea?Xr:Fa)(d))):n.interpolate(d),a){const[t,n]=ne(l);(t>0||n<0)&&(Uo(l=fo(l))!==Math.sign(t)?l[l.length-1]=0:l[0]=0)}return p&&(l=oe(l)),n.domain(l).unknown(s),o&&(n.nice(function(t,n){return!0===t?void 0:"number"==typeof t?t:function(t,n){if((t=Oo(t,n))&&"function"!=typeof t.ceil)throw new Error("invalid interval: missing ceil method");return t}(t,n)}(o,r)),l=n.domain()),void 0!==h&&n.range(h),i&&n.clamp(i),{type:r,domain:l,range:h,scale:n,interpolate:d,interval:f}}function Sa(t,n,{exponent:e=1,...r}){return Na(t,Kn().exponent(e),n,{...r,type:"pow"})}function Ra(t,e,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:l=(void 0!==a?Bt(a,r.length+1):Qo.get(t)===Yo?ba(i,r.length+1):void 0),reverse:s}){const c=Uo(r=co(r));if(!isNaN(c)&&!function(t,e){for(let r=1,o=t.length,i=t[0];r<o;++r){const o=n(i,i=t[r]);if(0!==o&&o!==e)return!1}return!0}(r,c))throw new Error(`the ${t} scale has a non-monotonic domain`);return s&&(l=oe(l)),{type:"threshold",scale:ie(c<0?oe(r):r,void 0===l?[]:l).unknown(o),domain:r,range:l}}function Ca(t,n=Sr){return t.length?[at(t,(({value:t})=>void 0===t?t:at(t,n))),rt(t,(({value:t})=>void 0===t?t:rt(t,n)))]:[0,1]}function Ta(t,n){const e=Qo.get(t);return(e===Zo||e===Jo||e===Go?Ia:Ca)(n)}function Ia(t){return[0,t.length?rt(t,(({value:t})=>void 0===t?t:rt(t,Sr))):1]}function ja(t,n){const e=t.find((({radius:t})=>void 0!==t));if(void 0!==e)return[0,e.radius];const r=R(t,.5,(({value:t})=>void 0===t?NaN:R(t,.25,Rr))),o=n.map((t=>3*Math.sqrt(t/r))),i=30/rt(o);return i<1?o.map((t=>t*i)):o}function Ba(t,n){const e=tt(t,(({value:t})=>void 0===t?NaN:tt(t,Math.abs))),r=n.map((t=>12*t/e)),o=60/rt(r);return o<1?r.map((t=>t*o)):r}function Wa(t){for(const{value:n}of t)if(void 0!==n)for(let e of n){if(e>0)return Ca(t,Rr);if(e<0)return Ca(t,Cr)}return[1,10]}function Da(t){const n=[];for(const{value:e}of t)if(void 0!==e)for(const t of e)n.push(t);return n}function Fa(t){return(n,e)=>r=>t(n+r*(e-n))}function qa(t,e,r,o,{type:i,nice:a,clamp:l,domain:s=Ca(o),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(Qo.get(t)===Yo?null==f&&void 0!==h?le:$a(void 0!==f?f:"rdbu"):re),reverse:m}){u=+u;let[y,g]=s;if(n(y,g)<0&&([y,g]=[g,y],m=!m),y=Math.min(y,u),g=Math.max(g,u),"function"!=typeof p&&(p=Oa(p)),void 0!==h&&(p=1===p.length?Fa(p)(...h):ye(p,h)),m&&(p=Aa(p)),d){const t=r.apply(u),n=t-r.apply(y),e=r.apply(g)-t;n<e?y=r.invert(t-e):n>e&&(g=r.invert(t+n))}return e.domain([y,u,g]).unknown(c).interpolator(p),l&&e.clamp(l),a&&e.nice(a),{type:i,domain:[y,g],pivot:u,interpolate:p,scale:e}}function _a(t,n,{exponent:e=1,...r}){return qa(t,de().exponent(e=+e),function(t){return.5===t?Ha:{apply:n=>Math.sign(n)*Math.pow(Math.abs(n),t),invert:n=>Math.sign(n)*Math.pow(Math.abs(n),1/t)}}(e),n,{...r,type:"diverging-pow"})}function Pa(t,n,{constant:e=1,...r}){return qa(t,me().constant(e=+e),function(t){return{apply:n=>Math.sign(n)*Math.log1p(Math.abs(n/t)),invert:n=>Math.sign(n)*Math.expm1(Math.abs(n))*t}}(e),n,r)}const Ua={apply:t=>t,invert:t=>t},Va={apply:Math.log,invert:Math.exp},Ha={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Ya(t,n,e,r){return Na(t,n,e,r)}const Za=Symbol("ordinal");function Ga(t,n,e,{type:r,interval:o,domain:i,range:a,reverse:l,hint:s}){return o=Oo(o,r),void 0===i&&(i=Qa(e,o,t)),"categorical"!==r&&r!==Za||(r="ordinal"),l&&(i=oe(i)),n.domain(i),void 0!==a&&("function"==typeof a&&(a=a(i)),n.range(a)),{type:r,domain:i,range:a,scale:n,hint:s,interval:o}}function Ja(t,n,{type:e,interval:r,domain:o,range:i,scheme:a,unknown:l,...s}){let c;if(r=Oo(r,e),void 0===o&&(o=Qa(n,r,t)),Qo.get(t)===Ko)c=function(t){return{fill:Xa(t,"fill"),stroke:Xa(t,"stroke")}}(n),i=void 0===i?function(t){return qo(t.fill)?$e:Me}(c):uo(i,oi);else if(Qo.get(t)===Yo&&(void 0!==i||"ordinal"!==e&&e!==Za||(i=function(t,n="greys"){const e=new Set,[r,o]=ba(n,2);for(const n of t)if(null!=n)if(!0===n)e.add(o);else{if(!1!==n)return;e.add(r)}return[...e]}(o,a),void 0!==i&&(a=void 0)),void 0===a&&void 0===i&&(a="ordinal"===e?"turbo":"tableau10"),void 0!==a))if(void 0!==i){const t=$a(a),n=i[0],e=i[1]-i[0];i=({length:r})=>Bt((r=>t(n+e*r)),r)}else i=wa(a);if(l===xe)throw new Error(`implicit unknown on ${t} scale is not supported`);return Ga(t,we().unknown(l),n,{...s,type:e,domain:o,range:i,hint:c})}function Ka(t,n,e,r){let{round:o}=e;return void 0!==o&&t.round(o=!!o),(t=Ga(r,t,n,e)).round=o,t}function Qa(t,n,e){const r=new K;for(const{value:n,domain:e}of t){if(void 0!==e)return e();if(void 0!==n)for(const t of n)r.add(t)}if(void 0!==n){const[t,e]=ne(r).map(n.floor,n);return n.range(t,n.offset(e))}if(r.size>1e4&&Qo.get(e)===Ho)throw new Error(`implicit ordinal domain of ${e} scale has more than 10,000 values`);return Y(r,zr)}function Xa(t,n){let e;for(const{hint:r}of t){const t=r?.[n];if(void 0!==t)if(void 0===e)e=t;else if(e!==t)return}return e}function tl(t,{label:n,inset:e=0,insetTop:r=e,insetRight:o=e,insetBottom:i=e,insetLeft:a=e,round:l,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,facet:{label:p=n}={},...m}={}){const y={};for(const[e,g]of t){const t=m[e],v=ul(e,g,{round:Qo.get(e)===Ho?l:void 0,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,...t});if(v){let{label:l=("fx"===e||"fy"===e?p:n),percent:s,transform:c,inset:u,insetTop:f=(void 0!==u?u:"y"===e?r:0),insetRight:h=(void 0!==u?u:"x"===e?o:0),insetBottom:d=(void 0!==u?u:"y"===e?i:0),insetLeft:m=(void 0!==u?u:"x"===e?a:0)}=t||{};if(null==c)c=void 0;else if("function"!=typeof c)throw new Error("invalid scale transform; not a function");v.percent=!!s,v.label=void 0===l?el(g,v):l,v.transform=c,"x"===e||"fx"===e?(v.insetLeft=+m,v.insetRight=+h):"y"!==e&&"fy"!==e||(v.insetTop=+f,v.insetBottom=+d),y[e]=v}}return y}function nl(t){return Object.fromEntries(Object.entries(t).filter((([,{scale:t}])=>t)).map((([t,{scale:n,type:e,interval:r,label:o}])=>(n.type=e,null!=r&&(n.interval=r),null!=o&&(n.label=o),[t,n]))))}function el(t=[],n){let e;for(const{label:n}of t)if(void 0!==n)if(void 0===e)e=n;else if(e!==n)return;if(!(void 0===e||pl(n)&&/^(date|time|year)$/i.test(e)))return!ml(n)&&n.percent&&(e=`${e} (%)`),{inferred:!0,toString:()=>e}}function rl(t){const{marginTop:n,marginRight:e,marginBottom:r,marginLeft:o,width:i,height:a,facet:{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u}}=t;return{marginTop:Math.max(n,l),marginRight:Math.max(e,s),marginBottom:Math.max(r,c),marginLeft:Math.max(o,u),width:i,height:a}}function ol({fx:t,fy:n},e){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=rl(e);return{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:t?t.scale.bandwidth()+a+o:l,height:n?n.scale.bandwidth()+r+i:s}}function il(t,n){if(void 0===t.range){const{insetLeft:e,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=n,l=i+e,s=o-a-r;t.range=[l,Math.max(l,s)],ml(t)||(t.range=sl(t)),t.scale.range(t.range)}ll(t)}function al(t,n){if(void 0===t.range){const{insetTop:e,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=n,l=i+e,s=o-a-r;t.range=[Math.max(l,s),l],ml(t)?t.range.reverse():t.range=sl(t),t.scale.range(t.range)}ll(t)}function ll(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const n=t.domain().length,[e,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=n-o,l=Math.abs(r-e)/Math.max(1,a+2*i);return(l-Math.floor(l))*a}(t)<=30&&t.scale.round(!0)}function sl(t){const n=t.scale.domain().length+yl(t);if(!(n>2))return t.range;const[e,r]=t.range;return Array.from({length:n},((t,o)=>e+o/(n-1)*(r-e)))}function cl(t,n,e){return ul(t,void 0===e?void 0:[{hint:e}],{...n})}function ul(t,n=[],e={}){const r=function(t,n,{type:e,domain:r,range:o,scheme:i,pivot:a,projection:l}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==l||(e=hl);for(const{type:t}of n)if(void 0!==t)if(void 0===e)e=t;else if(e!==t)throw new Error(`scale incompatible with channel: ${e} !== ${t}`);if(e===hl)return;if(void 0!==e)return e;if(void 0===r&&!n.some((({value:t})=>void 0!==t)))return;const s=Qo.get(t);if(s===Zo)return"sqrt";if(s===Jo||s===Go)return"linear";if(s===Ko)return"ordinal";if((r||o||[]).length>2)return dl(s);if(void 0!==r)return Co(r)?dl(s):To(r)?"utc":s!==Yo||null==a&&!La(i)?"linear":"diverging";const c=n.map((({value:t})=>t)).filter((t=>void 0!==t));return c.some(Co)?dl(s):c.some(To)?"utc":s!==Yo||null==a&&!La(i)?"linear":"diverging"}(t,n,e);if(void 0===e.type&&void 0===e.domain&&void 0===e.range&&null==e.interval&&"fx"!==t&&"fy"!==t&&ml({type:r})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(To)?ta(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${fl(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${fl(r)}".`):e.some(Io)?ta(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${fl(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${fl(r)}".`):e.some(jo)&&ta(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${fl(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${fl(r)}".`)}switch(e.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":e=vl(n,e,no);break;case"identity":switch(Qo.get(t)){case Ho:e=vl(n,e,no);break;case Ko:e=vl(n,e,xl)}break;case"utc":case"time":e=vl(n,e,ro)}switch(r){case"diverging":return function(t,n,e){return qa(t,he(),Ua,n,e)}(t,n,e);case"diverging-sqrt":return function(t,n,e){return _a(t,n,{...e,exponent:.5})}(t,n,e);case"diverging-pow":return _a(t,n,e);case"diverging-log":return function(t,n,{base:e=10,pivot:r=1,domain:o=Ca(n,r<0?Cr:Rr),...i}){return qa(t,pe().base(e=+e),Va,n,{domain:o,pivot:r,...i})}(t,n,e);case"diverging-symlog":return Pa(t,n,e);case"categorical":case"ordinal":case Za:return Ja(t,n,e);case"cyclical":case"sequential":case"linear":return function(t,n,e){return Na(t,Jn(),n,e)}(t,n,e);case"sqrt":return function(t,n,e){return Sa(t,n,{...e,exponent:.5})}(t,n,e);case"threshold":return Ra(t,0,e);case"quantile":return function(t,n,{range:e,quantiles:r=(void 0===e?5:(e=[...e]).length),n:o=r,scheme:i="rdylbu",domain:a=Da(n),unknown:l,interpolate:s,reverse:c}){return void 0===e&&(e=void 0!==s?Bt(s,o):Qo.get(t)===Yo?ba(i,o):void 0),a.length>0&&(a=te(a,void 0===e?{length:o}:e).quantiles()),Ra(t,0,{domain:a,range:e,reverse:c,unknown:l})}(t,n,e);case"quantize":return function(t,n,{range:e,n:r=(void 0===e?5:(e=[...e]).length),scheme:o="rdylbu",domain:i=Ta(t,n),unknown:a,interpolate:l,reverse:s}){const[c,u]=ne(i);let f;return void 0===e?(f=ee(c,u,r),f[0]<=c&&f.splice(0,1),f[f.length-1]>=u&&f.pop(),r=f.length+1,e=void 0!==l?Bt(l,r):Qo.get(t)===Yo?ba(o,r):void 0):(f=Bt(re(c,u),r+1).slice(1,-1),c instanceof Date&&(f=f.map((t=>new Date(t))))),Uo(co(i))<0&&f.reverse(),Ra(t,0,{domain:f,range:e,reverse:s,unknown:a})}(t,n,e);case"pow":return Sa(t,n,e);case"log":return function(t,n,{base:e=10,domain:r=Wa(n),...o}){return Na(t,Qn().base(e),n,{...o,domain:r})}(t,n,e);case"symlog":return function(t,n,{constant:e=1,...r}){return Na(t,Xn().constant(e),n,r)}(t,n,e);case"utc":return function(t,n,e){return Ya(t,ve(),n,e)}(t,n,e);case"time":return function(t,n,e){return Ya(t,ge(),n,e)}(t,n,e);case"point":return function(t,n,{align:e=.5,padding:r=.5,...o}){return Ka(be().align(e).padding(r),n,o,t)}(t,n,e);case"band":return function(t,n,{align:e=.5,padding:r=.1,paddingInner:o=r,paddingOuter:i=("fx"===t||"fy"===t?0:r),...a}){return Ka(ke().align(e).paddingInner(o).paddingOuter(i),n,a,t)}(t,n,e);case"identity":return Qo.get(t)===Ho?{type:"identity",scale:ae()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function fl(t){return"symbol"==typeof t?t.description:t}const hl={toString:()=>"projection"};function dl(t){switch(t){case Ho:return"point";case Yo:return Za;default:return"ordinal"}}function pl({type:t}){return"time"===t||"utc"===t}function ml({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Za}function yl({type:t}){return"threshold"===t}function gl(t){if(void 0===t)return!0;const n=t.domain(),e=t(n[0]);for(let r=1,o=n.length;r<o;++r)if(t(n[r])-e)return!1;return!0}function vl(t,{domain:n,...e},r){for(const n of t)void 0!==n.value&&(n.value=r(n.value));return{domain:void 0===n?n:r(n),...e}}function xl(t){return uo(t,oi)}function wl(t={}){let n;for(const e in t)if(Qo.has(e)&&po(t[e])){if(void 0!==n)throw new Error("ambiguous scale definition; multiple scales found");n=bl(cl(e,t[e]))}if(void 0===n)throw new Error("invalid scale definition; no scale found");return n}function bl({scale:t,type:n,domain:e,range:r,interpolate:o,interval:i,transform:a,percent:l,pivot:s}){if("identity"===n)return{type:"identity",apply:t=>t,invert:t=>t};const c=t.unknown?t.unknown():void 0;return{type:n,domain:fo(e),...void 0!==r&&{range:fo(r)},...void 0!==a&&{transform:a},...l&&{percent:l},...void 0!==c&&{unknown:c},...void 0!==i&&{interval:i},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==s&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:n=>t(n),...t.invert&&{invert:n=>t.invert(n)}}}function kl(t){let n,e;return(...r)=>((e?.length!==r.length||e.some(((t,n)=>t!==r[n])))&&(e=r,n=t(...r)),n)}const $l=kl((t=>new Intl.NumberFormat(t))),Ml=kl(((t,n)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...n&&{month:n}}))),Ll=kl(((t,n)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...n&&{weekday:n}})));function Al(t="en-US",n="short"){const e=Ml(t,n);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:e.format(t)}function El(t="en-US",n="short"){const e=Ll(t,n);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:e.format(t)}function zl(t){return Lr(t,"Invalid Date")}const Ol=function(t="en-US"){const n=function(t="en-US"){const n=$l(t);return t=>null==t||isNaN(t)?void 0:n.format(t)}(t);return t=>(t instanceof Date?zl:"number"==typeof t?n:Zr)(t)}(),Nl=("undefined"!=typeof window?window.devicePixelRatio>1:"undefined"==typeof it)?0:.5;let Sl=0;function Rl(){return"plot-clip-"+ ++Sl}function Cl(t,{title:n,href:e,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:l,fillOpacity:s,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:y,opacity:g,mixBlendMode:v,paintOrder:x,pointerEvents:w,shapeRendering:b},{ariaLabel:k,fill:$="currentColor",fillOpacity:M,stroke:L="none",strokeOpacity:A,strokeWidth:E,strokeLinecap:z,strokeLinejoin:O,strokeMiterlimit:N,paintOrder:S}){null===$&&(l=null,s=null),null===L&&(c=null,f=null),qo($)?qo(L)||qo(l)||(L="none"):qo(L)&&!qo(c)&&($="none");const[R,C]=io(l,$),[T,I]=ao(s,M),[j,B]=io(c,L),[W,D]=ao(f,A),[F,q]=ao(g);_o(B)||(void 0===u&&(u=E),void 0===d&&(d=z),void 0===h&&(h=O),void 0!==p||/^\s*round\s*$/i.test(h)||(p=N),_o(C)||void 0!==x||(x=S));const[_,P]=ao(u);return null!==$&&(t.fill=Vl(C,"currentColor"),t.fillOpacity=Hl(I,1)),null!==L&&(t.stroke=Vl(B,"none"),t.strokeWidth=Hl(P,1),t.strokeOpacity=Hl(D,1),t.strokeLinejoin=Vl(h,"miter"),t.strokeLinecap=Vl(d,"butt"),t.strokeMiterlimit=Hl(p,4),t.strokeDasharray=Vl(m,"none"),t.strokeDashoffset=Vl(y,"0")),t.target=Zr(a),t.ariaLabel=Zr(k),t.ariaDescription=Zr(o),t.ariaHidden=Zr(i),t.opacity=Hl(q,1),t.mixBlendMode=Vl(v,"normal"),t.paintOrder=Vl(x,"normal"),t.pointerEvents=Vl(w,"auto"),t.shapeRendering=Vl(b,"auto"),{title:{value:n,optional:!0},href:{value:e,optional:!0},ariaLabel:{value:r,optional:!0},fill:{value:R,scale:"auto",optional:!0},fillOpacity:{value:T,scale:"auto",optional:!0},stroke:{value:j,scale:"auto",optional:!0},strokeOpacity:{value:W,scale:"auto",optional:!0},strokeWidth:{value:_,optional:!0},opacity:{value:F,scale:"auto",optional:!0}}}function Tl(t,n){n&&t.text((t=>Ol(n[t])))}function Il(t,n){n&&t.text((([t])=>Ol(n[t])))}function jl(t,{target:n},{ariaLabel:e,title:r,fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s,opacity:c,href:u}){e&&Pl(t,"aria-label",(t=>e[t])),o&&Pl(t,"fill",(t=>o[t])),i&&Pl(t,"fill-opacity",(t=>i[t])),a&&Pl(t,"stroke",(t=>a[t])),l&&Pl(t,"stroke-opacity",(t=>l[t])),s&&Pl(t,"stroke-width",(t=>s[t])),c&&Pl(t,"opacity",(t=>c[t])),u&&_l(t,(t=>u[t]),n),function(t,n){n&&t.filter((t=>Nr(n[t]))).append("title").call(Tl,n)}(t,r)}function Bl(t,{target:n},{ariaLabel:e,title:r,fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s,opacity:c,href:u}){e&&Pl(t,"aria-label",(([t])=>e[t])),o&&Pl(t,"fill",(([t])=>o[t])),i&&Pl(t,"fill-opacity",(([t])=>i[t])),a&&Pl(t,"stroke",(([t])=>a[t])),l&&Pl(t,"stroke-opacity",(([t])=>l[t])),s&&Pl(t,"stroke-width",(([t])=>s[t])),c&&Pl(t,"opacity",(([t])=>c[t])),u&&_l(t,(([t])=>u[t]),n),function(t,n){n&&t.filter((([t])=>Nr(n[t]))).append("title").call(Il,n)}(t,r)}function Wl(t,n,e){const r=Z(t,(t=>n[t]));return void 0===e&&r.size>t.length>>1&&ta("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*Dl(t,n,{z:e},r){const{z:o}=r,i=function({ariaLabel:t,title:n,fill:e,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:l,href:s}){return[t,n,e,r,o,i,a,l,s].filter((t=>void 0!==t))}(r),a=[...n,...i];for(const n of o?Wl(t,o,e):[t]){let t,e;t:for(const r of n){for(const t of a)if(!Er(t[r])){e&&e.push(-1);continue t}if(void 0!==t){e.push(r);for(let n=0;n<i.length;++n){if(ko(i[n][r])!==t[n]){yield e,t=i.map((t=>ko(t[r]))),e=[r];continue t}}}else e&&(yield e),t=i.map((t=>ko(t[r]))),e=[r]}e&&(yield e)}}function Fl(t,n,e,r){!function(t,n,e,r){let o;switch(n.clip){case"frame":{const{width:n,height:i,marginLeft:a,marginRight:l,marginTop:s,marginBottom:c}=e,u=Rl();o=`url(#${u})`,t=da("svg:g",r).call((t=>t.append("svg:clipPath").attr("id",u).append("rect").attr("x",a).attr("y",s).attr("width",n-l-a).attr("height",i-s-c))).each((function(){this.appendChild(t.node()),t.node=()=>this}));break}case"sphere":{const{projection:n}=r;if(!n)throw new Error('the "sphere" clip option requires a projection');const e=Rl();o=`url(#${e})`,t.append("clipPath").attr("id",e).append("path").attr("d",ct(n)({type:"Sphere"}));break}}Pl(t,"aria-label",n.ariaLabel),Pl(t,"aria-description",n.ariaDescription),Pl(t,"aria-hidden",n.ariaHidden),Pl(t,"clip-path",o)}(t,n,e,r),Pl(t,"fill",n.fill),Pl(t,"fill-opacity",n.fillOpacity),Pl(t,"stroke",n.stroke),Pl(t,"stroke-width",n.strokeWidth),Pl(t,"stroke-opacity",n.strokeOpacity),Pl(t,"stroke-linejoin",n.strokeLinejoin),Pl(t,"stroke-linecap",n.strokeLinecap),Pl(t,"stroke-miterlimit",n.strokeMiterlimit),Pl(t,"stroke-dasharray",n.strokeDasharray),Pl(t,"stroke-dashoffset",n.strokeDashoffset),Pl(t,"shape-rendering",n.shapeRendering),Pl(t,"paint-order",n.paintOrder),Pl(t,"pointer-events",n.pointerEvents)}function ql(t,n){!function(t,n,e){null!=e&&t.style(n,e)}(t,"mix-blend-mode",n.mixBlendMode),Pl(t,"opacity",n.opacity)}function _l(t,n,e){t.each((function(t){const r=n(t);if(null!=r){const t=this.ownerDocument.createElementNS(Le.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(Le.xlink,"href",r),null!=e&&t.setAttribute("target",e),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function Pl(t,n,e){null!=e&&t.attr(n,e)}function Ul(t,n,{x:e,y:r},o=Nl,i=Nl){o+=n.dx,i+=n.dy,e?.bandwidth&&(o+=e.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function Vl(t,n){if((t=Zr(t))!==n)return t}function Hl(t,n){if((t=Gr(t))!==n)return t}const Yl=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function Zl(t){if(void 0===t)return"plot-d6a7b5";if(t=`${t}`,!Yl.test(t))throw new Error(`invalid class name: ${t}`);return t}function Gl(t,n){if("string"==typeof n)t.property("style",n);else if(null!=n)for(const e of t)Object.assign(e.style,n)}function Jl({frameAnchor:t},{width:n,height:e,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?n-o:(a+n-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?e-i:(r+e-i)/2]}function Kl({x:t,y:n,fy:e,fx:r},o,{projection:i,aspectRatio:a},{width:l,marginTopDefault:s,marginRightDefault:c,marginBottomDefault:u,marginLeftDefault:f}){const h=e?e.scale.domain().length:1,d=function(t,n){if("function"==typeof t?.stream)return ra;if(ho(t)&&(t=t.type),null==t)return function(t){for(const n of t)if(n.channels.geometry)return!0;return!1}(n)?ra:void 0;if("function"!=typeof t){const{aspectRatio:n}=ia(t);if(n)return n}return ra}(i,o);if(d){const t=(1.1*h-.1)/(1.1*(r?r.scale.domain().length:1)-.1)*d,n=Math.max(.1,Math.min(10,t));return Math.round((l-f-c)*n+s+u)}const p=n?ml(n)?n.scale.domain().length:Math.max(7,17/h):1;if(null!=a){if(a=+a,!(isFinite(a)&&a>0))throw new Error(`invalid aspectRatio: ${a}`);const o=Ql("y",n)/(Ql("x",t)*a),i=r?r.scale.bandwidth():1,h=e?e.scale.bandwidth():1;return(o*(i*(l-f-c)-t.insetLeft-t.insetRight)+n.insetTop+n.insetBottom)/h+s+u}return!(!n&&!e)*Math.max(1,Math.min(60,p*h))*20+30*!!r+60}function Ql(t,n){if(!n)throw new Error(`aspectRatio requires ${t} scale`);const{type:e,domain:r}=n;let o;switch(e){case"linear":case"utc":case"time":o=Number;break;case"pow":{const t=n.scale.exponent();o=n=>Math.pow(n,t);break}case"log":o=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${e}`)}const[i,a]=ne(r);return Math.abs(o(a)-o(i))}function Xl(t,{fx:n,fy:e}){const r=wo(t),o=n?.value,i=e?.value;return n&&e?G(r,(t=>(t.fx=o[t[0]],t.fy=i[t[0]],t)),(t=>o[t]),(t=>i[t])):n?G(r,(t=>(t.fx=o[t[0]],t)),(t=>o[t])):G(r,(t=>(t.fy=i[t[0]],t)),(t=>i[t]))}function ts(t){const n=[],e=new Uint32Array(J(t,(t=>t.length)));for(const r of t){let o=0;for(const n of t)r!==n&&(e.set(n,o),o+=n.length);n.push(e.slice(0,o))}return n}const ns=new Map([["top",es],["right",is],["bottom",rs],["left",os],["top-left",as(es,os)],["top-right",as(es,is)],["bottom-left",as(rs,os)],["bottom-right",as(rs,is)],["top-empty",function(t,{y:n},{x:e,y:r,empty:o}){if(o)return!1;const i=n?.indexOf(r);if(i>0){const r=n[i-1];return t.find((t=>t.x===e&&t.y===r))?.empty}}],["right-empty",function(t,{x:n},{x:e,y:r,empty:o}){if(o)return!1;const i=n?.indexOf(e);if(i<n?.length-1){const e=n[i+1];return t.find((t=>t.x===e&&t.y===r))?.empty}}],["bottom-empty",function(t,{y:n},{x:e,y:r,empty:o}){if(o)return!1;const i=n?.indexOf(r);if(i<n?.length-1){const r=n[i+1];return t.find((t=>t.x===e&&t.y===r))?.empty}}],["left-empty",function(t,{x:n},{x:e,y:r,empty:o}){if(o)return!1;const i=n?.indexOf(e);if(i>0){const e=n[i-1];return t.find((t=>t.x===e&&t.y===r))?.empty}}],["empty",function(t,n,{empty:e}){return e}]]);function es(t,{y:n},{y:e}){return!n||0===n.indexOf(e)}function rs(t,{y:n},{y:e}){return!n||n.indexOf(e)===n.length-1}function os(t,{x:n},{x:e}){return!n||0===n.indexOf(e)}function is(t,{x:n},{x:e}){return!n||n.indexOf(e)===n.length-1}function as(t,n){return function(){return t.apply(null,arguments)&&n.apply(null,arguments)}}function ls(t,{channels:{fx:n,fy:e},groups:r}){return n&&e?t.map((({x:t,y:n})=>r.get(t)?.get(n)??[])):n?t.map((({x:t})=>r.get(t)??[])):t.map((({y:t})=>r.get(t)??[]))}function ss(t){return ml(t)&&void 0===t.interval?void 0:"tabular-nums"}function cs(t,n){if(null==n)return n;const e=t(n);if(!e)throw new Error(`scale not found: ${n}`);return e}function us(t,n={},e){let{columns:r,tickFormat:o,fontVariant:i=ss(t),swatchSize:a=15,swatchWidth:l=a,swatchHeight:s=a,marginLeft:c=0,className:u,style:f,width:h}=n;const d=ha(n);u=Zl(u),o=function(t,n){return void 0===t?To(n)?zl:Zr:"function"==typeof t?t:("string"==typeof t?To(n)?ze:Oe:Xr)(t)}(o,t.domain);const p=da("div",d).attr("class",`${u}-swatches ${u}-swatches-${null!=r?"columns":"wrap"}`);let m;return null!=r?(m=`.${u}-swatches-columns .${u}-swatch {\n  display: flex;\n  align-items: center;\n  break-inside: avoid;\n  padding-bottom: 1px;\n}\n.${u}-swatches-columns .${u}-swatch::before {\n  flex-shrink: 0;\n}\n.${u}-swatches-columns .${u}-swatch-label {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}`,p.style("columns",r).selectAll().data(t.domain).enter().append("div").attr("class",`${u}-swatch`).call(e,t,l,s).call((t=>t.append("div").attr("class",`${u}-swatch-label`).attr("title",o).text(o)))):(m=`.${u}-swatches-wrap {\n  display: flex;\n  align-items: center;\n  min-height: 33px;\n  flex-wrap: wrap;\n}\n.${u}-swatches-wrap .${u}-swatch {\n  display: inline-flex;\n  align-items: center;\n  margin-right: 1em;\n}`,p.selectAll().data(t.domain).enter().append("span").attr("class",`${u}-swatch`).call(e,t,l,s).append((function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))}))),p.call((t=>t.insert("style","*").text(`.${u}-swatches {\n  font-family: system-ui, sans-serif;\n  font-size: 10px;\n  margin-bottom: 0.5em;\n}\n.${u}-swatch > svg {\n  margin-right: 0.5em;\n  overflow: visible;\n}\n${m}`))).style("margin-left",c?+c+"px":null).style("width",void 0===h?null:+h+"px").style("font-variant",Vl(i,"normal")).call(Gl,f).node()}const fs=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:e=1,stroke:r=(void 0!==t.hint?.stroke?t.hint.stroke:qo(n)?"currentColor":"none"),strokeOpacity:o=1,strokeWidth:i=1.5,r:a=4.5,...l}={},s){const[c,u]=io(n),[f,h]=io(r),d=cs(s,c),p=cs(s,f),m=a*a*Math.PI;return e=ao(e)[1],o=ao(o)[1],i=ao(i)[1],us(t,l,((n,r,a,l)=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("width",a).attr("height",l).attr("fill","color"===c?t=>d.scale(t):u).attr("fill-opacity",e).attr("stroke","color"===f?t=>p.scale(t):h).attr("stroke-opacity",o).attr("stroke-width",i).append("path").attr("d",(n=>{const e=Se();return t.scale(n).draw(e,m),e}))))}],["color",ps],["opacity",function({type:t,interpolate:n,...e},{legend:r=!0,color:o=Re(0,0,0),...i}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===r&&(r="ramp");if("ramp"!==`${r}`.toLowerCase())throw new Error(`${r} opacity legends are not supported`);return ps({type:t,...e,interpolate:ms(o)},{legend:r,...i})}]]);function hs(t={}){for(const[n,e]of fs){const r=t[n];if(po(r)){const o=ha(t);let i;if("symbol"===n){const{fill:n,stroke:e=(void 0===n&&po(t.color)?"color":void 0)}=t;i={fill:n,stroke:e}}return e(cl(n,r,i),ds(o,r,t),(n=>po(t[n])?cl(n,t[n]):null))}}throw new Error("unknown legend type; no scale found")}function ds({className:t,...n},{label:e,ticks:r,tickFormat:o}={},i){return function(t={},...n){let e=t;for(const r of n)for(const n in r)if(void 0===e[n]){const o=r[n];e===t?e={...e,[n]:o}:e[n]=o}return e}(i,{className:t,...n},{label:e,ticks:r,tickFormat:o})}function ps(t,{legend:n=!0,...e}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,{opacity:n,...e}={}){if(!ml(t)&&!yl(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return us(t,e,((t,e,r,o)=>t.append("svg").attr("width",r).attr("height",o).attr("fill",e.scale).attr("fill-opacity",ao(n)[1]).append("rect").attr("width","100%").attr("height","100%")))}(t,e);case"ramp":return function(t,n){let{label:e=t.label,tickSize:r=6,width:o=240,height:i=44+r,marginTop:a=18,marginRight:l=0,marginBottom:s=16+r,marginLeft:c=0,style:u,ticks:f=(o-c-l)/64,tickFormat:h,fontVariant:d=ss(t),round:p=!0,opacity:m,className:y}=n;const g=ha(n);y=Zl(y),m=ao(m)[1],null===h&&(h=()=>null);const v=da("svg",g).attr("class",`${y}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",o).attr("height",i).attr("viewBox",`0 0 ${o} ${i}`).call((t=>t.append("style").text(`.${y}-ramp {\n  display: block;\n  background: white;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n  overflow: visible;\n}\n.${y}-ramp text {\n  white-space: pre;\n}`))).call(Gl,u);let x,w=t=>t.selectAll(".tick line").attr("y1",a+s-i);const b=p?(t,n)=>t.rangeRound(n):(t,n)=>t.range(n),{type:k,domain:$,range:M,interpolate:L,scale:A,pivot:E}=t;if(L){const t=void 0===M?L:ye(1===L.length?Fa(L):L,M);x=b(A.copy(),Bt(re(c,o-l),Math.min($.length+(void 0!==E),void 0===M?1/0:M.length)));const n=256,e=g.document.createElement("canvas");e.width=n,e.height=1;const r=e.getContext("2d");for(let e=0,o=n-1;e<n;++e)r.fillStyle=t(e/o),r.fillRect(e,0,1,1);v.append("image").attr("opacity",m).attr("x",c).attr("y",a).attr("width",o-c-l).attr("height",i-a-s).attr("preserveAspectRatio","none").attr("xlink:href",e.toDataURL())}else if("threshold"===k){const t=$,n=void 0===h?t=>t:"string"==typeof h?Oe(h):h;x=b(Jn().domain([-1,M.length-1]),[c,o-l]),v.append("g").attr("fill-opacity",m).selectAll().data(M).enter().append("rect").attr("x",((t,n)=>x(n-1))).attr("y",a).attr("width",((t,n)=>x(n)-x(n-1))).attr("height",i-a-s).attr("fill",(t=>t)),f=uo(t,((t,n)=>n)),h=e=>n(t[e],e)}else x=b(ke().domain($),[c,o-l]),v.append("g").attr("fill-opacity",m).selectAll().data($).enter().append("rect").attr("x",x).attr("y",a).attr("width",Math.max(0,x.bandwidth()-1)).attr("height",i-a-s).attr("fill",A),w=()=>{};return v.append("g").attr("transform",`translate(0,${i-s})`).call(Ne(x).ticks(Array.isArray(f)?null:f,"string"==typeof h?h:void 0).tickFormat("function"==typeof h?h:void 0).tickSize(r).tickValues(Array.isArray(f)?f:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Vl(d,"normal")).call(w).call((t=>t.select(".domain").remove())),void 0!==e&&v.append("text").attr("x",c).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(e),v.node()}(t,e);default:throw new Error(`unknown legend type: ${n}`)}}function ms(t){const{r:n,g:e,b:r}=Re(t)||Re(0,0,0);return t=>`rgba(${n},${e},${r},${t})`}class ys{constructor(t,n={},e={},r){const{facet:o="auto",facetAnchor:i,fx:a,fy:l,sort:s,dx:c=0,dy:u=0,margin:f=0,marginTop:h=f,marginRight:d=f,marginBottom:p=f,marginLeft:m=f,clip:y,channels:g}=e;if(this.data=t,this.sort=yo(s)?s:null,this.initializer=ai(e).initializer,this.transform=this.initializer?e.transform:ii(e).transform,null===o||!1===o?this.facet=null:(this.facet=so(!0===o?"include":o,"facet",["auto","include","exclude","super"]),this.fx=a,this.fy=l),this.facetAnchor=function(t){if(null==t)return null;const n=ns.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid facet anchor: ${t}`)}(i),n=Vo(n),void 0!==g&&(n={...Vo(g),...n}),void 0!==r&&(n={...Cl(this,e,r),...n}),this.channels=Object.fromEntries(Object.entries(n).map((([t,n])=>{const{value:e}=n;return mo(e)&&(n={...n,value:e.value},void 0!==e.scale&&(n.scale=e.scale)),[t,n]})).filter((([t,{value:n,optional:e}])=>{if(null!=n)return!0;if(e)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+c,this.dy=+u,this.marginTop=+h,this.marginRight=+d,this.marginBottom=+p,this.marginLeft=+m,this.clip=function(t){return!0===t?t="frame":!1===t&&(t=null),lo(t,"clip",["frame","sphere"])}(y),"super"===this.facet){if(a||l)throw new Error("super-faceting cannot use fx or fy");for(const t in this.channels){const{scale:e}=n[t];if("x"===e||"y"===e)throw new Error("super-faceting cannot use x or y")}}}initialize(t,n){let e=co(this.data);void 0===t&&null!=e&&(t=[wo(e)]);const r=t;null!=this.transform&&(({facets:t,data:e}=this.transform(e,t)),e=co(e)),void 0!==t&&(t.original=r);const o=Ui(this.channels,e);return null!=this.sort&&function(t,n,e,r,o){const{reverse:i,reduce:a=!0,limit:l}=o;for(const s in o){if(!Qo.has(s))continue;let{value:c,reverse:u=i,reduce:f=a,limit:h=l}=No(o[s]);if(void 0===u&&(u="width"===c||"height"===c),null==f||!1===f)continue;const d="fx"===s||"fy"===s?Zi(n,r[s]):Yi(e,s);if(!d)throw new Error(`missing channel for scale: ${s}`);const p=d.value,[m=0,y=1/0]=So(h)?h:h<0?[h]:[0,h];if(null==c)d.domain=()=>{let t=Array.from(new K(p));return u&&(t=t.reverse()),0===m&&y===1/0||(t=t.slice(m,y)),t};else{const n="data"===c?t:"height"===c?Gi(e,"y1","y2"):"width"===c?Gi(e,"x1","x2"):Ji(e,c,"y"===c?"y2":"x"===c?"x2":void 0),r=Oi(!0===f?"max":f,n);d.domain=()=>{let t=G(wo(p),(t=>r.reduceIndex(t,n)),(t=>p[t]));return t=Y(t,u?Qi:Ki),0===m&&y===1/0||(t=t.slice(m,y)),t.map(Jr)}}}}(e,t,o,n,this.sort),{data:e,facets:t,channels:o}}filter(t,n,e){for(const r in n){const{filter:o=Er}=n[r];if(null!==o){const n=e[r];t=t.filter((t=>o(n[t])))}}return t}project(t,n,e){ua("x","y",t,n,e),ua("x1","y1",t,n,e),ua("x2","y2",t,n,e)}scale(t,n,e){const r=Vi(t,n);return e.projection&&this.project(t,r,e),r}}function gs(...t){return t.plot=ys.prototype.plot,t}const vs=Math.PI/180;function xs({inset:t,insetLeft:n,insetRight:e,...r}={}){return[n,e]=bs(t,n,e),{inset:t,insetLeft:n,insetRight:e,...r}}function ws({inset:t,insetTop:n,insetBottom:e,...r}={}){return[n,e]=bs(t,n,e),{inset:t,insetTop:n,insetBottom:e,...r}}function bs(t,n,e){return void 0===t&&void 0===n&&void 0===e?Nl?[1,0]:[.5,.5]:[n,e]}function ks(t,{interval:n}){return(t={...No(t)}).interval=zo(void 0===t.interval?n:t.interval),t}function $s(t,n,e,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=e,{value:l,interval:s}=ks(o,e);if(null==l||null==s&&!r)return e;const c=Ao(o);if(null==s){let n;const r={transform:t=>n||(n=Fr(t,l)),label:c};return{...e,[t]:void 0,[`${t}1`]:void 0===i?r:i,[`${t}2`]:void 0===a?r:a}}let u,f;function h(t){return void 0!==f&&t===u?f:f=uo(Fr(u=t,l),(t=>s.floor(t)))}return n({...e,[t]:void 0,[`${t}1`]:void 0===i?{transform:h,label:c}:i,[`${t}2`]:void 0===a?{transform:t=>h(t).map((t=>s.offset(t))),label:c}:a})}function Ms(t,n,e){const{[t]:r}=e,{value:o,interval:i}=ks(r,e);return null==o||null==i?e:n({...e,[t]:{label:Ao(r),transform:t=>{const n=uo(Fr(t,o),(t=>i.floor(t))),e=n.map((t=>i.offset(t)));return n.map(To(n)?(t,n)=>null==t||isNaN(t=+t)||null==(n=e[n])||isNaN(n=+n)?void 0:new Date((t+n)/2):(t,n)=>null==t||null==(n=e[n])?NaN:(+t+ +n)/2)}}})}function Ls(t={}){return $s("x",xs,t,!0)}function As(t={}){return $s("y",ws,t,!0)}function Es(t={}){return $s("x",xs,t)}function zs(t={}){return $s("y",ws,t)}function Os(t={}){return Ms("x",xs,t)}function Ns(t={}){return Ms("y",ws,t)}const Ss={ariaLabel:"rule",fill:null,stroke:"currentColor"};class Rs extends ys{constructor(t,n={}){const{x:e,y1:r,y2:o,inset:i=0,insetTop:a=i,insetBottom:l=i}=n;super(t,{x:{value:e,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},n,Ss),this.insetTop=Gr(a),this.insetBottom=Gr(l)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y1:s,y2:c}=e,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:y,insetBottom:g}=this;return da("svg:g",o).call(Fl,this,r).call(Ul,this,{x:l&&i},Nl,0).call((n=>n.selectAll().data(t).enter().append("line").call(ql,this).attr("x1",l?t=>l[t]:(p+u-d)/2).attr("x2",l?t=>l[t]:(p+u-d)/2).attr("y1",s&&!gl(a)?t=>s[t]+y:h+y).attr("y2",c&&!gl(a)?a.bandwidth?t=>c[t]+a.bandwidth()-g:t=>c[t]-g:f-m-g).call(jl,this,e))).node()}}class Cs extends ys{constructor(t,n={}){const{x1:e,x2:r,y:o,inset:i=0,insetRight:a=i,insetLeft:l=i}=n;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:e,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},n,Ss),this.insetRight=Gr(a),this.insetLeft=Gr(l)}render(t,n,e,r,o){const{x:i,y:a}=n,{y:l,x1:s,x2:c}=e,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:y,insetRight:g}=this;return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{y:l&&a},0,Nl).call((n=>n.selectAll().data(t).enter().append("line").call(ql,this).attr("x1",s&&!gl(i)?t=>s[t]+y:p+y).attr("x2",c&&!gl(i)?i.bandwidth?t=>c[t]+i.bandwidth()-g:t=>c[t]-g:u-d-g).attr("y1",l?t=>l[t]:(h+f-m)/2).attr("y2",l?t=>l[t]:(h+f-m)/2).call(jl,this,e))).node()}}function Ts(t,n){let{x:e=Vr,y:r,y1:o,y2:i,...a}=zs(n);return[o,i]=js(r,o,i),new Rs(t,{...a,x:e,y1:o,y2:i})}function Is(t,n){let{y:e=Vr,x:r,x1:o,x2:i,...a}=Es(n);return[o,i]=js(r,o,i),new Cs(t,{...a,y:e,x1:o,x2:i})}function js(t,n,e){if(void 0===t){if(void 0===n){if(void 0!==e)return[0,e]}else if(void 0===e)return[0,n]}else{if(void 0===n)return void 0===e?[0,t]:[t,e];if(void 0===e)return[t,n]}return[n,e]}function Bs(t,...n){let e=n.length;for(let r=0,o=!0;r<e;++r)"function"!=typeof n[r]&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+n[r]+t[r+1]),n.splice(r,1),--r,--e);return r=>{let o=t[0];for(let i=0;i<e;++i)o+=n[i](r)+t[i+1];return o}}const Ws={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},Ds="­";class Fs extends ys{constructor(t,n={}){const{x:e,y:r,text:o=(So(t)&&Ro(t)?Vr:Ur),frameAnchor:i,textAnchor:a=(/right$/i.test(i)?"end":/left$/i.test(i)?"start":"middle"),lineAnchor:l=(/^top/i.test(i)?"top":/^bottom/i.test(i)?"bottom":"middle"),lineHeight:s=1,lineWidth:c=1/0,textOverflow:u,monospace:f,fontFamily:h=(f?"ui-monospace, monospace":void 0),fontSize:d,fontStyle:p,fontVariant:m,fontWeight:y,rotate:g}=n,[v,x]=ao(g,0),[w,b]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),Hs.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(d);var k;if(super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:w,optional:!0},rotate:{value:(k=v,null==k?null:{transform:t=>Fr(t,k,Float64Array),label:Ao(k)}),optional:!0},text:{value:o,filter:Nr,optional:!0}},n,Ws),this.rotate=x,this.textAnchor=Vl(a,"middle"),this.lineAnchor=so(l,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+s,this.lineWidth=+c,this.textOverflow=function(t){return null==t?null:so(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}(u),this.monospace=!!f,this.fontFamily=Zr(h),this.fontSize=b,this.fontStyle=Zr(p),this.fontVariant=Zr(m),this.fontWeight=Zr(y),this.frameAnchor=Po(i),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${c}`);this.splitLines=function({monospace:t,lineWidth:n,textOverflow:e}){if(null!=e||n==1/0)return t=>t.split(/\r\n?|\n/g);const r=t?Gs:Zs,o=100*n;return t=>function(t,n,e){const r=[];let o,i=0;for(const[a,l,s]of function*(t){let n=0,e=0;const r=t.length;for(;e<r;){let r=1;switch(t[e]){case Ds:case"-":++e,yield[n,e,!1],n=e;break;case" ":for(yield[n,e,!1];" "===t[++e];);n=e;break;case"\r":"\n"===t[e+1]&&++r;case"\n":yield[n,e,!0],e+=r,n=e;break;default:++e}}yield[n,e,!0]}(t))void 0===o&&(o=a),i>o&&e(t,o,l)>n&&(r.push(t.slice(o,i)+(t[i-1]===Ds?"-":"")),o=a),s?(r.push(t.slice(o,l)),o=void 0):i=l;return r}(t,o,r)}(this),this.clipLine=function({monospace:t,lineWidth:n,textOverflow:e}){if(null==e||n==1/0)return t=>t;const r=t?Gs:Zs,o=100*n;switch(e){case"clip-start":return t=>Qs(t,o,r,"");case"clip-end":return t=>Ks(t,o,r,"");case"ellipsis-start":return t=>Qs(t,o,r,"…");case"ellipsis-middle":return t=>function(t,n,e,r){t=t.trim();const o=e(t);if(o<=n)return t;const i=e(r)/2,[a,l]=Js(t,n/2,e,i),[s]=Js(t,o-n/2-l+i,e,-i);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(nc(t,s)).trimStart()}(t,o,r,"…");case"ellipsis-end":return t=>Ks(t,o,r,"…")}}(this)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,rotate:c,text:u,title:f,fontSize:h}=e,{rotate:d}=this,[p,m]=Jl(this,r);return da("svg:g",o).call(Fl,this,r,o).call(Vs,this,u,r).call(Ul,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append("text").call(ql,this).call(qs,this,u,f).attr("transform",Bs`translate(${l?t=>l[t]:p},${s?t=>s[t]:m})${c?t=>` rotate(${c[t]})`:d?` rotate(${d})`:""}`).call(Pl,"font-size",h&&(t=>h[t])).call(jl,this,e))).node()}}function qs(t,n,e,r){if(!e)return;const{lineAnchor:o,lineHeight:i,textOverflow:a,splitLines:l,clipLine:s}=n;t.each((function(t){const n=l(Ol(e[t])??"").map(s),c=n.length,u="top"===o?.71:"bottom"===o?1-c:(164-100*c)/200;if(c>1)for(let t=0;t<c;++t){if(!n[t])continue;const e=this.ownerDocument.createElementNS(Le.svg,"tspan");e.setAttribute("x",0),e.setAttribute("y",(u+t)*i+"em"),e.textContent=n[t],this.appendChild(e)}else u&&this.setAttribute("y",u*i+"em"),this.textContent=n[0];if(a&&!r&&n[0]!==e[t]){const n=this.ownerDocument.createElementNS(Le.svg,"title");n.textContent=e[t],this.appendChild(n)}}))}function _s(t,n={}){let{x:e,y:r,...o}=n;return void 0===n.frameAnchor&&([e,r]=vo(e,r)),new Fs(t,{...o,x:e,y:r})}function Ps(t,n={}){const{x:e=Vr,...r}=n;return new Fs(t,Ns({...r,x:e}))}function Us(t,n={}){const{y:e=Vr,...r}=n;return new Fs(t,Os({...r,y:e}))}function Vs(t,n,e){Pl(t,"text-anchor",n.textAnchor),Pl(t,"font-family",n.fontFamily),Pl(t,"font-size",n.fontSize),Pl(t,"font-style",n.fontStyle),Pl(t,"font-variant",void 0===n.fontVariant?function(t){return Bo(t)||To(t)?"tabular-nums":void 0}(e):n.fontVariant),Pl(t,"font-weight",n.fontWeight)}const Hs=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);const Ys={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function Zs(t,n=0,e=t.length){let r=0;for(let o=n;o<e;o=nc(t,o))r+=Ys[t[o]]??(rc(t,o)?120:Ys.e);return r}function Gs(t,n=0,e=t.length){let r=0;for(let o=n;o<e;o=nc(t,o))r+=rc(t,o)?200:100;return r}function Js(t,n,e,r){const o=[];let i=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=nc(t,a);const s=e(t,a,l);if(i+s>n){for(i+=r;i>n&&a>0;)l=a,a=o.pop(),i-=e(t,a,l);return[a,n-i]}i+=s,o.push(a)}return[-1,0]}function Ks(t,n,e,r){t=t.trim();const o=e(r),[i]=Js(t,n,e,o);return i<0?t:t.slice(0,i).trimEnd()+r}function Qs(t,n,e,r){const o=e(t=t.trim());if(o<=n)return t;const i=e(r),[a]=Js(t,o-n+i,e,-i);return a<0?r:r+t.slice(nc(t,a)).trimStart()}const Xs=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,tc=/\p{Extended_Pictographic}/uy;function nc(t,n){return n+=function(t,n){const e=t.charCodeAt(n);if(e>=55296&&e<56320){const e=t.charCodeAt(n+1);return e>=56320&&e<57344}return!1}(t,n)?2:1,function(t,n){return!ec(t,n)&&(Xs.lastIndex=n,Xs.test(t))}(t,n)&&(n=Xs.lastIndex),function(t,n){return 8205===t.charCodeAt(n)}(t,n)?nc(t,n+1):n}function ec(t,n){return t.charCodeAt(n)<128}function rc(t,n){return!ec(t,n)&&(tc.lastIndex=n,tc.test(t))}const oc={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},ic=3.5,ac=5*ic,lc={draw(t,n,e){const r=n*e/ac;t.moveTo(0,0),t.lineTo(0,-n),t.moveTo(-r,r-n),t.lineTo(0,-n),t.lineTo(r,r-n)}},sc={draw(t,n,e){t.moveTo(-e,0),t.lineTo(0,-n),t.lineTo(e,0)}},cc=new Map([["arrow",lc],["spike",sc]]);class uc extends ys{constructor(t,n={}){const{x:e,y:r,r:o=ic,length:i,rotate:a,shape:l=lc,anchor:s="middle",frameAnchor:c}=n,[u,f]=ao(i,12),[h,d]=ao(a,0);super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:u,scale:"length",optional:!0},rotate:{value:h,optional:!0}},n,oc),this.r=+o,this.length=f,this.rotate=d,this.shape=function(t){if(function(t){return t&&"function"==typeof t.draw}(t))return t;const n=cc.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid shape: ${t}`)}(l),this.anchor=so(s,"anchor",["start","middle","end"]),this.frameAnchor=Po(c)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,length:c,rotate:u}=e,{length:f,rotate:h,anchor:d,shape:p,r:m}=this,[y,g]=Jl(this,r);return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append("path").call(ql,this).attr("transform",Bs`translate(${l?t=>l[t]:y},${s?t=>s[t]:g})${u?t=>` rotate(${u[t]})`:h?` rotate(${h})`:""}${"start"===d?"":"end"===d?c?t=>` translate(0,${c[t]})`:` translate(0,${f})`:c?t=>` translate(0,${c[t]/2})`:` translate(0,${f/2})`}`).attr("d",c?t=>{const n=Se();return p.draw(n,c[t],m),n}:(()=>{const t=Se();return p.draw(t,f,m),t})()).call(jl,this,e))).node()}}function fc(t,n={}){let{x:e,y:r,...o}=n;return void 0===n.frameAnchor&&([e,r]=vo(e,r)),new uc(t,{...o,x:e,y:r})}function hc(t,n={}){const{x:e=Vr,...r}=n;return new uc(t,{...r,x:e})}function dc(t,n={}){const{y:e=Vr,...r}=n;return new uc(t,{...r,y:e})}function pc(t,n={}){const{shape:e=sc,stroke:r=oc.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:l="start",...s}=n;return fc(t,{...s,shape:e,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:l})}function mc(t,n){return arguments.length<2&&!So(t)&&(n=t,t=null),void 0===n&&(n={}),[t,n]}function yc({anchor:t}={},n){return void 0===t?n[0]:so(t,"anchor",n)}function gc(t){return yc(t,["left","right"])}function vc(t){return yc(t,["right","left"])}function xc(t){return yc(t,["bottom","top"])}function wc(t){return yc(t,["top","bottom"])}function bc(){const[t,n]=mc(...arguments);return Lc("y",gc(n),t,n)}function kc(){const[t,n]=mc(...arguments);return Lc("fy",vc(n),t,n)}function $c(){const[t,n]=mc(...arguments);return Ac("x",xc(n),t,n)}function Mc(){const[t,n]=mc(...arguments);return Ac("fx",wc(n),t,n)}function Lc(t,n,e,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("y"===t?6:0),tickPadding:m,tickRotate:y,x:g,margin:v,marginTop:x=(void 0===v?20:v),marginRight:w=(void 0===v?"right"===n?40:0:v),marginBottom:b=(void 0===v?20:v),marginLeft:k=(void 0===v?"left"===n?40:0:v),label:$,labelOffset:M,labelAnchor:L,...A}){return p=Gr(p),m=Gr(m),y=Gr(y),void 0!==L&&(L=so(L,"labelAnchor",["center","top","bottom"])),gs(p&&!qo(i)?function(t,n,e,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=n+("y"===t?"-empty":""),frameAnchor:l=n,tickSize:s,inset:c=0,insetLeft:u=c,insetRight:f=c,dx:h=0,y:d=("y"===t?void 0:null),...p}){return Ic(dc,t,`${t}-axis tick`,e,{strokeWidth:r,strokeLinecap:o,strokeLinejoin:i,facetAnchor:a,frameAnchor:l,y:d,...p,dx:"left"===n?+h-Nl+ +u:+h+Nl-f,anchor:"start",length:s,shape:"left"===n?Fc:qc})}(t,n,e,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,x:g,...A}):null,qo(s)?null:function(t,n,e,{facetAnchor:r=n+("y"===t?"-empty":""),frameAnchor:o=n,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>60?4*Math.cos(a*vs):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>60?"middle":"left"===n?"end":"start"),lineAnchor:f=(a>60?"top":a<-60?"bottom":"middle"),fontVariant:h,inset:d=0,insetLeft:p=d,insetRight:m=d,dx:y=0,y:g=("y"===t?void 0:null),...v}){return Ic(Us,t,`${t}-axis tick label`,e,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,y:g,...v,dx:"left"===n?+y-i-l+ +p:+y+ +i+ +l-m},(function(t,n,e){void 0===h&&(this.fontVariant=_c(t)),void 0===c&&(e.text=jc(t,n,s))}))}(t,n,e,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,x:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...A}),qo(s)||null===$?null:_s([],Tc({fill:s,fillOpacity:c,...A},(function(e,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="y"===t&&a.inset||a,h=L??(l.bandwidth?"center":"top"),d=M??("right"===n?c:f)-3;return"center"===h?(this.textAnchor=void 0,this.lineAnchor="right"===n?"bottom":"top",this.frameAnchor=n,this.rotate=-90):(this.textAnchor="right"===n?"end":"start",this.lineAnchor=h,this.frameAnchor=`${h}-${n}`,this.rotate=0),this.dy="top"===h?3-s:"bottom"===h?u-3:0,this.dx="right"===n?d:-d,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[void 0===$?Pc(t,l,h):$]}}}}))))}function Ac(t,n,e,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("x"===t?6:0),tickPadding:m,tickRotate:y,y:g,margin:v,marginTop:x=(void 0===v?"top"===n?30:0:v),marginRight:w=(void 0===v?20:v),marginBottom:b=(void 0===v?"bottom"===n?30:0:v),marginLeft:k=(void 0===v?20:v),label:$,labelAnchor:M,labelOffset:L,...A}){return p=Gr(p),m=Gr(m),y=Gr(y),void 0!==M&&(M=so(M,"labelAnchor",["center","left","right"])),gs(p&&!qo(i)?function(t,n,e,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=n+("x"===t?"-empty":""),frameAnchor:l=n,tickSize:s,inset:c=0,insetTop:u=c,insetBottom:f=c,dy:h=0,x:d=("x"===t?void 0:null),...p}){return Ic(hc,t,`${t}-axis tick`,e,{strokeWidth:r,strokeLinejoin:i,strokeLinecap:o,facetAnchor:a,frameAnchor:l,x:d,...p,dy:"bottom"===n?+h-Nl-f:+h+Nl+ +u,anchor:"start",length:s,shape:"bottom"===n?Wc:Dc})}(t,n,e,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,y:g,...A}):null,qo(s)?null:function(t,n,e,{facetAnchor:r=n+("x"===t?"-empty":""),frameAnchor:o=n,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>=10?4*Math.cos(a*vs):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>=10?a<0^"bottom"===n?"start":"end":"middle"),lineAnchor:f=(Math.abs(a)>=10?"middle":"bottom"===n?"top":"bottom"),fontVariant:h,inset:d=0,insetTop:p=d,insetBottom:m=d,dy:y=0,x:g=("x"===t?void 0:null),...v}){return Ic(Ps,t,`${t}-axis tick label`,e,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,x:g,...v,dy:"bottom"===n?+y+ +i+ +l-m:+y-i-l+ +p},(function(t,n,e){void 0===h&&(this.fontVariant=_c(t)),void 0===c&&(e.text=jc(t,n,s))}))}(t,n,e,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,y:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...A}),qo(s)||null===$?null:_s([],Tc({fill:s,fillOpacity:c,...A},(function(e,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="x"===t&&a.inset||a,h=M??(l.bandwidth?"center":"right"),d=L??("top"===n?s:u)-3;return"center"===h?(this.frameAnchor=n,this.textAnchor=void 0):(this.frameAnchor=`${n}-${h}`,this.textAnchor="right"===h?"end":"start"),this.lineAnchor=n,this.dy="top"===n?-d:d,this.dx="right"===h?c-3:"left"===h?3-f:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[void 0===$?Pc(t,l,h):$]}}}}))))}function Ec(){const[t,n]=mc(...arguments);return Sc("y",gc(n),t,n)}function zc(){const[t,n]=mc(...arguments);return Sc("fy",vc(n),t,n)}function Oc(){const[t,n]=mc(...arguments);return Rc("x",xc(n),t,n)}function Nc(){const[t,n]=mc(...arguments);return Rc("fx",wc(n),t,n)}function Sc(t,n,e,{y:r=("y"===t?void 0:null),x:o=null,x1:i=("left"===n?o:null),x2:a=("right"===n?o:null),...l}){return Ic(Is,t,`${t}-grid`,e,{y:r,x1:i,x2:a,...Cc(l)})}function Rc(t,n,e,{x:r=("x"===t?void 0:null),y:o=null,y1:i=("top"===n?o:null),y2:a=("bottom"===n?o:null),...l}){return Ic(Ts,t,`${t}-grid`,e,{x:r,y1:i,y2:a,...Cc(l)})}function Cc({color:t="currentColor",opacity:n=.1,stroke:e=t,strokeOpacity:r=n,strokeWidth:o=1,...i}){return{stroke:e,strokeOpacity:r,strokeWidth:o,...i}}function Tc({fill:t,fillOpacity:n,fontFamily:e,fontSize:r,fontStyle:o,fontWeight:i,monospace:a,pointerEvents:l,shapeRendering:s},c){return[,t]=io(t),[,n]=ao(n),{facet:"super",x:null,y:null,fill:t,fillOpacity:n,fontFamily:e,fontSize:r,fontStyle:o,fontWeight:i,monospace:a,pointerEvents:l,shapeRendering:s,initializer:c}}function Ic(t,n,e,r,o,i){let a;const l=t(r,ai(o,(function(t,e,r,l){const{[n]:s}=l;if(!s)throw new Error(`missing scale: ${n}`);let{ticks:c,tickSpacing:u,interval:f}=o;if(pl(s)&&"string"==typeof c&&(f=c,c=void 0),null==t){if(So(c))t=co(c);else if(s.ticks)if(void 0!==c)t=s.ticks(c);else if(f=Oo(void 0===f?s.interval:f,s.type),void 0!==f){const[n,e]=ne(s.domain());t=f.range(n,f.offset(f.floor(e)))}else{const[e,r]=ne(s.range());c=(r-e)/(void 0===u?"x"===n?80:35:u),t=s.ticks(c)}else t=s.domain();"y"===n||"x"===n?e=[wo(t)]:(a[n]={scale:n,value:Vr},e=void 0)}return i?.call(this,s,c,a),{data:t,facets:e,channels:Object.fromEntries(Object.entries(a).map((([n,e])=>[n,{...e,value:Fr(t,e.value)}])))}})));return null==r?(a=l.channels,l.channels={}):a={},l.ariaLabel=e,l}function jc(t,n,e){return{value:Bc(t,n,e)}}function Bc(t,n,e){return t.tickFormat?t.tickFormat(So(n)?null:n,e):void 0===e?Ol:"string"==typeof e?(To(t.domain())?ze:Oe)(e):Xr(e)}const Wc={draw(t,n){t.moveTo(0,0),t.lineTo(0,n)}},Dc={draw(t,n){t.moveTo(0,0),t.lineTo(0,-n)}},Fc={draw(t,n){t.moveTo(0,0),t.lineTo(-n,0)}},qc={draw(t,n){t.moveTo(0,0),t.lineTo(n,0)}};function _c(t){return t.bandwidth&&void 0===t.interval?void 0:"tabular-nums"}function Pc(t,n,e){const r=n.label;if(n.bandwidth||!r?.inferred)return r;const o=function(t){return Math.sign(Uo(t.domain()))*Math.sign(Uo(t.range()))}(n);return o?"x"===t||"center"===e?"x"===t==o<0?`← ${r}`:`${r} →`:`${o<0?"↑ ":"↓ "}${r}`:r}const Uc={ariaLabel:"frame",fill:"none",stroke:"currentColor"},Vc={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square"};class Hc extends ys{constructor(t={}){const{anchor:n=null,inset:e=0,insetTop:r=e,insetRight:o=e,insetBottom:i=e,insetLeft:a=e,rx:l,ry:s}=t;super(void 0,void 0,t,null==n?Uc:Vc),this.anchor=lo(n,"anchor",["top","right","bottom","left"]),this.insetTop=Gr(r),this.insetRight=Gr(o),this.insetBottom=Gr(i),this.insetLeft=Gr(a),this.rx=Gr(l),this.ry=Gr(s)}render(t,n,e,r,o){const{marginTop:i,marginRight:a,marginBottom:l,marginLeft:s,width:c,height:u}=r,{anchor:f,insetTop:h,insetRight:d,insetBottom:p,insetLeft:m,rx:y,ry:g}=this,v=s+m,x=c-a-d,w=i+h,b=u-l-p;return da(f?"svg:line":"svg:rect",o).call(Fl,this,r,o).call(ql,this).call(Ul,this,{}).call("left"===f?t=>t.attr("x1",v).attr("x2",v).attr("y1",w).attr("y2",b):"right"===f?t=>t.attr("x1",x).attr("x2",x).attr("y1",w).attr("y2",b):"top"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",w).attr("y2",w):"bottom"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",b).attr("y2",b):t=>t.attr("x",v).attr("y",w).attr("width",x-v).attr("height",b-w).attr("rx",y).attr("ry",g)).node()}}function Yc(t){return new Hc(t)}function Zc(t={}){const{facet:n,style:e,caption:r,ariaLabel:o,ariaDescription:i}=t,a=Zl(t.className),l=void 0===t.marks?[]:Gc(t.marks),s=function(t,n){if(null==t)return;const{x:e,y:r}=t;if(null==e&&null==r)return;const o=co(t.data??e??r);if(void 0===o)throw new Error("missing facet data");const i={};null!=e&&(i.fx=Pi(o,{value:e,scale:"fx"}));null!=r&&(i.fy=Pi(o,{value:r,scale:"fy"}));Qc(i,n);const a=Xl(o,i);return{channels:i,groups:a,data:t.data}}(n,t),c=new Map;for(const n of l){const e=eu(n,s,t);e&&c.set(n,e)}const u=new Map;s&&nu(u,[s]),nu(u,c);const f=Gc(function(t,n,e){let{projection:r,x:o={},y:i={},fx:a={},fy:l={},axis:s,grid:c,facet:u={},facet:{axis:f=s,grid:h}=u,x:{axis:d=s,grid:p=(null===d?null:c)}=o,y:{axis:m=s,grid:y=(null===m?null:c)}=i,fx:{axis:g=f,grid:v=(null===g?null:h)}=a,fy:{axis:x=f,grid:w=(null===x?null:h)}=l}=e;(r||!po(o)&&!lu("x",t))&&(d=p=null);(r||!po(i)&&!lu("y",t))&&(m=y=null);n.has("fx")||(g=v=null);n.has("fy")||(x=w=null);void 0===d&&(d=!au(t,"x"));void 0===m&&(m=!au(t,"y"));void 0===g&&(g=!au(t,"fx"));void 0===x&&(x=!au(t,"fy"));!0===d&&(d="bottom");!0===m&&(m="left");!0===g&&(g="top"===d||null===d?"bottom":"top");!0===x&&(x="right"===m||null===m?"left":"right");const b=[];return ou(b,w,zc,l),ru(b,x,kc,"right","left",u,l),ou(b,v,Nc,a),ru(b,g,Mc,"top","bottom",u,a),ou(b,y,Ec,i),ru(b,m,bc,"left","right",e,i),ou(b,p,Oc,o),ru(b,d,$c,"bottom","top",e,o),b}(l,u,t));for(const n of f){const e=eu(n,s,t);e&&c.set(n,e)}l.unshift(...f);let h=function(t,n){const{fx:e,fy:r}=tl(t,n),o=e?.scale.domain(),i=r?.scale.domain();return o&&i?Ae(o,i).map((([t,n],e)=>({x:t,y:n,i:e}))):o?o.map(((t,n)=>({x:t,i:n}))):i?i.map(((t,n)=>({y:t,i:n}))):void 0}(u,t);if(void 0!==h){const t=s?ls(h,s):void 0;for(const n of l){if(null===n.facet||"super"===n.facet)continue;const e=c.get(n);void 0!==e&&(e.facetsIndex=null!=n.fx||null!=n.fy?ls(h,e):t)}const n=new Set;for(const{facetsIndex:t}of c.values())t?.forEach(((t,e)=>{t?.length>0&&n.add(e)}));h.forEach(0<n.size&&n.size<h.length?(t,e)=>t.empty=!n.has(e):t=>t.empty=!1);for(const t of l)if("exclude"===t.facet){const n=c.get(t);void 0!==n&&(n.facetsIndex=ts(n.facetsIndex))}}for(const n of Qo.keys())po(t[n])&&"fx"!==n&&"fy"!==n&&u.set(n,[]);const d=new Map;for(const n of l){if(d.has(n))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:e,channels:r}=c.get(n)??{},{data:o,facets:i,channels:a}=n.initialize(e,r);Qc(a,t),d.set(n,{data:o,facets:i,channels:a})}const p=tl(nu(u,d),t),m=nl(p),y=function(t,n,e={}){let r=.5-Nl,o=.5+Nl,i=.5+Nl,a=.5-Nl;for(const{marginTop:t,marginRight:e,marginBottom:l,marginLeft:s}of n)t>r&&(r=t),e>o&&(o=e),l>i&&(i=l),s>a&&(a=s);let{margin:l,marginTop:s=(void 0!==l?l:r),marginRight:c=(void 0!==l?l:o),marginBottom:u=(void 0!==l?l:i),marginLeft:f=(void 0!==l?l:a)}=e;s=+s,c=+c,u=+u,f=+f;let{width:h=640,height:d=Kl(t,n,e,{width:h,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:i,marginLeftDefault:a})+Math.max(0,s-r+u-i)}=e;h=+h,d=+d;const p={width:h,height:d,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f};if(t.fx||t.fy){let{margin:t,marginTop:n=(void 0!==t?t:s),marginRight:r=(void 0!==t?t:c),marginBottom:o=(void 0!==t?t:u),marginLeft:i=(void 0!==t?t:f)}=e.facet??{};n=+n,r=+r,o=+o,i=+i,p.facet={marginTop:n,marginRight:r,marginBottom:o,marginLeft:i}}return p}(p,l,t);!function(t,n){const{x:e,y:r,fx:o,fy:i}=t,a=o||i?rl(n):n;o&&il(o,a),i&&al(i,a);const l=o||i?ol(t,n):n;e&&il(e,l),r&&al(r,l)}(p,y);const{fx:g,fy:v}=m,x=g||v?ol(p,y):y,w=g||v?function({fx:t,fy:n},e){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=rl(e),c=t&&su(t),u=n&&su(n);return{marginTop:n?u[0]:r,marginRight:t?l-c[1]:o,marginBottom:n?s-u[1]:i,marginLeft:t?c[0]:a,inset:{marginTop:e.marginTop,marginRight:e.marginRight,marginBottom:e.marginBottom,marginLeft:e.marginLeft},width:l,height:s}}(m,y):y,b=ha(t,x,a),k=new Set;for(const[n,e]of d)if(null!=n.initializer){const r="super"===n.facet?w:x,o=n.initializer(e.data,e.facets,e.channels,m,r,b);if(void 0!==o.data&&(e.data=o.data),void 0!==o.facets&&(e.facets=o.facets),void 0!==o.channels){tu(o.channels),Object.assign(e.channels,o.channels);for(const n of Object.values(o.channels)){const{scale:e}=n;null!=e&&Qo.get(e)!==Ho&&(Xc(n,t),k.add(e))}const{fx:r,fy:i}=o.channels;if(null!=r||null!=i){const t=c.get(n)??{channels:{}};null!=r&&(t.channels.fx=r),null!=i&&(t.channels.fy=i),t.groups=Xl(e.data,t.channels),t.facetsIndex=e.facets=ls(h,t),c.set(n,t)}}}if(k.size){const n=new Map;nu(n,d,(t=>k.has(t))),nu(u,d,(t=>k.has(t)));const e=function(t,n){for(const e in t){const r=t[e],o=n[e];void 0===r.label&&o&&(r.label=o.label)}return t}(tl(n,t),p),r=nl(e);Object.assign(p,e),Object.assign(m,r)}for(const[t,n]of d)n.values=t.scale(n.channels,m,b);const{width:$,height:M}=y,L=da("svg",b).attr("class",a).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",$).attr("height",M).attr("viewBox",`0 0 ${$} ${M}`).attr("aria-label",o).attr("aria-description",i).call((t=>t.append("style").text(`.${a} {\n  display: block;\n  background: white;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n}\n.${a} text,\n.${a} tspan {\n  white-space: pre;\n}`))).call(Gl,e).node();if(void 0!==h){const t={x:g?.domain(),y:v?.domain()};h=function(t,{x:n,y:e}){return n&&=new Ee(n.map(((t,n)=>[t,n]))),e&&=new Ee(e.map(((t,n)=>[t,n]))),t.filter(n&&e?t=>n.has(t.x)&&e.has(t.y):n?t=>n.has(t.x):t=>e.has(t.y)).sort(n&&e?(t,r)=>n.get(t.x)-n.get(r.x)||e.get(t.y)-e.get(r.y):n?(t,e)=>n.get(t.x)-n.get(e.x):(t,n)=>e.get(t.y)-e.get(n.y))}(h,t),Lt(L).selectAll().data(h).enter().append("g").attr("aria-label","facet").attr("transform",function(t,n,{marginTop:e,marginLeft:r}){return t&&n?({x:o,y:i})=>`translate(${t(o)-r},${n(i)-e})`:t?({x:n})=>`translate(${t(n)-r},0)`:({y:t})=>`translate(0,${n(t)-e})`}(g,v,y)).each((function(n){let e=!0;for(const r of l){if("super"===r.facet)continue;const{channels:o,values:i,facets:a}=d.get(r);if(!(r.facetAnchor?.(h,t,n)??!n.empty))continue;let l=null;if(a){if(l=a[c.has(r)?n.i:0],l=r.filter(l,o,i),0===l.length)continue;l.fi=n.i}const s=r.render(l,m,i,x,b);null!=s&&(e=!1,this.appendChild(s))}e&&this.remove()}))}for(const t of l){if(void 0!==h&&"super"!==t.facet)continue;const{channels:n,values:e,facets:r}=d.get(t);let o=null;if(r&&(o=r[0],o=t.filter(o,n,e),0===o.length))continue;const i=t.render(o,m,e,w,b);null!=i&&L.appendChild(i)}let A=L;const E=function(t,n,e){const r=[];for(const[o,i]of fs){const a=e[o];if(a?.legend&&o in t){const e=i(t[o],ds(n,t[o],a),(n=>t[n]));null!=e&&r.push(e)}}return r}(p,b,t);if(null!=r||E.length>0){const{document:t}=b;A=t.createElement("figure"),A.style.maxWidth="initial";for(const t of E)A.appendChild(t);if(A.appendChild(L),null!=r){const n=t.createElement("figcaption");n.appendChild(r?.ownerDocument?r:t.createTextNode(r)),A.appendChild(n)}}A.scale=function(t){return n=>{if(!Qo.has(n=`${n}`))throw new Error(`unknown scale: ${n}`);return n in t?bl(t[n]):void 0}}(p),A.legend=function(t,n,e={}){return(r,o)=>{if(!fs.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return fs.get(r)(t[r],ds(n,e[r],o),(n=>t[n]))}}(p,b,t);const z=function(){const t=Xi;return Xi=0,t}();return z>0&&Lt(L).append("text").attr("x",$).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${z.toLocaleString("en-US")} warning${1===z?"":"s"}. Please check the console.`),A}function Gc(t){return t.flat(1/0).filter((t=>null!=t)).map(Jc)}function Jc(t){return"function"==typeof t.render?t:new Kc(t)}ys.prototype.plot=function({marks:t=[],...n}={}){return Zc({...n,marks:[...t,this]})};class Kc extends ys{constructor(t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function Qc(t,n){for(const e in t)Xc(t[e],n);return t}function Xc(t,n){const{scale:e}=t;if(null==e)return;const{type:r,percent:o,interval:i,transform:a=(o?t=>100*t:zo(i,r)?.floor)}=n[e]??{};null!=a&&(t.value=uo(t.value,a))}function tu(t){for(const n in t)Hi(n,t[n])}function nu(t,n,e=Yr){for(const{channels:r}of n.values())for(const n in r){const o=r[n],{scale:i}=o;if(null!=i&&e(i)){const n=t.get(i);void 0!==n?n.push(o):t.set(i,[o])}}return t}function eu(t,n,e){if(null===t.facet||"super"===t.facet)return;const{fx:r,fy:o}=t;if(null!=r||null!=o){const n=co(t.data??r??o);if(void 0===n)throw new Error(`missing facet data in ${t.ariaLabel}`);if(null===n)return;const i={};return null!=r&&(i.fx=Pi(n,{value:r,scale:"fx"})),null!=o&&(i.fy=Pi(n,{value:o,scale:"fy"})),Qc(i,e),{channels:i,groups:Xl(n,i)}}if(void 0===n)return;const{channels:i,groups:a,data:l}=n;if("auto"!==t.facet||t.data===l)return{channels:i,groups:a};l.length>0&&(a.size>1||1===a.size&&i.fx&&i.fy&&[...a][0][1].size>1)&&co(t.data)?.length===l.length&&ta(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function ru(t,n,e,r,o,i,a){if(!n)return;const l=/^\s*both\s*$/i.test(n);a=function(t,n,{line:e=n.line,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h=n.label,labelAnchor:d,labelOffset:p}){return{anchor:t,line:e,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h,labelAnchor:d,labelOffset:p}}(l?r:n,i,a);const{line:s}=a;e!==bc&&e!==$c||!s||_o(s)||t.push(Yc(function(t){const{anchor:n,line:e}=t;return{anchor:n,facetAnchor:n+"-empty",stroke:!0===e?void 0:e}}(a))),t.push(e(a)),l&&t.push(e({...a,anchor:o,label:null}))}function ou(t,n,e,r){n&&!_o(n)&&t.push(e(function(t,{stroke:n=(Do(t)?t:void 0),ticks:e=(iu(t)?t:void 0),tickSpacing:r,ariaLabel:o,ariaDescription:i}){return{stroke:n,ticks:e,tickSpacing:r,ariaLabel:o,ariaDescription:i}}(n,r)))}function iu(t){switch(typeof t){case"number":return!0;case"string":return!Do(t)}return So(t)||"function"==typeof t?.range}function au(t,n){const e=`${n}-axis `;return t.some((t=>t.ariaLabel?.startsWith(e)))}function lu(t,n){for(const e of n)for(const n in e.channels)if(e.channels[n].scale===t)return!0;return!1}function su(t){const n=t.domain();let e=t(n[0]),r=t(n[n.length-1]);return r<e&&([e,r]=[r,e]),[e,r+t.bandwidth()]}const cu=new Map([["basis",Te],["basis-closed",Ie],["basis-open",je],["bundle",Be],["bump-x",We],["bump-y",De],["cardinal",Fe],["cardinal-closed",qe],["cardinal-open",_e],["catmull-rom",Pe],["catmull-rom-closed",Ue],["catmull-rom-open",Ve],["linear",Ce],["linear-closed",He],["monotone-x",Ye],["monotone-y",Ze],["natural",Ge],["step",Je],["step-after",Ke],["step-before",Qe]]);function uu(t=Ce,n){if("function"==typeof t)return t;const e=cu.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in e)return e.beta(n);if("tension"in e)return e.tension(n);if("alpha"in e)return e.alpha(n)}return e}function fu(t=hu,n){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?hu:uu(t,n)}function hu(t){return Ce(t)}function du(t={y:"count"},n={}){[t,n]=wu(t,n);const{x:e,y:r}=n;return xu(bu(e,n,Vr),null,null,r,t,xs(n))}function pu(t={x:"count"},n={}){[t,n]=wu(t,n);const{x:e,y:r}=n;return xu(null,bu(r,n,Vr),e,null,t,ws(n))}function mu(t={fill:"count"},n={}){[t,n]=wu(t,n);const{x:e,y:r}=function(t){let{x:n,y:e}=t;return n=bu(n,t),e=bu(e,t),[n.value,e.value]=vo(n.value,e.value),{x:n,y:e}}(n);return xu(e,r,null,null,t,xs(ws(n)))}function yu(t,n,e={}){return null==e?.interval?e:t({[n]:void 0===e?.reduce?ji:e.reduce,filter:null},e)}function gu(t){return yu(du,"y",t)}function vu(t){return yu(pu,"x",t)}function xu(t,n,e,r,{data:o=Ii,filter:i=Di,sort:a,reverse:l,...s}={},c={}){t=ku(t),n=ku(n),s=function(t,n){return Li(t,n,Mu)}(s,c),o=Au(o,Vr),a=null==a?void 0:Mu("sort",a,c),i=null==i?void 0:Lu("filter",i,c),null!=e&&Mi(s,"x","x1","x2")&&(e=null),null!=r&&Mi(s,"y","y1","y2")&&(r=null);const[u,f]=Lo(t),[h,d]=Lo(t),[p,m]=Lo(n),[y,g]=Lo(n),[v,x]=null!=e?[e,"x"]:null!=r?[r,"y"]:[],[w,b]=Lo(v),{x:k,y:$,z:M,fill:L,stroke:A,x1:E,x2:z,y1:O,y2:N,domain:S,cumulative:R,thresholds:C,interval:T,...I}=c,[j,B]=Lo(M),[W]=io(L),[D]=io(A),[F,q]=Lo(W),[_,P]=Lo(D);return{..."z"in c&&{z:j||M},..."fill"in c&&{fill:F||L},..."stroke"in c&&{stroke:_||A},...ii(I,((e,r)=>{const c=Fr(e,v),u=Fr(e,M),h=Fr(e,W),p=Fr(e,D),y=Si(s,{z:u,fill:h,stroke:p}),x=[],w=[],k=c&&b([]),$=u&&B([]),L=h&&q([]),A=p&&P([]),E=t&&f([]),z=t&&d([]),O=n&&m([]),N=n&&g([]),S=(R=t?.(e),C=n?.(e),R&&C?function*(t){const n=R.bin(t);for(const[t,[e,r]]of R.entries()){const o=C.bin(n[t]);for(const[t,[n,i]]of C.entries())yield[o[t],{x1:e,y1:n,x2:r,y2:i}]}}:R?function*(t){const n=R.bin(t);for(const[t,[e,r]]of R.entries())yield[n[t],{x1:e,x2:r}]}:function*(t){const n=C.bin(t);for(const[t,[e,r]]of C.entries())yield[n[t],{y1:e,y2:r}]});var R,C;let T=0;for(const t of s)t.initialize(e);a&&a.initialize(e),i&&i.initialize(e);for(const t of r){const n=[];for(const n of s)n.scope("facet",t);a&&a.scope("facet",t),i&&i.scope("facet",t);for(const[r,l]of zi(t,y))for(const[t,f]of zi(l,c))for(const[l,d]of S(f))if(!i||i.reduce(l,d)){n.push(T++),w.push(o.reduceIndex(l,e,d)),c&&k.push(t),u&&$.push(y===u?r:u[l[0]]),h&&L.push(y===h?r:h[l[0]]),p&&A.push(y===p?r:p[l[0]]),E&&(E.push(d.x1),z.push(d.x2)),O&&(O.push(d.y1),N.push(d.y2));for(const t of s)t.reduce(l,d);a&&a.reduce(l)}x.push(n)}return Ri(x,a,l),{data:w,facets:x}})),...!Mi(s,"x")&&(u?{x1:u,x2:h,x:Eo(u,h)}:{x:k,x1:E,x2:z}),...!Mi(s,"y")&&(p?{y1:p,y2:y,y:Eo(p,y)}:{y:$,y1:O,y2:N}),...w&&{[x]:w},...Object.fromEntries(s.map((({name:t,output:n})=>[t,n])))}}function wu({cumulative:t,domain:n,thresholds:e,interval:r,...o},i){return[o,{cumulative:t,domain:n,thresholds:e,interval:r,...i}]}function bu(t,{cumulative:n,domain:e,thresholds:r,interval:o},i){return void 0===(t={...No(t)}).domain&&(t.domain=e),void 0===t.cumulative&&(t.cumulative=n),void 0===t.thresholds&&(t.thresholds=r),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=i),t.thresholds=$u(t.thresholds,t.interval),t}function ku(t){if(null==t)return;const{value:n,cumulative:e,domain:r=ne,thresholds:o}=t,i=t=>{let i,a=Fr(t,n);if(To(a)||(function(t){return Ou(t)&&"function"==typeof t&&t()instanceof Date}(l=o)||So(l)&&To(l))){a=uo(a,oo,Float64Array);let[t,n]="function"==typeof r?r(a):r,e="function"!=typeof o||Ou(o)?o:o(a,t,n);"number"==typeof e&&(e=er(t,n,e)),Ou(e)&&(r===ne&&(t=e.floor(t),n=e.offset(e.floor(n))),e=e.range(t,e.offset(n))),i=e}else{a=no(a);let[t,n]="function"==typeof r?r(a):r,e="function"!=typeof o||Ou(o)?o:o(a,t,n);if("number"==typeof e)if(r===ne){let r=rr(t,n,e);if(isFinite(r))if(r>0){let o=Math.round(t/r),i=Math.round(n/r);o*r<=t||--o,i*r>n||++i;let a=i-o+1;e=new Float64Array(a);for(let t=0;t<a;++t)e[t]=(o+t)*r}else if(r<0){r=-r;let o=Math.round(t*r),i=Math.round(n*r);o/r<=t||--o,i/r>n||++i;let a=i-o+1;e=new Float64Array(a);for(let t=0;t<a;++t)e[t]=(o+t)/r}else e=[t];else e=[t]}else e=ee(t,n,e);else Ou(e)&&(r===ne&&(t=e.floor(t),n=e.offset(e.floor(n))),e=e.range(t,e.offset(n)));i=e}var l;const s=[];if(1===i.length)s.push([i[0],i[0]]);else for(let t=1;t<i.length;++t)s.push([i[t-1],i[t]]);return s.bin=(e<0?Ru:e>0?Su:Nu)(s,i,a),s};return i.label=Ao(n),i}function $u(t,n,e=zu){if(void 0===t)return void 0===n?e:Oo(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return nr;case"scott":return tr;case"sturges":return Xe;case"auto":return zu}return Br(t)}return t}function Mu(t,n,e){return Ai(t,n,e,Lu)}function Lu(t,n,e){return Ei(t,n,e,Au)}function Au(t,n){return Oi(t,n,Eu)}function Eu(t){switch(`${t}`.toLowerCase()){case"x":return Tu;case"x1":return ju;case"x2":return Bu;case"y":return Iu;case"y1":return Wu;case"y2":return Du}throw new Error(`invalid bin reduce: ${t}`)}function zu(t,n,e){return Math.min(200,tr(t,n,e))}function Ou(t){return"function"==typeof t?.range}function Nu(t,n,e){return n=no(n),r=>{const o=t.map((()=>[]));for(const t of r)o[or(n,e[t])-1]?.push(t);return o}}function Su(t,n,e){const r=Nu(t,n,e);return t=>{const n=r(t);for(let t=1,e=n.length;t<e;++t){const e=n[t-1],r=n[t];for(const t of e)r.push(t)}return n}}function Ru(t,n,e){const r=Nu(t,n,e);return t=>{const n=r(t);for(let t=n.length-2;t>=0;--t){const e=n[t+1],r=n[t];for(const t of e)r.push(t)}return n}}function Cu(t,n){const e=(+t+ +n)/2;return t instanceof Date?new Date(e):e}const Tu={reduceIndex:(t,n,{x1:e,x2:r})=>Cu(e,r)},Iu={reduceIndex:(t,n,{y1:e,y2:r})=>Cu(e,r)},ju={reduceIndex:(t,n,{x1:e})=>e},Bu={reduceIndex:(t,n,{x2:e})=>e},Wu={reduceIndex:(t,n,{y1:e})=>e},Du={reduceIndex:(t,n,{y2:e})=>e};function Fu(t={}){const{x:n,x1:e,x2:r}=t;return void 0===e&&void 0===r&&void 0===n?{...t,x:Vr}:t}function qu(t={}){const{y:n,y1:e,y2:r}=t;return void 0===e&&void 0===r&&void 0===n?{...t,y:Vr}:t}function _u(t={},n={}){1===arguments.length&&([t,n]=Ju(t));const{y1:e,y:r=e,x:o,...i}=n,[a,l,s,c]=Ku(r,o,"x",t,i);return{...a,y1:e,y:l,x1:s,x2:c,x:Eo(s,c)}}function Pu(t={},n={}){1===arguments.length&&([t,n]=Ju(t));const{y1:e,y:r=e,x:o}=n,[i,a,l]=Ku(r,o,"x",t,n);return{...i,y1:e,y:a,x:l}}function Uu(t={},n={}){1===arguments.length&&([t,n]=Ju(t));const{y1:e,y:r=e,x:o}=n,[i,a,,l]=Ku(r,o,"x",t,n);return{...i,y1:e,y:a,x:l}}function Vu(t={},n={}){1===arguments.length&&([t,n]=Ju(t));const{x1:e,x:r=e,y:o,...i}=n,[a,l,s,c]=Ku(r,o,"y",t,i);return{...a,x1:e,x:l,y1:s,y2:c,y:Eo(s,c)}}function Hu(t={},n={}){1===arguments.length&&([t,n]=Ju(t));const{x1:e,x:r=e,y:o}=n,[i,a,l]=Ku(r,o,"y",t,n);return{...i,x1:e,x:a,y:l}}function Yu(t={},n={}){1===arguments.length&&([t,n]=Ju(t));const{x1:e,x:r=e,y:o}=n,[i,a,,l]=Ku(r,o,"y",t,n);return{...i,x1:e,x:a,y:l}}function Zu({x:t,x1:n,x2:e,...r}={}){return void 0===n&&void 0===e?_u({x:t,...r}):([n,e]=go(t,n,e),{...r,x1:n,x2:e})}function Gu({y:t,y1:n,y2:e,...r}={}){return void 0===n&&void 0===e?Vu({y:t,...r}):([n,e]=go(t,n,e),{...r,y1:n,y2:e})}function Ju(t){const{offset:n,order:e,reverse:r,...o}=t;return[{offset:n,order:e,reverse:r},o]}const Ku=function(t,n=Hr,e,{offset:r,order:o,reverse:i},a){const l=xo(a),[s,c]=Lo(t),[u,f]=Mo(n),[h,d]=Mo(n);return r=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return Xu;case"center":case"silhouette":return tf;case"wiggle":return nf}throw new Error(`unknown offset: ${t}`)}(r),o=function(t,n,e){if(void 0===t&&n===nf)return cf;if(null==t)return;if("string"==typeof t){switch(t.toLowerCase()){case"value":case e:return of;case"z":return af;case"sum":return lf;case"appearance":return sf;case"inside-out":return cf}return uf(Pr(t))}if("function"==typeof t)return uf(t);if(Array.isArray(t))return r=t,(t,n,e,o)=>ff(o,r);var r;throw new Error(`invalid order: ${t}`)}(o,r,e),[ii(a,((e,a)=>{const s=null==t?void 0:c(Fr(e,t)),u=Fr(e,n,Float64Array),h=Fr(e,l),p=o&&o(e,s,u,h),m=e.length,y=f(new Float64Array(m)),g=d(new Float64Array(m)),v=[];for(const t of a){const n=s?Array.from(Z(t,(t=>s[t])).values()):[t];p&&hf(n,p);for(const t of n){let n=0,e=0;i&&t.reverse();for(const r of t){const t=u[r];t<0?n=g[r]=(y[r]=n)+t:t>0?e=g[r]=(y[r]=e)+t:g[r]=y[r]=e}}v.push(n)}return r&&r(v,y,g,h),{data:e,facets:a}})),s,u,h]};function Qu(t,n){let e=0,r=0;for(const o of t){const t=n[o];t<e&&(e=t),t>r&&(r=t)}return[e,r]}function Xu(t,n,e){for(const r of t)for(const t of r){const[r,o]=Qu(t,e);for(const i of t){const t=1/(o-r||1);n[i]=t*(n[i]-r),e[i]=t*(e[i]-r)}}}function tf(t,n,e){for(const r of t){for(const t of r){const[r,o]=Qu(t,e);for(const i of t){const t=(o+r)/2;n[i]-=t,e[i]-=t}}ef(r,n,e)}rf(t,n,e)}function nf(t,n,e,r){for(const o of t){const t=new Ee;let i=0;for(const a of o){let o=-1;const l=a.map((t=>Math.abs(e[t]-n[t]))),s=a.map((i=>{o=r?r[i]:++o;const a=e[i]-n[i],l=t.has(o)?a-t.get(o):0;return t.set(o,a),l})),c=[0,...ir(s)];for(const t of a)n[t]+=i,e[t]+=i;const u=J(l);u&&(i-=J(l,((t,n)=>(s[n]/2+c[n])*t))/u)}ef(o,n,e)}rf(t,n,e)}function ef(t,n,e){const r=at(t,(t=>at(t,(t=>n[t]))));for(const o of t)for(const t of o)n[t]-=r,e[t]-=r}function rf(t,n,e){const r=t.length;if(1===r)return;const o=t.map((t=>t.flat())),i=o.map((t=>(at(t,(t=>n[t]))+rt(t,(t=>e[t])))/2)),a=at(i);for(let t=0;t<r;t++){const r=a-i[t];for(const i of o[t])n[i]+=r,e[i]+=r}}function of(t,n,e){return e}function af(t,n,e,r){return r}function lf(t,n,e,r){return ff(r,ar(wo(t),(t=>J(t,(t=>e[t]))),(t=>r[t])))}function sf(t,n,e,r){return ff(r,ar(wo(t),(t=>n[lr(t,(t=>e[t]))]),(t=>r[t])))}function cf(t,n,e,r){const o=wo(t),i=ar(o,(t=>n[lr(t,(t=>e[t]))]),(t=>r[t])),a=G(o,(t=>J(t,(t=>e[t]))),(t=>r[t])),l=[],s=[];let c=0;for(const t of i)c<0?(c+=a.get(t),l.push(t)):(c-=a.get(t),s.push(t));return ff(r,s.reverse().concat(l))}function uf(t){return n=>Fr(n,t)}function ff(t,n){if(!t)throw new Error("missing channel: z");return n=new Ee(n.map(((t,n)=>[t,n]))),t.map((t=>n.get(t)))}function hf(t,n){for(const e of t)e.sort(((t,e)=>zr(n[t],n[e])))}const df={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class pf extends ys{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,z:a,curve:l,tension:s}=n;super(t,{x1:{value:e,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0},z:{value:xo(n),optional:!0}},n,df),this.z=a,this.curve=uu(l,s)}filter(t){return t}render(t,n,e,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a}=e;return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,n,0,0).call((n=>n.selectAll().data(Dl(t,[i,a,l,s],this,e)).enter().append("path").call(ql,this).call(Bl,this,e).attr("d",sr().curve(this.curve).defined((t=>t>=0)).x0((t=>i[t])).y0((t=>a[t])).x1((t=>l[t])).y1((t=>s[t]))))).node()}}function mf(t,n){return void 0===n?gf(t,{x:Jr,y:Kr}):new pf(t,n)}function yf(t,n){const{y:e=Ur,...r}=vu(n);return new pf(t,Zu(Fu({...r,y1:e,y2:void 0})))}function gf(t,n){const{x:e=Ur,...r}=gu(n);return new pf(t,Gu(qu({...r,x1:e,x2:void 0})))}function vf(t,{marker:n,markerStart:e=n,markerMid:r=n,markerEnd:o=n}={}){t.markerStart=xf(e),t.markerMid=xf(r),t.markerEnd=xf(o)}function xf(t){if(null==t||!1===t)return null;if(!0===t)return kf;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return wf;case"dot":return bf;case"circle":case"circle-fill":return kf;case"circle-stroke":return $f}throw new Error(`invalid marker: ${t}`)}function wf(t,n){return da("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient","auto").attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function bf(t,n){return da("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function kf(t,n){return da("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function $f(t,n){return da("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let Mf=0;function Lf(t,n,{stroke:e},r){return Ef(t,n,e&&(t=>e[t]),r)}function Af(t,n,{stroke:e},r){return Ef(t,n,e&&(([t])=>e[t]),r)}function Ef(t,{markerStart:n,markerMid:e,markerEnd:r,stroke:o},i=(()=>o),a){const l=new Map;function s(t){return function(n){const e=i(n);let r=l.get(t);r||l.set(t,r=new Map);let o=r.get(e);if(!o){const n=this.parentNode.insertBefore(t(e,a),this),i="plot-marker-"+ ++Mf;n.setAttribute("id",i),r.set(e,o=`url(#${i})`)}return o}}n&&t.attr("marker-start",s(n)),e&&t.attr("marker-mid",s(e)),r&&t.attr("marker-end",s(r))}const zf={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Of extends ys{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,curve:a,tension:l}=n;super(t,{x1:{value:e,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},n,zf),this.curve=fu(a,l),vf(this,n)}project(t,n,e){this.curve!==hu&&super.project(t,n,e)}render(t,n,e,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a}=e,{curve:c}=this;return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(ql,this).attr("d",c===hu&&o.projection?function(t,n,e,r,o){const i=ct(t);return n=no(n),e=no(e),r=no(r),o=no(o),t=>i({type:"LineString",coordinates:[[n[t],e[t]],[r[t],o[t]]]})}(o.projection,i,a,l,s):t=>{const n=Se(),e=c(n);return e.lineStart(),e.point(i[t],a[t]),e.point(l[t],s[t]),e.lineEnd(),n}).call(jl,this,e).call(Lf,this,e,o))).node()}}function Nf(t,n={}){let{x:e,x1:r,x2:o,y:i,y1:a,y2:l,...s}=n;return[r,o]=Sf(e,r,o),[a,l]=Sf(i,a,l),new Of(t,{...s,x1:r,x2:o,y1:a,y2:l})}function Sf(t,n,e){if(void 0===t){if(void 0===n){if(void 0!==e)return[e]}else if(void 0===e)return[n]}else{if(void 0===n)return void 0===e?[t]:[t,e];if(void 0===e)return[t,n]}return[n,e]}const Rf={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class Cf extends ys{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,bend:a=0,headAngle:l=60,headLength:s=8,inset:c=0,insetStart:u=c,insetEnd:f=c}=n;super(t,{x1:{value:e,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},n,Rf),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+l,this.headLength=+s,this.insetStart=+u,this.insetEnd=+f}render(t,n,e,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a,SW:c}=e,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,y=c?t=>c[t]:Xr(void 0===u?1:u),g=f*vs,v=h*vs/2,x=d/1.5;return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(ql,this).attr("d",(t=>{let n=i[t],e=a[t],r=l[t],o=s[t];const c=Math.hypot(r-n,o-e);if(c<=p+m)return null;let u=Math.atan2(o-e,r-n);const f=Math.min(x*y(t),c/3),h=Math.hypot(c/Math.tan(g),c)/2;if(p||m)if(h<1e5){const t=Math.sign(g),[i,a]=function([t,n],[e,r],o,i){const a=e-t,l=r-n,s=Math.hypot(a,l),c=i*Math.sqrt(o*o-s*s/4)/s;return[(t+e)/2-l*c,(n+r)/2+a*c]}([n,e],[r,o],h,t);if(p&&([n,e]=Tf([i,a,h],[n,e,p],-t*Math.sign(p))),m){const[n,e]=Tf([i,a,h],[r,o,m],t*Math.sign(m));u+=Math.atan2(e-a,n-i)-Math.atan2(o-a,r-i),r=n,o=e}}else{const t=r-n,i=o-e,a=Math.hypot(t,i);p&&(n+=t/a*p,e+=i/a*p),m&&(r-=t/a*m,o-=i/a*m)}const d=u+g,w=d+v,b=d-v,k=r-f*Math.cos(w),$=o-f*Math.sin(w),M=r-f*Math.cos(b),L=o-f*Math.sin(b);return`M${n},${e}${h<1e5?`A${h},${h} 0,0,${g>0?1:0} `:"L"}${r},${o}M${k},${$}L${r},${o}L${M},${L}`})).call(jl,this,e))).node()}}function Tf([t,n,e],[r,o,i],a){const l=r-t,s=o-n,c=Math.hypot(l,s),u=(l*l+s*s-i*i+e*e)/(2*c),f=a*Math.sqrt(e*e-u*u);return[t+(l*u+s*f)/c,n+(s*u-l*f)/c]}function If(t,n={}){let{x:e,x1:r,x2:o,y:i,y1:a,y2:l,...s}=n;return[r,o]=Sf(e,r,o),[a,l]=Sf(i,a,l),new Cf(t,{...s,x1:r,x2:o,y1:a,y2:l})}class jf extends ys{constructor(t,n,e={},r){super(t,n,e,r);const{inset:o=0,insetTop:i=o,insetRight:a=o,insetBottom:l=o,insetLeft:s=o,rx:c,ry:u}=e;this.insetTop=Gr(i),this.insetRight=Gr(a),this.insetBottom=Gr(l),this.insetLeft=Gr(s),this.rx=Vl(c,"auto"),this.ry=Vl(u,"auto")}render(t,n,e,r,o){const{rx:i,ry:a}=this;return da("svg:g",o).call(Fl,this,r,o).call(this._transform,this,n).call((o=>o.selectAll().data(t).enter().append("rect").call(ql,this).attr("x",this._x(n,e,r)).attr("width",this._width(n,e,r)).attr("y",this._y(n,e,r)).attr("height",this._height(n,e,r)).call(Pl,"rx",i).call(Pl,"ry",a).call(jl,this,e))).node()}_x(t,{x:n},{marginLeft:e}){const{insetLeft:r}=this;return n?t=>n[t]+r:e+r}_y(t,{y:n},{marginTop:e}){const{insetTop:r}=this;return n?t=>n[t]+r:e+r}_width({x:t},{x:n},{marginRight:e,marginLeft:r,width:o}){const{insetLeft:i,insetRight:a}=this,l=n&&t?t.bandwidth():o-e-r;return Math.max(0,l-i-a)}_height({y:t},{y:n},{marginTop:e,marginBottom:r,height:o}){const{insetTop:i,insetBottom:a}=this,l=n&&t?t.bandwidth():o-e-r;return Math.max(0,l-i-a)}}const Bf={ariaLabel:"bar"};class Wf extends jf{constructor(t,n={}){const{x1:e,x2:r,y:o}=n;super(t,{x1:{value:e,scale:"x"},x2:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},n,Bf)}_transform(t,n,{x:e}){t.call(Ul,n,{x:e},0,0)}_x({x:t},{x1:n,x2:e},{marginLeft:r}){const{insetLeft:o}=this;return gl(t)?r+o:t=>Math.min(n[t],e[t])+o}_width({x:t},{x1:n,x2:e},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:l}=this;return gl(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(e[t]-n[t])-a-l)}}class Df extends jf{constructor(t,n={}){const{x:e,y1:r,y2:o}=n;super(t,{y1:{value:r,scale:"y"},y2:{value:o,scale:"y"},x:{value:e,scale:"x",type:"band",optional:!0}},n,Bf)}_transform(t,n,{y:e}){t.call(Ul,n,{y:e},0,0)}_y({y:t},{y1:n,y2:e},{marginTop:r}){const{insetTop:o}=this;return gl(t)?r+o:t=>Math.min(n[t],e[t])+o}_height({y:t},{y1:n,y2:e},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:l}=this;return gl(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(e[t]-n[t])-a-l)}}function Ff(t,n={y:Ur,x2:Vr}){return new Wf(t,Zu(Es(Fu(n))))}function qf(t,n={x:Ur,y2:Vr}){return new Df(t,Gu(zs(qu(n))))}const _f={ariaLabel:"cell"};class Pf extends jf{constructor(t,{x:n,y:e,...r}={}){super(t,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:e,scale:"y",type:"band",optional:!0}},r,_f)}_transform(t,n){t.call(Ul,n,{},0,0)}}function Uf(t,n={}){let{x:e,y:r,...o}=n;return[e,r]=vo(e,r),new Pf(t,{...o,x:e,y:r})}function Vf(t,n={}){let{x:e=Ur,fill:r,stroke:o,...i}=n;return void 0===r&&void 0===io(o)[0]&&(r=Vr),new Pf(t,{...i,x:e,fill:r,stroke:o})}function Hf(t,n={}){let{y:e=Ur,fill:r,stroke:o,...i}=n;return void 0===r&&void 0===io(o)[0]&&(r=Vr),new Pf(t,{...i,y:e,fill:r,stroke:o})}const Yf={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Zf(t){return void 0===t.sort&&void 0===t.reverse?mi({channel:"r",order:"descending"},t):t}class Gf extends ys{constructor(t,n={}){const{x:e,y:r,r:o,rotate:i,symbol:a=T,frameAnchor:l}=n,[s,c]=ao(i,0),[u,f]=function(t){if(null==t||ei(t))return[void 0,t];if("string"==typeof t){const n=ni.get(`${t}`.toLowerCase());if(n)return[void 0,n]}return[t,void 0]}(a),[h,d]=ao(o,null==u?3:4.5);super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:h,scale:"r",filter:Rr,optional:!0},rotate:{value:s,optional:!0},symbol:{value:u,scale:"auto",optional:!0}},Zf(n),Yf),this.r=d,this.rotate=c,this.symbol=f,this.frameAnchor=Po(l);const{channels:p}=this,{symbol:m}=p;if(m){const{fill:t,stroke:n}=p;m.hint={fill:t?t.value===m.value?"color":"currentColor":this.fill,stroke:n?n.value===m.value?"color":"currentColor":this.stroke}}}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,r:c,rotate:u,symbol:f}=e,{r:h,rotate:d,symbol:p}=this,[m,y]=Jl(this,r),g=this.symbol===T,v=c?void 0:h*h*Math.PI;return Cr(h)&&(t=[]),da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append(g?"circle":"path").call(ql,this).call(g?t=>{t.attr("cx",l?t=>l[t]:m).attr("cy",s?t=>s[t]:y).attr("r",c?t=>c[t]:h)}:t=>{t.attr("transform",Bs`translate(${l?t=>l[t]:m},${s?t=>s[t]:y})${u?t=>` rotate(${u[t]})`:d?` rotate(${d})`:""}`).attr("d",c&&f?t=>{const n=Se();return f[t].draw(n,c[t]*c[t]*Math.PI),n}:c?t=>{const n=Se();return p.draw(n,c[t]*c[t]*Math.PI),n}:f?t=>{const n=Se();return f[t].draw(n,v),n}:(()=>{const t=Se();return p.draw(t,v),t})())}).call(jl,this,e))).node()}}function Jf(t,n={}){let{x:e,y:r,...o}=n;return void 0===n.frameAnchor&&([e,r]=vo(e,r)),new Gf(t,{...o,x:e,y:r})}function Kf(t,n={}){const{x:e=Vr,...r}=n;return new Gf(t,Ns({...r,x:e}))}function Qf(t,n={}){const{y:e=Vr,...r}=n;return new Gf(t,Os({...r,y:e}))}function Xf(t,n){return Jf(t,{...n,symbol:"circle"})}function th(t,n){return Jf(t,{...n,symbol:"hexagon"})}const nh={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class eh extends ys{constructor(t,n={}){const{x:e,y:r,z:o,curve:i,tension:a}=n;super(t,{x:{value:e,scale:"x"},y:{value:r,scale:"y"},z:{value:xo(n),optional:!0}},n,nh),this.z=o,this.curve=fu(i,a),vf(this,n)}filter(t){return t}project(t,n,e){this.curve!==hu&&super.project(t,n,e)}render(t,n,e,r,o){const{x:i,y:a}=e,{curve:l}=this;return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,n).call((n=>n.selectAll().data(Dl(t,[i,a],this,e)).enter().append("path").call(ql,this).call(Bl,this,e).call(Af,this,e,o).attr("d",l===hu&&o.projection?function(t,n,e){const r=ct(t);return n=no(n),e=no(e),t=>{let o=[];const i=[o];for(const r of t)-1===r?(o=[],i.push(o)):o.push([n[r],e[r]]);return r({type:"MultiLineString",coordinates:i})}}(o.projection,i,a):cr().curve(l).defined((t=>t>=0)).x((t=>i[t])).y((t=>a[t]))))).node()}}function rh(t,n={}){let{x:e,y:r,...o}=n;return[e,r]=vo(e,r),new eh(t,{...o,x:e,y:r})}function oh(t,n={}){const{x:e=Vr,y:r=Ur,...o}=n;return new eh(t,vu({...o,x:e,y:r}))}function ih(t,n={}){const{x:e=Ur,y:r=Vr,...o}=n;return new eh(t,gu({...o,x:e,y:r}))}const ah={ariaLabel:"rect"};class lh extends ys{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,inset:a=0,insetTop:l=a,insetRight:s=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=n;super(t,{x1:{value:e,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},n,ah),this.insetTop=Gr(l),this.insetRight=Gr(s),this.insetBottom=Gr(c),this.insetLeft=Gr(u),this.rx=Vl(f,"auto"),this.ry=Vl(h,"auto")}render(t,n,e,r,o){const{x:i,y:a}=n,{x1:l,y1:s,x2:c,y2:u}=e,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:y}=r,{projection:g}=o,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this;return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{x:l&&c&&i,y:s&&u&&a},0,0).call((n=>n.selectAll().data(t).enter().append("rect").call(ql,this).attr("x",l&&c&&(g||!gl(i))?t=>Math.min(l[t],c[t])+b:p+b).attr("y",s&&u&&(g||!gl(a))?t=>Math.min(s[t],u[t])+v:f+v).attr("width",l&&c&&(g||!gl(i))?t=>Math.max(0,Math.abs(c[t]-l[t])-b-x):m-h-p-x-b).attr("height",s&&u&&(g||!gl(a))?t=>Math.max(0,Math.abs(s[t]-u[t])-v-w):y-f-d-v-w).call(Pl,"rx",k).call(Pl,"ry",$).call(jl,this,e))).node()}}function sh(t,n){return new lh(t,Ls(As(n)))}function ch(t,n={y:Ur,interval:1,x2:Vr}){return new lh(t,Zu(As(Fu(n))))}function uh(t,n={x:Ur,interval:1,y2:Vr}){return new lh(t,Gu(Ls(qu(n))))}function fh(t,n){const{x:e,y:r,fx:o,fy:i,color:a,size:l,mark:s}=hh(t,n);return{x:e,y:r,fx:o,fy:i,color:a,size:l,mark:s}}function hh(t,n){n=function({x:t,y:n,color:e,size:r,fx:o,fy:i,mark:a}={}){mo(t)||(t=yh(t));mo(n)||(n=yh(n));mo(e)||(e=Do(e)?{color:e}:yh(e));mo(r)||(r=yh(r));mo(o)&&({value:o}=yh(o));mo(i)&&({value:i}=yh(i));null!=a&&(a=`${a}`.toLowerCase());return{x:t,y:n,color:e,size:r,fx:o,fy:i,mark:a}}(n);const{x:e,y:r,color:o,size:i}=n,a=mh(t,e),l=mh(t,r),s=mh(t,o),c=mh(t,i);let u,f,h,{fx:d,fy:p,x:{value:m,reduce:y,zero:g,...v},y:{value:x,reduce:w,zero:b,...k},color:{value:$,color:M,reduce:L},size:{value:A,reduce:E},mark:z}=n;if(void 0===y&&(y=null==w&&null==m&&null==A&&null!=x?"count":null),void 0===w&&(w=null==y&&null==x&&null==A&&null!=m?"count":null),void 0!==E||null!=A||null!=L||null!=y||null!=w||null!=m&&!Co(a)||null!=x&&!Co(l)||(E="count"),void 0===g&&(g=!!gh(y)||void 0),void 0===b&&(b=!!gh(w)||void 0),null==m&&null==x)throw new Error("must specify x or y");if(null!=y&&null==x)throw new Error("reducing x requires y");if(null!=w&&null==m)throw new Error("reducing y requires x");switch(void 0===z&&(z=null!=A||null!=E?"dot":gh(y)||gh(w)||null!=L?"bar":null!=m&&null!=x?Co(a)||Co(l)||null==y&&null==w&&!ph(a)&&!ph(l)?"dot":"line":null!=m||null!=x?"rule":null),z){case"dot":h=Jf,f="stroke";break;case"line":h=a&&l?rh:a?oh:ih,f="stroke",xh(s)&&(u=null);break;case"area":h=b?gf:g||l&&ph(l)?yf:gf,f="fill",xh(s)&&(u=null);break;case"rule":h=a?Ts:Is,f="stroke";break;case"bar":h=b?vh(y,a)?qf:uh:g?vh(w,l)?Ff:ch:vh(y,a)&&vh(w,l)?Uf:vh(y,a)?qf:vh(w,l)?Ff:uh,f="fill";break;default:throw new Error(`invalid mark: ${z}`)}let O,N={fx:d,fy:p,x:a??void 0,y:l??void 0,[f]:s??M,z:u,r:c??void 0},S={[f]:L??void 0,r:E??void 0};if(null!=y&&null!=w)throw new Error("cannot reduce both x and y");return null!=w?(S.y=w,O=Co(a)?wi:du):null!=y?(S.x=y,O=Co(l)?bi:pu):null==L&&null==E||(a&&l?O=Co(a)&&Co(l)?ki:Co(a)?pu:Co(l)?du:mu:a?O=Co(a)?wi:du:l&&(O=Co(l)?bi:pu)),O!==mu&&O!==du||(N.x={value:a,...v}),O!==mu&&O!==pu||(N.y={value:l,...k}),void 0===g&&(g=a&&!(O===mu||O===du)&&(h===Ff||h===yf||h===ch||h===Is)),void 0===b&&(b=l&&!(O===mu||O===pu)&&(h===qf||h===gf||h===uh||h===Ts)),{fx:d??null,fy:p??null,x:{value:m??null,reduce:y??null,zero:!!g,...v},y:{value:x??null,reduce:w??null,zero:!!b,...k},color:{value:$??null,reduce:L??null,...void 0!==M&&{color:M}},size:{value:A??null,reduce:E??null},mark:z,markImpl:h,markOptions:N,transformImpl:O,transformOptions:S,colorMode:f}}function dh(t,n){const{fx:e,fy:r,x:{zero:o},y:{zero:i},markImpl:a,markOptions:l,transformImpl:s,transformOptions:c,colorMode:u}=hh(t,n),f=null!=e||null!=r?Yc({strokeOpacity:.1}):null,h=[o?Ts([0]):null,i?Is([0]):null],d=a(t,s?s(c,l):l);return"stroke"===u?gs(f,h,d):gs(f,d,h)}function ph(n){let e,r;for(const o of n){if(null==o)continue;if(void 0===e){e=o;continue}const n=Math.sign(t(e,o));if(n){if(void 0!==r&&n!==r)return!1;e=o,r=n}}return!0}function mh(t,n){const e=Fr(t,n.value);return e&&(e.label=Ao(n.value)),e}function yh(t){return function(t){if(null==t)return!1;if("function"==typeof t.reduceIndex)return!0;if("function"==typeof t.reduce&&ho(t))return!0;if(/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}(t)?{reduce:t}:{value:t}}function gh(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function vh(t,n){return!(null!=t&&!function(t){return/^(?:first|last|mode)$/i.test(t)}(t)||!n)&&Co(n)}function xh(t){return!!t&&new K(t).size>t.length>>1}function wh(t,n={}){return $h(Object.fromEntries(["x","x1","x2"].filter((t=>null!=n[t])).map((n=>[n,t]))),n)}function bh(t,n={}){return $h(Object.fromEntries(["y","y1","y2"].filter((t=>null!=n[t])).map((n=>[n,t]))),n)}function kh(t={},n={}){const e=xo(n),r=Object.entries(t).map((([t,e])=>{const r=$o(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[o,i]=Mo(r);return{key:t,input:r,output:o,setOutput:i,map:Mh(e)}}));return{...ii(n,((t,n)=>{const o=Fr(t,e),i=r.map((({input:n})=>Fr(t,n))),a=r.map((({setOutput:n})=>n(new Array(t.length))));for(const t of n)for(const n of o?Z(t,(t=>o[t])).values():[t])r.forEach((({map:t},e)=>t.mapIndex(n,i[e],a[e])));return{data:t,facets:n}})),...Object.fromEntries(r.map((({key:t,output:n})=>[t,n])))}}const $h=kh;function Mh(t){if(null==t)throw new Error("missing map");if("function"==typeof t.mapIndex)return t;if("function"==typeof t.map&&ho(t))return function(t){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:t.map.bind(t)}}(t);if("function"==typeof t)return Ah(t);switch(`${t}`.toLowerCase()){case"cumsum":return Eh;case"rank":return Ah(ur);case"quantile":return Ah(Lh)}throw new Error(`invalid map: ${t}`)}function Lh(t){const n=fr(t)-1;return ur(t).map((t=>t/n))}function Ah(t){return{mapIndex(n,e,r){const o=t(bo(e,n));if(o.length!==n.length)throw new Error("map function returned a mismatched length");for(let t=0,e=n.length;t<e;++t)r[n[t]]=o[t]}}}const Eh={mapIndex(t,n,e){let r=0;for(const o of t)e[o]=r+=n[o]}},zh={ariaLabel:"tick",fill:null,stroke:"currentColor"};class Oh extends ys{constructor(t,n,e){super(t,n,e,zh)}render(t,n,e,r,o){return da("svg:g",o).call(Fl,this,r,o).call(this._transform,this,n).call((o=>o.selectAll().data(t).enter().append("line").call(ql,this).attr("x1",this._x1(n,e,r)).attr("x2",this._x2(n,e,r)).attr("y1",this._y1(n,e,r)).attr("y2",this._y2(n,e,r)).call(jl,this,e))).node()}}class Nh extends Oh{constructor(t,n={}){const{x:e,y:r,inset:o=0,insetTop:i=o,insetBottom:a=o}=n;super(t,{x:{value:e,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},n),this.insetTop=Gr(i),this.insetBottom=Gr(a)}_transform(t,n,{x:e}){t.call(Ul,n,{x:e},Nl,0)}_x1(t,{x:n}){return t=>n[t]}_x2(t,{x:n}){return t=>n[t]}_y1({y:t},{y:n},{marginTop:e}){const{insetTop:r}=this;return n&&t?t=>n[t]+r:e+r}_y2({y:t},{y:n},{height:e,marginBottom:r}){const{insetBottom:o}=this;return n&&t?e=>n[e]+t.bandwidth()-o:e-r-o}}class Sh extends Oh{constructor(t,n={}){const{x:e,y:r,inset:o=0,insetRight:i=o,insetLeft:a=o}=n;super(t,{y:{value:r,scale:"y"},x:{value:e,scale:"x",type:"band",optional:!0}},n),this.insetRight=Gr(i),this.insetLeft=Gr(a)}_transform(t,n,{y:e}){t.call(Ul,n,{y:e},0,Nl)}_x1({x:t},{x:n},{marginLeft:e}){const{insetLeft:r}=this;return n&&t?t=>n[t]+r:e+r}_x2({x:t},{x:n},{width:e,marginRight:r}){const{insetRight:o}=this;return n&&t?e=>n[e]+t.bandwidth()-o:e-r-o}_y1(t,{y:n}){return t=>n[t]}_y2(t,{y:n}){return t=>n[t]}}function Rh(t,n={}){const{x:e=Vr,...r}=n;return new Nh(t,{...r,x:e})}function Ch(t,n={}){const{y:e=Vr,...r}=n;return new Sh(t,{...r,y:e})}function Th(t,n={}){const{x:e=Vr,y:r=null,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:c,...u}=n,f=null!=r?bi:xi;return gs(Is(t,f({x1:Bh,x2:Wh},{x:e,y:r,stroke:a,strokeOpacity:l,...u})),Ff(t,f({x1:"p25",x2:"p75"},{x:e,y:r,fill:o,fillOpacity:i,...u})),Rh(t,f({x:"p50"},{x:e,y:r,stroke:a,strokeOpacity:l,strokeWidth:s,sort:c,...u})),Jf(t,kh({x:jh},{x:e,y:r,z:r,stroke:a,strokeOpacity:l,...u})))}function Ih(t,n={}){const{y:e=Vr,x:r=null,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:c,...u}=n,f=null!=r?wi:xi;return gs(Ts(t,f({y1:Bh,y2:Wh},{x:r,y:e,stroke:a,strokeOpacity:l,...u})),qf(t,f({y1:"p25",y2:"p75"},{x:r,y:e,fill:o,fillOpacity:i,...u})),Ch(t,f({y:"p50"},{x:r,y:e,stroke:a,strokeOpacity:l,strokeWidth:s,sort:c,...u})),Jf(t,kh({y:jh},{x:r,y:e,z:r,stroke:a,strokeOpacity:l,...u})))}function jh(t){const n=Bh(t),e=Wh(t);return t.map((t=>t<n||t>e?t:NaN))}function Bh(t){const n=2.5*Dh(t)-1.5*Fh(t);return at(t,(t=>t>=n?t:NaN))}function Wh(t){const n=2.5*Fh(t)-1.5*Dh(t);return rt(t,(t=>t<=n?t:NaN))}function Dh(t){return R(t,.25)}function Fh(t){return R(t,.75)}const qh={ariaLabel:"raster",stroke:null,pixelSize:1};function _h(t,n){const e=+t;if(isNaN(e))throw new Error(`invalid ${n}: ${t}`);return e}function Ph(t,n){const e=Math.floor(t);if(isNaN(e))throw new Error(`invalid ${n}: ${t}`);return e}class Uh extends ys{constructor(t,n,e={},r){let{width:o,height:i,x:a,y:l,x1:s=(null==a?0:void 0),y1:c=(null==l?0:void 0),x2:u=(null==a?o:void 0),y2:f=(null==l?i:void 0),pixelSize:h=r.pixelSize,blur:d=0,interpolate:p}=e;if(null!=o&&(o=Ph(o,"width")),null!=i&&(i=Ph(i,"height")),null!=s&&(s=_h(s,"x1")),null!=c&&(c=_h(c,"y1")),null!=u&&(u=_h(u,"x2")),null!=f&&(f=_h(f,"y2")),null==a&&(null==s||null==u))throw new Error("missing x");if(null==l&&(null==c||null==f))throw new Error("missing y");null!=t&&null!=o&&null!=i&&(void 0===a&&null!=s&&null!=u&&(a=function(t,n,e){return{transform(r){const o=r.length,i=new Float64Array(o),a=(n-t)/e,l=t+a/2;for(let t=0;t<o;++t)i[t]=t%e*a+l;return i}}}(s,u,o)),void 0===l&&null!=c&&null!=f&&(l=function(t,n,e,r){return{transform(o){const i=o.length,a=new Float64Array(i),l=(n-t)/r,s=t+l/2;for(let t=0;t<i;++t)a[t]=Math.floor(t/e)%r*l+s;return a}}}(c,f,o,i))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:l,scale:"y",optional:!0},x1:{value:null==s?null:[s],scale:"x",optional:!0,filter:null},y1:{value:null==c?null:[c],scale:"y",optional:!0,filter:null},x2:{value:null==u?null:[u],scale:"x",optional:!0,filter:null},y2:{value:null==f?null:[f],scale:"y",optional:!0,filter:null},...n},e,r),this.width=o,this.height=i,this.pixelSize=_h(h,"pixelSize"),this.blur=_h(d,"blur"),this.interpolate=null==a||null==l?null:function(t){if("function"==typeof t)return t;if(null==t)return Kh;switch(`${t}`.toLowerCase()){case"none":return Kh;case"nearest":return Xh;case"barycentric":return Qh();case"random-walk":return td()}throw new Error(`invalid interpolate: ${t}`)}(p)}}class Vh extends Uh{constructor(t,n={}){const{imageRendering:e}=n;if(null==t){const{fill:t,fillOpacity:e}=n;void 0!==ao(e)[0]&&(n=Jh("fillOpacity",n)),void 0!==io(t)[0]&&(n=Jh("fill",n))}super(t,void 0,n,qh),this.imageRendering=Vl(e,"auto")}scale(t,{color:n,...e},r){return super.scale(t,e,r)}render(t,n,e,r,o){const i=n[e.channels.fill?.scale]??(t=>t),{x:a,y:l}=e,{document:s}=o,[c,u,f,h]=Zh(e,r,o),d=f-c,p=h-u,{pixelSize:m,width:y=Math.round(Math.abs(d)/m),height:g=Math.round(Math.abs(p)/m)}=this,v=y*g;let{fill:x,fillOpacity:w}=e,b=0;if(this.interpolate){const n=y/d,e=g/p,r=uo(a,(t=>(t-c)*n),Float64Array),o=uo(l,(t=>(t-u)*e),Float64Array);x&&(x=this.interpolate(t,y,g,r,o,x)),w&&(w=this.interpolate(t,y,g,r,o,w))}else null==this.data&&t&&(b=t.fi*v);const k=s.createElement("canvas");k.width=y,k.height=g;const $=k.getContext("2d"),M=$.createImageData(y,g),L=M.data;let{r:A,g:E,b:z}=Re(this.fill)??{r:0,g:0,b:0},O=255*(this.fillOpacity??1);for(let t=0;t<v;++t){const n=t<<2;if(x){const e=i(x[t+b]);if(null==e){L[n+3]=0;continue}({r:A,g:E,b:z}=Re(e))}w&&(O=255*w[t+b]),L[n+0]=A,L[n+1]=E,L[n+2]=z,L[n+3]=O}return this.blur>0&&hr(M,this.blur),$.putImageData(M,0,0),da("svg:g",o).call(Fl,this,r,o).call(Ul,this,n).call((t=>t.append("image").attr("transform",`translate(${c},${u}) scale(${Math.sign(f-c)},${Math.sign(h-u)})`).attr("width",Math.abs(d)).attr("height",Math.abs(p)).attr("preserveAspectRatio","none").call(Pl,"image-rendering",this.imageRendering).call(ql,this).attr("xlink:href",k.toDataURL()))).node()}}function Hh(t,n,e){arguments.length<3&&(e=n,n=null);let{x:r,y:o,[t]:i,...a}=e;return void 0===r&&void 0===o&&function(t){if(!So(t))return!1;for(const n of t)if(null!=n)return"object"==typeof n&&"0"in n&&"1"in n}(n)&&(r=Jr,o=Kr,void 0===i&&(i=Qr)),[n,{...a,x:r,y:o,[t]:i}]}function Yh(){const[t,n]=Hh("fill",...arguments);return new Vh(t,null==t||void 0!==n.fill||void 0!==n.fillOpacity?n:{...n,fill:Vr})}function Zh({x1:t,y1:n,x2:e,y2:r},o,{projection:i}){const{width:a,height:l,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&null==i?t[0]:f,n&&null==i?n[0]:s,e&&null==i?e[0]:a-c,r&&null==i?r[0]:l-u]}function Gh({x1:t,y1:n,x2:e,y2:r},o,i,a){const l={};return t&&(l.x1=t),n&&(l.y1=n),e&&(l.x2=e),r&&(l.y2=r),Zh(Vi(l,o),i,a)}function Jh(t,n={}){const{[t]:e}=n;if("function"!=typeof e)throw new Error(`invalid ${t}: not a function`);return ai({...n,[t]:void 0},(function(r,o,i,a,l,s){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=Gh(i,a,l,s),m=d-f,y=p-h,{pixelSize:g}=this,{width:v=Math.round(Math.abs(m)/g),height:x=Math.round(Math.abs(y)/g)}=n,w=new Array(v*x*(o?o.length:1)),b=m/v,k=y/x;let $=0;for(const t of o??[void 0])for(let n=.5;n<x;++n)for(let r=.5;r<v;++r,++$)w[$]=e(c.invert(f+r*b),u.invert(h+n*k),t);return{data:w,facets:o,channels:{[t]:{value:w,scale:"auto"}}}}))}function Kh(t,n,e,r,o,i){const a=new Array(n*e);for(const l of t)r[l]<0||r[l]>=n||o[l]<0||o[l]>=e||(a[Math.floor(o[l])*n+Math.floor(r[l])]=i[l]);return a}function Qh({random:t=H(42)}={}){return(n,e,r,o,i,a)=>{const l=n.length,s=e>>2,c=(r>>2)-1,u=l+2*s+2*c,f=new Float64Array(2*u);for(let t=0;t<l;++t)f[2*t]=o[n[t]],f[2*t+1]=i[n[t]];let h=l;const d=(t,n)=>(f[2*h]=t,f[2*h+1]=n,h++);for(let t=0;t<=s;++t)d(t/s*e,0),d(t/s*e,r);for(let t=0;t<c;++t)d(e,t/c*r),d(0,t/c*r);a=bo(a,n);const p=new dr(f.subarray(0,2*l));for(let t,n=l;n<u;++n)a[n]=a[t=p.find(f[2*n],f[2*n+1],t)];const{points:m,triangles:y}=new dr(f),g=new a.constructor(e*r),v=function(t,n){return Bo(t)||To(t)?nd:function(t){return(n,e,r,o,i,a,l,s)=>{const c=t(l,s);return c<e?n:c<e+o?r:i}}(n)}(a,t);for(let t=0;t<y.length;t+=3){const n=y[t],o=y[t+1],i=y[t+2],l=m[2*n],s=m[2*o],c=m[2*i],u=m[2*n+1],f=m[2*o+1],h=m[2*i+1],d=Math.min(l,s,c),p=Math.max(l,s,c),x=Math.min(u,f,h),w=Math.max(u,f,h),b=(f-h)*(l-c)+(u-h)*(c-s);if(!b)continue;const k=a[n],$=a[o],M=a[i];for(let t=Math.floor(d);t<p;++t)for(let n=Math.floor(x);n<w;++n){if(t<0||t>=e||n<0||n>=r)continue;const o=t+.5,i=n+.5,a=((f-h)*(o-c)+(i-h)*(c-s))/b;if(a<0)continue;const d=((h-u)*(o-c)+(i-h)*(l-c))/b;if(d<0)continue;const p=1-a-d;p<0||(g[t+e*n]=v(k,a,$,d,M,p,t,n))}}return g}}function Xh(t,n,e,r,o,i){const a=new i.constructor(n*e),l=dr.from(t,(t=>r[t]),(t=>o[t]));let s,c;for(let r=.5,o=0;r<e;++r){c=s;for(let e=.5;e<n;++e,++o)c=l.find(e,r,c),.5===e&&(s=c),a[o]=i[t[c]]}return a}function td({random:t=H(42),minDistance:n=.5,maxSteps:e=2}={}){return(r,o,i,a,l,s)=>{const c=new s.constructor(o*i),u=dr.from(r,(t=>a[t]),(t=>l[t]));let f,h,d;for(let p=.5,m=0;p<i;++p){h=f;for(let i=.5;i<o;++i,++m){let o,y=i,g=p;d=h=u.find(y,g,h),.5===i&&(f=h);let v=0;for(;(o=Math.hypot(a[r[d]]-y,l[r[d]]-g))>n&&v<e;){const n=2*t(i,p,v)*Math.PI;y+=Math.cos(n)*o,g+=Math.sin(n)*o,d=u.find(y,g,d),++v}c[m]=s[r[d]]}}return c}}function nd(t,n,e,r,o,i){return n*t+r*e+i*o}const ed={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class rd extends Uh{constructor(t,{smooth:n=!0,value:e,...r}={}){const o=Cl({},r,ed);if(void 0===e)for(const t in o)if(null!=o[t].value){if(void 0!==e)throw new Error("ambiguous contour value");e=r[t],r[t]="value"}if(null!=e){const t={transform:t=>t.map((t=>t.value)),label:Ao(e)};for(const n in o)"value"===r[n]&&(r[n]=t)}if(null==t){if(null==e)throw new Error("missing contour value");r=Jh("value",{value:e,...r}),e=null}else{let{interpolate:t}=r;void 0===e&&(e=Vr),void 0===t&&(r.interpolate="nearest")}super(t,{value:{value:e,optional:!0}},function({thresholds:t,interval:n,...e}){return t=$u(t,n,Xe),ai(e,(function(n,e,r,o,i,a){const[l,s,c,u]=Gh(r,o,i,a),f=c-l,h=u-s,{pixelSize:d,width:p=Math.round(Math.abs(f)/d),height:m=Math.round(Math.abs(h)/d)}=this,y=p/f,g=m/h,v=r.value.value,x=[];if(this.interpolate){const{x:t,y:n}=fa(r,o,a),i=uo(t,(t=>(t-l)*y),Float64Array),c=uo(n,(t=>(t-s)*g),Float64Array),u=[r.x,r.y,r.value],f=[i,c,v];for(const t of e){const n=this.filter(t,u,f);x.push(this.interpolate(n,p,m,i,c,v))}}else if(e){const t=p*m,n=e.length;for(let e=0;e<n;++e)x.push(v.slice(e*t,e*t+t))}else x.push(v);if(this.blur>0)for(const t of x)pr({data:t,width:p,height:m},this.blur);const w=function(t,n,e,r){if("function"==typeof t?.range)return t.range(t.floor(e),r);"function"==typeof t&&(t=t(n,e,r));if("number"!=typeof t)return co(t);const o=ee(...yr(e,r,t),t);for(;o[o.length-1]>=r;)o.pop();for(;o[1]<e;)o.shift();return o}(t,v,...function(t){return[at(t,(t=>at(t,id))),rt(t,(t=>rt(t,id)))]}(x));if(null===w)throw new Error(`unsupported thresholds: ${t}`);const{contour:b}=mr().size([p,m]).smooth(this.smooth),k=[],$=[];for(const t of x)$.push(N(k.length,k.push(...uo(w,(n=>b(t,n))))));for(const{coordinates:t}of k)for(const n of t)for(const t of n)for(const n of t)n[0]=n[0]/y+l,n[1]=n[1]/g+s;return{data:k,facets:$,channels:Ui(this.contourChannels,k)}}))}(r),ed);const i={geometry:{value:Vr}};for(const t in this.channels){const n=this.channels[t],{scale:e}=n;"x"!==e&&"y"!==e&&"value"!==t&&(i[t]=n,delete this.channels[t])}this.contourChannels=i,this.smooth=!!n}filter(t,{x:n,y:e,value:r,...o},i){return super.filter(t,o,i)}render(t,n,e,r,o){const{geometry:i}=e,a=ct();return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,n).call((n=>{n.selectAll().data(t).enter().append("path").call(ql,this).attr("d",(t=>a(i[t]))).call(jl,this,e)})).node()}}function od(){return new rd(...Hh("value",...arguments))}function id(t){return isFinite(t)?t:NaN}const ad={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},ld={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},sd={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},cd={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},ud={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class fd extends ys{constructor(t,n={}){const{x:e,y:r,z:o,curve:i,tension:a}=n;super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},n,ad),this.curve=uu(i,a),vf(this,n)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,z:c}=e,{curve:u}=this,[f,h]=Jl(this,r),d=l?t=>l[t]:Xr(f),p=s?t=>s[t]:Xr(h),m=this;function y(t){let n=-1;const r=[],i={};for(const t in e)i[t]=[];const a=[],l=[],s=[],c=[];function f(o,u){o=t[o],u=t[u],r.push(++n),a[n]=d(o),s[n]=p(o),l[n]=d(u),c[n]=p(u);for(const t in e)i[t].push(e[t][u])}const{halfedges:h,hull:y,triangles:g}=dr.from(t,d,p);for(let t=0;t<h.length;++t){const n=h[t];n>t&&f(g[t],g[n])}for(let t=0;t<y.length;++t)f(y[t],y[(t+1)%y.length]);Lt(this).selectAll().data(r).enter().append("path").call(ql,m).attr("d",(t=>{const n=Se(),e=u(n);return e.lineStart(),e.point(a[t],s[t]),e.point(l[t],c[t]),e.lineEnd(),n})).call(jl,m,i).call(Lf,m,i,o)}return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{x:l&&i,y:s&&a}).call(c?n=>n.selectAll().data(Z(t,(t=>c[t])).values()).enter().append("g").each(y):n=>n.datum(t).each(y)).node()}}class hd extends ys{constructor(t,n={},e,r=(({z:t})=>t)){const{x:o,y:i}=n;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:r(n),optional:!0}},n,e)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,z:c}=e,[u,f]=Jl(this,r),h=l?t=>l[t]:Xr(u),d=s?t=>s[t]:Xr(f),p=this;function m(t){const n=dr.from(t,h,d);Lt(this).append("path").datum(t[0]).call(ql,p).attr("d",p._render(n,r)).call(jl,p,e)}return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{x:l&&i,y:s&&a}).call(c?n=>n.selectAll().data(Z(t,(t=>c[t])).values()).enter().append("g").each(m):n=>n.datum(t).each(m)).node()}}class dd extends hd{constructor(t,n={}){super(t,n,ld),this.fill="none"}_render(t){return t.render()}}class pd extends hd{constructor(t,n={}){super(t,n,sd,xo)}_render(t){return t.renderHull()}}class md extends ys{constructor(t,n={}){const{x:e,y:r,z:o}=n;super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},n,cd)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,z:c}=e,[u,f]=Jl(this,r),h=l?t=>l[t]:Xr(u),d=s?t=>s[t]:Xr(f),p=this;function m(t){const n=gd(dr.from(t,h,d),r);Lt(this).selectAll().data(t).enter().append("path").call(ql,p).attr("d",((t,e)=>n.renderCell(e))).call(jl,p,e)}return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{x:l&&i,y:s&&a}).call(c?n=>n.selectAll().data(Z(t,(t=>c[t])).values()).enter().append("g").each(m):n=>n.datum(t).each(m)).node()}}class yd extends hd{constructor(t,n){super(t,n,ud),this.fill="none"}_render(t,n){return gd(t,n).render()}}function gd(t,n){const{width:e,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:l}=n;return t.voronoi([l,o,e-i,r-a])}function vd(t,n,{x:e,y:r,...o}={}){return[e,r]=vo(e,r),new t(n,{...o,x:e,y:r})}function xd(t,n){return vd(fd,t,n)}function wd(t,n){return vd(dd,t,n)}function bd(t,n){return vd(pd,t,n)}function kd(t,n){return vd(md,t,n)}function $d(t,n){return vd(yd,t,n)}const Md={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Ld extends ys{constructor(t,{x:n,y:e,z:r,weight:o,fill:i,stroke:a,...l}={}){const s=zd(i)&&(i="currentColor",!0),c=zd(a)&&(a="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:e,scale:"y",optional:!0},z:{value:xo({z:r,fill:i,stroke:a}),optional:!0},weight:{value:o,optional:!0}},function(t,n,e){const r=100;let{bandwidth:o,thresholds:i}=t;return o=void 0===o?20:+o,i=void 0===i?20:"function"==typeof i?.[Symbol.iterator]?no(i):+i,ai(t,(function(t,a,l,s,c,u){const f=l.weight?no(l.weight.value):null,h=l.z?.value,{z:d}=this,[p,m]=Jl(this,c),{width:y,height:g}=c,{x:v,y:x}=fa(l,s,u),w=Object.fromEntries(Object.entries(l).filter((([t])=>!Ed.has(t))).map((([t,n])=>[t,{...n,value:[]}]))),b=n&&[],k=e&&[],$=gr().x(v?t=>v[t]:p).y(x?t=>x[t]:m).weight(f?t=>f[t]:1).size([y,g]).bandwidth(o),M=[];for(const t of a){const n=[];M.push(n);for(const e of h?Wl(t,h,d):[t]){const t=$.contours(e);n.push([e,t])}}let L=i;if(!(L instanceof Wr)){let t=0;for(const n of M)for(const[,e]of n){const n=e.max;n>t&&(t=n)}L=Float64Array.from({length:i-1},((n,e)=>t*r*(e+1)/i))}const A=[],E=[];for(const t of M){const n=[];A.push(n);for(const[e,o]of t)for(const t of L){n.push(E.length),E.push(o(t/r)),b&&b.push(t),k&&k.push(t);for(const t in w)w[t].value.push(l[t].value[e[0]])}}return b&&b.push(0),k&&k.push(0),{data:t,facets:A,channels:{...w,...b&&{fill:{value:b,scale:"color"}},...k&&{stroke:{value:k,scale:"color"}},contours:{value:E}}}}))}({...l,fill:i,stroke:a},s,c),Md),s&&(this.fill=void 0),c&&(this.stroke=void 0),this.z=r}filter(t){return t}render(t,n,e,r,o){const{contours:i}=e,a=ct();return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{}).call((n=>n.selectAll().data(t).enter().append("path").call(ql,this).call(jl,this,e).attr("d",(t=>a(i[t]))))).node()}}function Ad(t,n={}){let{x:e,y:r,...o}=n;return[e,r]=vo(e,r),new Ld(t,{...o,x:e,y:r})}const Ed=new Set(["x","y","z","weight"]);function zd(t){return/^density$/i.test(t)}const Od={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Nd extends ys{constructor(t,n={}){const[e,r]=ao(n.r,3);super(t,{geometry:{value:n.geometry},r:{value:e,scale:"r",filter:Rr,optional:!0}},Zf(n),Od),this.r=r}render(t,n,e,r,o){const{geometry:i,r:a}=e,l=ct(o.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,st({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:s}=this;return Cr(s)?t=[]:void 0!==s&&l.pointRadius(s),da("svg:g",o).call(Fl,this,r,o).call(Ul,this,n).call((n=>{n.selectAll().data(t).enter().append("path").call(ql,this).attr("d",a?t=>l.pointRadius(a[t])(i[t]):t=>l(i[t])).call(jl,this,e)})).node()}}function Sd(t,{geometry:n=Vr,...e}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new Nd(t,{geometry:n,...e})}function Rd({strokeWidth:t=1.5,...n}={}){return Sd({type:"Sphere"},{strokeWidth:t,...n})}function Cd({strokeOpacity:t=.1,...n}={}){return Sd(vr(),{strokeOpacity:t,...n})}const Td=.5,Id=0;function jd(t={fill:"count"},{binWidth:n,...e}={}){n=void 0===n?20:Gr(n),t=Li(t,e);const{z:r,fill:o,stroke:i}=e;return void 0===i&&qo(o)&&Mi(t,"fill")&&(e.stroke="none"),void 0===e.symbol&&(e.symbol="hexagon"),void 0!==e.r||Mi(t,"r")||(e.r=n/2),ai(e,((e,o,i,a,l,s)=>{let{x:c,y:u,z:f,fill:h,stroke:d,symbol:p}=i;if(void 0===c)throw new Error("missing channel: x");if(void 0===u)throw new Error("missing channel: y");({x:c,y:u}=fa(i,a,s)),f=f?f.value:Fr(e,r),h=h?.value,d=d?.value,p=p?.value;const m=Si(t,{z:f,fill:h,stroke:d,symbol:p}),y=f&&[],g=h&&[],v=d&&[],x=p&&[],w=[],b=[],k=[];let $=-1;for(const n of t)n.initialize(e);for(const e of o){const r=[];for(const n of t)n.scope("facet",e);for(const[o,i]of zi(e,m))for(const e of Bd(i,c,u,n)){r.push(++$),b.push(e.x),k.push(e.y),f&&y.push(m===f?o:f[e[0]]),h&&g.push(m===h?o:h[e[0]]),d&&v.push(m===d?o:d[e[0]]),p&&x.push(m===p?o:p[e[0]]);for(const n of t)n.reduce(e)}w.push(r)}return{data:e,facets:w,channels:{x:{value:b},y:{value:k},...f&&{z:{value:y}},...h&&{fill:{value:g,scale:"auto"}},...d&&{stroke:{value:v,scale:"auto"}},...p&&{symbol:{value:x,scale:"auto"}},...Object.fromEntries(t.map((({name:t,output:e})=>[t,{scale:"auto",radius:"r"===t?n/2:void 0,value:e.transform()}])))}}}))}function Bd(t,n,e,r){const o=r*(1.5/Xo),i=new Map;for(const a of t){let t=n[a],l=e[a];if(isNaN(t)||isNaN(l))continue;let s=Math.round(l=(l-Id)/o),c=Math.round(t=(t-Td)/r-(1&s)/2),u=l-s;if(3*Math.abs(u)>1){let n=t-c,e=c+(t<c?-1:1)/2,r=s+(l<s?-1:1),o=t-e,i=l-r;n*n+u*u>o*o+i*i&&(c=e+(1&s?1:-1)/2,s=r)}const f=`${c},${s}`;let h=i.get(f);void 0===h&&(i.set(f,h=[]),h.x=(c+(1&s)/2)*r+Td,h.y=s*o+Id),h.push(a)}return i.values()}const Wd={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};function Dd(t){return new Fd(t)}class Fd extends ys{constructor({binWidth:t=20,clip:n=!0,...e}={}){super(void 0,void 0,{clip:n,...e},Wd),this.binWidth=Gr(t)}render(t,n,e,r,o){const{binWidth:i}=this,{marginTop:a,marginRight:l,marginBottom:s,marginLeft:c,width:u,height:f}=r,h=c-Td,d=u-l-Td,p=a-Id,m=f-s-Id,y=i/2,g=y*ti,v=g/2,x=2*y,w=1.5*g,b=Math.floor(h/x),k=Math.ceil(d/x),$=Math.floor((p+v)/w),M=Math.ceil((m-v)/w)+1,L=`m0,${qd(-g)}l${qd(y)},${qd(v)}v${qd(g)}l${qd(-y)},${qd(v)}`;let A=L;for(let t=$;t<M;++t)for(let n=b;n<k;++n)A+=`M${qd(n*x+(1&t)*y)},${qd(t*w)}${L}`;return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{},Nl+Td,Nl+Id).call((t=>t.append("path").call(ql,this).attr("d",A))).node()}}function qd(t){return Math.round(1e3*t)/1e3}const _d={ariaLabel:"image",fill:null,stroke:null};class Pd extends ys{constructor(t,n={}){let{x:e,y:r,r:o,width:i,height:a,rotate:l,src:s,preserveAspectRatio:c,crossOrigin:u,frameAnchor:f,imageRendering:h}=n;null==o&&(o=void 0),void 0===o&&void 0===i&&void 0===a?i=a=16:void 0===i&&void 0!==a?i=a:void 0===a&&void 0!==i&&(a=i);const[d,p]="string"==typeof(m=s)&&(function(t){return/^\.*\//.test(t)}(m)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(m))?[void 0,m]:[m,void 0];var m;const[y,g]=ao(o),[v,x]=ao(i,void 0!==g?2*g:void 0),[w,b]=ao(a,void 0!==g?2*g:void 0),[k,$]=ao(l,0);super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:y,scale:"r",filter:Rr,optional:!0},width:{value:v,filter:Rr,optional:!0},height:{value:w,filter:Rr,optional:!0},rotate:{value:k,optional:!0},src:{value:d,optional:!0}},Zf(n),_d),this.src=p,this.width=x,this.rotate=$,this.height=b,this.r=g,this.preserveAspectRatio=Vl(c,"xMidYMid"),this.crossOrigin=Zr(u),this.frameAnchor=Po(f),this.imageRendering=Vl(h,"auto")}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,width:c,height:u,r:f,rotate:h,src:d}=e,{r:p,width:m,height:y,rotate:g}=this,[v,x]=Jl(this,r);return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append("image").call(ql,this).attr("x",Ud(l,c,f,v,m,p)).attr("y",Ud(s,u,f,x,y,p)).attr("width",c?t=>c[t]:void 0!==m?m:f?t=>2*f[t]:2*p).attr("height",u?t=>u[t]:void 0!==y?y:f?t=>2*f[t]:2*p).attr("transform",h?t=>`rotate(${h[t]})`:g?`rotate(${g})`:null).attr("transform-origin",h||g?Bs`${l?t=>l[t]:v}px ${s?t=>s[t]:x}px`:null).call(Pl,"href",d?t=>d[t]:this.src).call(Pl,"preserveAspectRatio",this.preserveAspectRatio).call(Pl,"crossorigin",this.crossOrigin).call(Pl,"image-rendering",this.imageRendering).call(Pl,"clip-path",f?t=>`circle(${f[t]}px)`:void 0!==p?`circle(${p}px)`:null).call(jl,this,e))).node()}}function Ud(t,n,e,r,o,i){return n&&t?e=>t[e]-n[e]/2:n?t=>r-n[t]/2:t&&void 0!==o?n=>t[n]-o/2:void 0!==o?r-o/2:e&&t?n=>t[n]-e[n]:e?t=>r-e[t]:t?n=>t[n]-i:r-i}function Vd(t,n={}){let{x:e,y:r,...o}=n;return void 0===n.frameAnchor&&([e,r]=vo(e,r)),new Pd(t,{...o,x:e,y:r})}function Hd(t,n,e){var r=0===t||1===t?0:Math.exp(Zd(n+e)-Zd(n)-Zd(e)+n*Math.log(t)+e*Math.log(1-t));return!(t<0||t>1)&&(t<(n+1)/(n+e+2)?r*Yd(t,n,e)/n:1-r*Yd(1-t,e,n)/e)}function Yd(t,n,e){var r,o,i,a,l=1e-30,s=1,c=n+e,u=n+1,f=n-1,h=1,d=1-c*t/u;for(Math.abs(d)<l&&(d=l),a=d=1/d;s<=100&&(d=1+(o=s*(e-s)*t/((f+(r=2*s))*(n+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=(d=1/d)*h,d=1+(o=-(n+s)*(c+s)*t/((n+r)*(u+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));s++);return a}function Zd(t){var n,e,r,o=0,i=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(e=n=t)+5.5,r-=(n+.5)*Math.log(r);o<6;o++)a+=i[o]/++e;return Math.log(2.506628274631*a/n)-r}function Gd(t,n){var e=function(t,n,e){var r,o,i,a,l,s,c,u,f,h,d=n-1,p=e-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(n>=1&&e>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(s=-s),c=(s*s-3)/6,u=2/(1/(2*n-1)+1/(2*e-1)),f=s*Math.sqrt(c+u)/u-(1/(2*e-1)-1/(2*n-1))*(c+5/6-2/(3*u)),s=n/(n+e*Math.exp(2*f))):(r=Math.log(n/(n+e)),o=Math.log(e/(n+e)),s=t<(a=Math.exp(n*r)/n)/(f=a+(l=Math.exp(e*o)/e))?Math.pow(n*f*t,1/n):1-Math.pow(e*f*(1-t),1/e)),h=-Zd(n)-Zd(e)+Zd(n+e);m<10;m++){if(0===s||1===s)return s;if((s-=a=(l=(Hd(s,n,e)-t)/(a=Math.exp(d*Math.log(s)+p*Math.log(1-s)+h)))/(1-.5*Math.min(1,l*(d/s-p/(1-s)))))<=0&&(s=.5*(s+a)),s>=1&&(s=.5*(s+a+1)),Math.abs(a)<1e-8*s&&m>0)break}return s}(2*Math.min(t,1-t),.5*n,.5);return e=Math.sqrt(n*(1-e)/e),t>.5?e:-e}const Jd={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Kd extends ys{constructor(t,n={}){const{x:e,y:r,z:o,ci:i=.95,precision:a=4}=n;if(super(t,{x:{value:e,scale:"x"},y:{value:r,scale:"y"},z:{value:xo(n),optional:!0}},n,Jd),this.z=o,this.ci=+i,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,n,e,r,o){const{x:i,y:a,z:l}=e,{ci:s}=this;return da("svg:g",o).call(Fl,this,r,o).call(Ul,this,n).call((n=>n.selectAll().data(l?Wl(t,l,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(ql,this).call(Bl,this,{...e,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,i,a))).call(s&&!_o(this.fill)?t=>t.select(Qd).attr("stroke","none").call(ql,this).call(Bl,this,{...e,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,i,a))):()=>{}))))).node()}}function Qd(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Le.svg,"path"),this)}class Xd extends Kd{constructor(t,n){super(t,n)}_renderBand(t,n,e){const{ci:r,precision:o}=this,[i,a]=ne(t,(t=>e[t])),l=rp(t,e,n),s=op(t,e,n,(1-r)/2,l);return sr().y((t=>t)).x0((t=>s(t,-1))).x1((t=>s(t,1)))(N(i,a-o/2,o).concat(a))}_renderLine(t,n,e){const[r,o]=ne(t,(t=>e[t])),i=rp(t,e,n);return`M${i(r)},${r}L${i(o)},${o}`}}class tp extends Kd{constructor(t,n){super(t,n)}_renderBand(t,n,e){const{ci:r,precision:o}=this,[i,a]=ne(t,(t=>n[t])),l=rp(t,n,e),s=op(t,n,e,(1-r)/2,l);return sr().x((t=>t)).y0((t=>s(t,-1))).y1((t=>s(t,1)))(N(i,a-o/2,o).concat(a))}_renderLine(t,n,e){const[r,o]=ne(t,(t=>n[t])),i=rp(t,n,e);return`M${r},${i(r)}L${o},${i(o)}`}}function np(t,n={}){const{y:e=Ur,x:r=Vr,stroke:o,fill:i=(qo(o)?"currentColor":o),...a}=n;return new Xd(t,vu({...a,x:r,y:e,fill:i,stroke:o}))}function ep(t,n={}){const{x:e=Ur,y:r=Vr,stroke:o,fill:i=(qo(o)?"currentColor":o),...a}=n;return new tp(t,gu({...a,x:e,y:r,fill:i,stroke:o}))}function rp(t,n,e){let r=0,o=0,i=0,a=0;for(const l of t){const t=n[l],s=e[l];r+=t,o+=s,i+=t*s,a+=t*t}const l=t.length,s=(l*i-r*o)/(l*a-r*r),c=(o-s*r)/l;return t=>s*t+c}function op(t,n,e,r,o){const i=J(t,(t=>n[t]))/t.length;let a=0,l=0;for(const r of t)a+=(n[r]-i)**2,l+=(e[r]-o(n[r]))**2;const s=Math.sqrt(l/(t.length-2)),c=Gd(r,t.length-2);return(n,e)=>{const r=o(n),l=s*Math.sqrt(1/t.length+(n-i)**2/a);return r+e*c*l}}function ip(t={}){let{path:n=Vr,delimiter:e,frameAnchor:r,treeLayout:o=wr,treeSort:i,treeSeparation:a,treeAnchor:l,...s}=t;l=lp(l),i=up(i),void 0===r&&(r=l.frameAnchor);const c=hp(e),u=Ap(s,pp),[f,h]=Mo(),[d,p]=Mo();return{x:f,y:d,frameAnchor:r,...ii(s,((t,e)=>{const r=c(Fr(t,n)),s=h([]),f=p([]);let d=-1;const m=[],y=[],g=xr().path((t=>r[t])),v=o();v.nodeSize&&v.nodeSize([1,1]),v.separation&&void 0!==a&&v.separation(a??Hr);for(const t of u)t[Lp]=t[$p]([]);for(const n of e){const e=[],o=g(n.filter((t=>null!=r[t]))).each((n=>n.data=t[n.data]));null!=i&&o.sort(i),v(o);for(const t of o.descendants()){e.push(++d),m[d]=t.data,l.position(t,d,s,f);for(const n of u)n[Lp][d]=n[Mp](t)}y.push(e)}return{data:m,facets:y}})),...Object.fromEntries(u)}}function ap(t={}){let{path:n=Vr,delimiter:e,curve:r="bump-x",stroke:o="#555",strokeWidth:i=1.5,strokeOpacity:a=.5,treeLayout:l=wr,treeSort:s,treeSeparation:c,treeAnchor:u,...f}=t;u=lp(u),s=up(s),f={curve:r,stroke:o,strokeWidth:i,strokeOpacity:a,...f};const h=hp(e),d=Ap(f,mp),[p,m]=Mo(),[y,g]=Mo(),[v,x]=Mo(),[w,b]=Mo();return{x1:p,x2:y,y1:v,y2:w,...ii(f,((t,e)=>{const r=h(Fr(t,n)),o=m([]),i=g([]),a=x([]),f=b([]);let p=-1;const y=[],v=[],w=xr().path((t=>r[t])),k=l();k.nodeSize&&k.nodeSize([1,1]),k.separation&&void 0!==c&&k.separation(c??Hr);for(const t of d)t[Lp]=t[$p]([]);for(const n of e){const e=[],l=w(n.filter((t=>null!=r[t]))).each((n=>n.data=t[n.data]));null!=s&&l.sort(s),k(l);for(const{source:t,target:n}of l.links()){e.push(++p),y[p]=n.data,u.position(t,p,o,a),u.position(n,p,i,f);for(const e of d)e[Lp][p]=e[Mp](n,t)}v.push(e)}return{data:y,facets:v}})),...Object.fromEntries(d)}}function lp(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return sp;case"right":return cp}throw new Error(`invalid tree anchor: ${t}`)}const sp={frameAnchor:"left",dx:6,position({x:t,y:n},e,r,o){r[e]=n,o[e]=-t}},cp={frameAnchor:"right",dx:-6,position({x:t,y:n},e,r,o){r[e]=-n,o[e]=-t}};function up(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?fp(pp(t)):fp(function(t){return n=>n.data?.[t]}(t))}function fp(t){return(n,e)=>zr(t(n),t(e))}function hp(t="/"){return"/"==`${t}`?t=>t:n=>{return n.map((e=t,r="/",e=new RegExp(function(t){return`${t}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(e),"g"),t=>null==t?null:`${t}`.replace(e,r)));var e,r}}function dp(t){return ho(t)&&"function"==typeof t.node}function pp(t){if(dp(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return gp;case"node:path":return yp;case"node:internal":return wp;case"node:depth":return vp;case"node:height":return xp}throw new Error(`invalid node value: ${t}`)}}function mp(t){if(dp(t))return t.node;if(ho(n=t)&&"function"==typeof n.link)return t.link;var n;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return bp(gp);case"parent:path":return bp(yp);case"parent:depth":return bp(vp);case"parent:height":return bp(xp);case"node:name":return gp;case"node:path":return yp;case"node:internal":return wp;case"node:depth":return vp;case"node:height":return xp}throw new Error(`invalid link value: ${t}`)}}function yp(t){return t.id}function gp(t){return function(t){let n=t.length;for(;--n>0&&!kp(t,n););return t.slice(n+1)}(t.id)}function vp(t){return t.depth}function xp(t){return t.height}function wp(t){return!!t.children}function bp(t){return(n,e)=>null==e?void 0:t(e)}function kp(t,n){if("/"===t[n]){let e=0;for(;n>0&&"\\"===t[--n];)++e;if(0==(1&e))return!0}return!1}const $p=2,Mp=3,Lp=4;function Ap(t,n){const e=[];for(const r in t){const o=t[r],i=n(o);void 0!==i&&e.push([r,...Mo(o),i])}return e}function Ep(t,n={}){let{fill:e,stroke:r,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,marker:f,markerStart:h=f,markerEnd:d=f,dot:p=qo(h)&&qo(d),text:m="node:name",textStroke:y="white",title:g="node:path",dx:v,dy:x,...w}=n;return void 0===v&&(v=lp(w.treeAnchor).dx),gs(Nf(t,ap({markerStart:h,markerEnd:d,stroke:void 0!==r?r:void 0===e?"node:internal":e,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,...w})),p?Jf(t,ip({fill:void 0===e?"node:internal":e,title:g,...w})):null,null!=m?_s(t,ip({text:m,fill:void 0===e?"currentColor":e,stroke:y,dx:v,dy:x,title:g,...w})):null)}function zp(t,n){return Ep(t,{...n,treeLayout:br})}function Op({geometry:t=Vr,...n}={}){return ai({...n,x:null,y:null},((n,e,r,o,i,{projection:a})=>{const l=Fr(n,t),s=l.length,c=new Float64Array(s),u=new Float64Array(s),f=ct(a);for(let t=0;t<s;++t)[c[t],u[t]]=f.centroid(l[t]);return{data:n,facets:e,channels:{x:{value:c},y:{value:u}}}}))}function Np({geometry:t=Vr,...n}={}){let e;return{...n,x:{transform:n=>Float64Array.from(e=Fr(Fr(n,t),kr),(([t])=>t))},y:{transform:()=>Float64Array.from(e,(([,t])=>t))}}}const Sp=({marginLeft:t})=>[1,t],Rp=({width:t,marginRight:n})=>[-1,t-n],Cp=({width:t,marginLeft:n,marginRight:e})=>[0,(n+t-e)/2],Tp=({marginTop:t})=>[1,t],Ip=({height:t,marginBottom:n})=>[-1,t-n],jp=({height:t,marginTop:n,marginBottom:e})=>[0,(n+t-e)/2];function Bp(t){return"string"==typeof t?{anchor:t}:t}function Wp(t={},n={}){1===arguments.length&&([t,n]=Fp(t));let{anchor:e="left",padding:r=1,r:o=n.r}=Bp(t);switch(`${e}`.toLowerCase()){case"left":e=Sp;break;case"right":e=Rp;break;case"middle":e=Cp;break;default:throw new Error(`unknown dodge anchor: ${e}`)}return qp("x","y",e,Gr(r),o,n)}function Dp(t={},n={}){1===arguments.length&&([t,n]=Fp(t));let{anchor:e="bottom",padding:r=1,r:o=n.r}=Bp(t);switch(`${e}`.toLowerCase()){case"top":e=Tp;break;case"bottom":e=Ip;break;case"middle":e=jp;break;default:throw new Error(`unknown dodge anchor: ${e}`)}return qp("y","x",e,Gr(r),o,n)}function Fp(t){const{anchor:n,padding:e,...r}=t,{r:o}=r;return[{anchor:n,padding:e,r:o},r]}function qp(t,n,e,r,o,i){if(null!=o&&"number"!=typeof o){const{channels:t,sort:n,reverse:e}=i;i={...i,channels:{r:{value:o,scale:"r"},...Vo(t)}},void 0===n&&void 0===e&&(i.sort={channel:"r",order:"descending"})}return ai(i,(function(i,a,l,s,c,u){let{[n]:f,r:h}=l;if(!l[n])throw new Error(`missing channel: ${n}`);({[n]:f}=fa(l,s,u));const d=h?void 0:void 0!==o?Gr(o):void 0!==this.r?this.r:3;h&&(h=Fr(h.value,s[h.scale]||Vr,Float64Array));let[p,m]=e(c);const y=p?Pp:_p,g=new Float64Array(f.length),v=h?t=>h[t]:()=>d;for(let t of a){const n=Ar();t=t.filter(h?t=>Sr(f[t])&&Rr(h[t]):t=>Sr(f[t]));const e=new Float64Array(2*t.length+2);for(const o of t){const t=v(o),i=p?t+r:0,a=f[o]-t,l=f[o]+t;let s=2;n.queryInterval(a-r,l+r,(([,,t])=>{const n=g[t]-i,a=f[o]-f[t],l=r+(h?h[o]+h[t]:2*d),c=Math.sqrt(l*l-a*a);e[s++]=n-c,e[s++]=n+c}));let c=e.slice(0,s);p&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(y)){for(let n=0;n<s;n+=2)if(e[n]+1e-6<t&&t<e[n+1]-1e-6)continue t;g[o]=t+i;break}n.insert([a,l,o])}}p||(p=1);for(const t of a)for(const n of t)g[n]=g[n]*p+m;return{data:i,facets:a,channels:{[n]:{value:f},[t]:{value:g},...h&&{r:{value:h}}}}}))}function _p(t,n){return Math.abs(t)-Math.abs(n)}function Pp(t,n){return t-n}function Up(t,n){return 1===arguments.length&&({basis:t,...n}=t),wh(Hp(t),n)}function Vp(t,n){return 1===arguments.length&&({basis:t,...n}=t),bh(Hp(t),n)}function Hp(t){if(void 0===t)return Jp;if("function"==typeof t)return Yp(((n,e)=>t(bo(e,n))));if(/^p\d{2}$/i.test(t))return Zp(to(t));switch(`${t}`.toLowerCase()){case"deviation":return Qp;case"first":return Jp;case"last":return Kp;case"max":return Xp;case"mean":return tm;case"median":return nm;case"min":return em;case"sum":return rm;case"extent":return Gp}throw new Error(`invalid basis: ${t}`)}function Yp(t){return{mapIndex(n,e,r){const o=+t(n,e);for(const t of n)r[t]=null===e[t]?NaN:e[t]/o}}}function Zp(t){return Yp(((n,e)=>t(n,(t=>e[t]))))}const Gp={mapIndex(t,n,e){const[r,o]=ne(t,(t=>n[t])),i=o-r;for(const o of t)e[o]=null===n[o]?NaN:(n[o]-r)/i}},Jp=Yp(((t,n)=>{for(let e=0;e<t.length;++e){const r=n[t[e]];if(Er(r))return r}})),Kp=Yp(((t,n)=>{for(let e=t.length-1;e>=0;--e){const r=n[t[e]];if(Er(r))return r}})),Qp={mapIndex(t,n,e){const r=nt(t,(t=>n[t])),o=lt(t,(t=>n[t]));for(const i of t)e[i]=null===n[i]?NaN:o?(n[i]-r)/o:0}},Xp=Zp(rt),tm=Zp(nt),nm=Zp(tt),em=Zp(at),rm=Zp(J);function om(t={},n){return 1===arguments.length&&(n=t),wh(am(t),n)}function im(t={},n){return 1===arguments.length&&(n=t),bh(am(t),n)}function am(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:e,shift:r,anchor:o,strict:i}=t;if(void 0===o&&void 0!==r&&(o=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(r),ta(`Warning: the shift option is deprecated; please use anchor "${o}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return sm(to(t));switch(t.toLowerCase()){case"deviation":return sm(lt);case"max":return cm(rt);case"mean":return fm;case"median":return sm(tt);case"min":return cm(at);case"mode":return cm(Q);case"sum":return um;case"variance":return sm(X);case"difference":return ym;case"ratio":return gm;case"first":return vm;case"last":return xm}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return cm(t)}(e)(n,function(t="middle",n){switch(`${t}`.toLowerCase()){case"middle":return n-1>>1;case"start":return 0;case"end":return n-1}throw new Error(`invalid anchor: ${t}`)}(o,n),i)}function lm(t,n,e){return t.subarray?t.subarray(n,e):t.slice(n,e)}function sm(t){return(n,e,r)=>r?{mapIndex(r,o,i){const a=Float64Array.from(r,(t=>null===o[t]?NaN:o[t]));let l=0;for(let t=0;t<n-1;++t)isNaN(a[t])&&++l;for(let o=0,s=r.length-n+1;o<s;++o)isNaN(a[o+n-1])&&++l,i[r[o+e]]=0===l?t(a.subarray(o,o+n)):NaN,isNaN(a[o])&&--l}}:{mapIndex(r,o,i){const a=Float64Array.from(r,(t=>null===o[t]?NaN:o[t]));for(let o=-e;o<0;++o)i[r[o+e]]=t(a.subarray(0,o+n));for(let o=0,l=r.length-e;o<l;++o)i[r[o+e]]=t(a.subarray(o,o+n))}}}function cm(t){return(n,e,r)=>r?{mapIndex(r,o,i){let a=0;for(let t=0;t<n-1;++t)a+=Er(o[r[t]]);for(let l=0,s=r.length-n+1;l<s;++l)a+=Er(o[r[l+n-1]]),a===n&&(i[r[l+e]]=t(bo(o,lm(r,l,l+n)))),a-=Er(o[r[l]])}}:{mapIndex(r,o,i){for(let a=-e;a<0;++a)i[r[a+e]]=t(bo(o,lm(r,0,a+n)));for(let a=0,l=r.length-e;a<l;++a)i[r[a+e]]=t(bo(o,lm(r,a,a+n)))}}}function um(t,n,e){return e?{mapIndex(e,r,o){let i=0,a=0;for(let n=0;n<t-1;++n){const t=r[e[n]];null===t||isNaN(t)?++i:a+=+t}for(let l=0,s=e.length-t+1;l<s;++l){const s=r[e[l]],c=r[e[l+t-1]];null===c||isNaN(c)?++i:a+=+c,o[e[l+n]]=0===i?a:NaN,null===s||isNaN(s)?--i:a-=+s}}}:{mapIndex(e,r,o){let i=0;const a=e.length;for(let o=0,l=Math.min(a,t-n-1);o<l;++o)i+=+r[e[o]]||0;for(let l=-n,s=a-n;l<s;++l)i+=+r[e[l+t-1]]||0,o[e[l+n]]=i,i-=+r[e[l]]||0}}}function fm(t,n,e){if(e){const r=um(t,n,e);return{mapIndex(e,o,i){r.mapIndex(e,o,i);for(let r=0,o=e.length-t+1;r<o;++r)i[e[r+n]]/=t}}}return{mapIndex(e,r,o){let i=0,a=0;const l=e.length;for(let o=0,s=Math.min(l,t-n-1);o<s;++o){let t=r[e[o]];null===t||isNaN(t=+t)||(i+=t,++a)}for(let s=-n,c=l-n;s<c;++s){let l=r[e[s+t-1]],c=r[e[s]];null===l||isNaN(l=+l)||(i+=l,++a),o[e[s+n]]=i/a,null===c||isNaN(c=+c)||(i-=c,--a)}}}}function hm(t,n,e,r){for(let o=e+r;e<o;++e){const r=t[n[e]];if(Er(r))return r}}function dm(t,n,e,r){for(let o=e+r-1;o>=e;--o){const e=t[n[o]];if(Er(e))return e}}function pm(t,n,e,r){for(let o=e+r;e<o;++e){let r=t[n[e]];if(null!==r&&!isNaN(r=+r))return r}}function mm(t,n,e,r){for(let o=e+r-1;o>=e;--o){let e=t[n[o]];if(null!==e&&!isNaN(e=+e))return e}}function ym(t,n,e){return e?{mapIndex(e,r,o){for(let i=0,a=e.length-t;i<a;++i){const a=r[e[i]],l=r[e[i+t-1]];o[e[i+n]]=null===a||null===l?NaN:l-a}}}:{mapIndex(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=mm(r,e,i,t)-pm(r,e,i,t)}}}function gm(t,n,e){return e?{mapIndex(e,r,o){for(let i=0,a=e.length-t;i<a;++i){const a=r[e[i]],l=r[e[i+t-1]];o[e[i+n]]=null===a||null===l?NaN:l/a}}}:{mapIndex(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=mm(r,e,i,t)/pm(r,e,i,t)}}}function vm(t,n,e){return e?{mapIndex(e,r,o){for(let i=0,a=e.length-t;i<a;++i)o[e[i+n]]=r[e[i]]}}:{mapIndex(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=hm(r,e,i,t)}}}function xm(t,n,e){return e?{mapIndex(e,r,o){for(let i=0,a=e.length-t;i<a;++i)o[e[i+n]]=r[e[i+t-1]]}}:{mapIndex(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=dm(r,e,i,t)}}}function wm(t,n={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return km(n);case"last":return $m(n)}if("function"==typeof t)return Rm(null,t,n);let e,r;for(e in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=bm(t[e])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return Rm(e,r,n)}function bm(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return Nm;case"max":return Sm}throw new Error(`unknown selector: ${t}`)}function km(t){return Rm(null,zm,t)}function $m(t){return Rm(null,Om,t)}function Mm(t){return Rm("x",Nm,t)}function Lm(t){return Rm("y",Nm,t)}function Am(t){return Rm("x",Sm,t)}function Em(t){return Rm("y",Sm,t)}function*zm(t){yield t[0]}function*Om(t){yield t[t.length-1]}function*Nm(t,n){yield $r(t,(t=>n[t]))}function*Sm(t,n){yield lr(t,(t=>n[t]))}function Rm(t,n,e){if(null!=t){if(null==e[t])throw new Error(`missing channel: ${t}`);t=e[t]}const r=xo(e);return ii(e,((e,o)=>{const i=Fr(e,r),a=Fr(e,t),l=[];for(const t of o){const e=[];for(const r of i?Z(t,(t=>i[t])).values():[t])for(const t of n(r,a))e.push(t);l.push(e)}return{data:e,facets:l}}))}export{pf as Area,Cf as Arrow,Wf as BarX,Df as BarY,Pf as Cell,rd as Contour,Ld as Density,Gf as Dot,Hc as Frame,Nd as Geo,Fd as Hexgrid,Pd as Image,eh as Line,Of as Link,ys as Mark,Vh as Raster,lh as Rect,Rs as RuleX,Cs as RuleY,Fs as Text,Nh as TickX,Sh as TickY,uc as Vector,mf as area,yf as areaX,gf as areaY,If as arrow,dh as auto,fh as autoSpec,Mc as axisFx,kc as axisFy,$c as axisX,bc as axisY,Ff as barX,qf as barY,mu as bin,du as binX,pu as binY,Th as boxX,Ih as boxY,Uf as cell,Vf as cellX,Hf as cellY,Op as centroid,Xf as circle,zp as cluster,Mo as column,od as contour,xd as delaunayLink,wd as delaunayMesh,Ad as density,Wp as dodgeX,Dp as dodgeY,Jf as dot,Kf as dotX,Qf as dotY,ui as filter,zl as formatIsoDate,Al as formatMonth,El as formatWeekday,Yc as frame,Sd as geo,Np as geoCentroid,Cd as graticule,Nc as gridFx,zc as gridFy,Oc as gridX,Ec as gridY,ki as group,wi as groupX,bi as groupY,xi as groupZ,th as hexagon,jd as hexbin,Dd as hexgrid,bd as hull,Vr as identity,Vd as image,Ur as indexOf,ai as initializer,Xh as interpolateNearest,Kh as interpolateNone,Qh as interpolatorBarycentric,td as interpolatorRandomWalk,hs as legend,rh as line,oh as lineX,ih as lineY,np as linearRegressionX,ep as linearRegressionY,Nf as link,kh as map,wh as mapX,bh as mapY,gs as marks,Hp as normalize,Up as normalizeX,Vp as normalizeY,Zc as plot,Yh as raster,sh as rect,ch as rectX,uh as rectY,hi as reverse,Ts as ruleX,Is as ruleY,wl as scale,wm as select,km as selectFirst,$m as selectLast,Am as selectMaxX,Em as selectMaxY,Mm as selectMinX,Lm as selectMinY,pi as shuffle,mi as sort,Rd as sphere,pc as spike,_u as stackX,Pu as stackX1,Uu as stackX2,Vu as stackY,Hu as stackY1,Yu as stackY2,_s as text,Ps as textX,Us as textY,Rh as tickX,Ch as tickY,ii as transform,Ep as tree,ap as treeLink,ip as treeNode,Fr as valueof,fc as vector,hc as vectorX,dc as vectorY,kd as voronoi,$d as voronoiMesh,am as window,om as windowX,im as windowY};export default null;
